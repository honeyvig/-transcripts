hey everyone welcome to Simply learn
today we will learn the advanced sequel
in this full course we will be covering
the fundamentals of SQL how to become a
SQL Developer which explains you a
perfect roadmap to become a SQL
Developer followed by that we will go
through the fundamentals of SQL which
includes the introduction to SQL SQL
installation ER diagrams installation of
SQL workbench and Then followed by that
we will dive into the SQL fundamental
operation such as create a table create
a database how to insert records and
data manipulation operations such as
delete insert Etc and then we will go
through the update query drop query
current date Etc and followed by that we
will get into some more advanced
fundamental operations of SQL such as
Group by between operators like
operators deleting duplicate records Etc
next we will dive into the normalization
of SQL tables then we will learn SQL
joints followed by that we will go
through these sub queries in SQL and
next the most important part of today's
session that is SQL with python followed
by that we will learn SQL injection to
make things more interesting we have
covered the most important SQL interview
questions for your upcoming interviews
now before we begin if you are a tech
geek in a continuous hunt for latest
technological Trends then consider
getting subscribed to Simply launch
YouTube channel and don't forget to hit
that Bell icon to never miss an update
from simplier also if you're an aspiring
data engineer looking for online
training and graduating from the best
universities or a professional who Alex
to switch careers with data engineering
by learning from the experts then try
giving a shot to Simply learns data
engineering post-graduate program from
Purdue University in collaboration with
IBM the link in the description box and
the print comment should take you to the
program being offered I hope I made
myself clear with the agenda now let's
get started with the first topic
now let's get started with what is a
database
so according to Oracle a database is an
organized collection of structured
information or data that is typically
stored electronically in a computer
system
a database is usually controlled by a
database management system or dbms
so it is a storage system that has a
collection of data relational databases
stored data in the form of tables that
can be easily retrieved managed and
updated
you can organize data into tables rows
columns and index it to make it easier
to find relevant information now talking
about some of the popular databases
we have mySQL database we also have
Oracle database then we have mongodb
which is a nosql database
next we have Microsoft SQL Server next
we have Apache Cassandra which is a free
and open source nosql database and
finally we have postgres SQL now let's
learn
what is SQL so SQL is a domain specific
language to communicate with databases
SQL was initially developed by IBM
most databases use structured query
language or SQL for writing and querying
data SQL commands help you to store
process analyze and manipulate databases
with this let's look at what a table is
so this is how a table in a database
looks like
so here you can see the name of the
table is players
on the top you can see the column names
so we have the player ID the player name
the country to which the player belongs
to and we also have the goals scored by
each of the players so these are also
known as fields in a database
here each row represents a record or a
tuple
so if you have the player ID which is 1
0 3 here the name of the player is
Daniel he's from England and the number
of goals here score is seven so you can
use SQL commands to query update insert
records and do a lot of other tasks
there are mainly four types of SQL
commands so first we have data
definition language or ddl
so ddl commands change the structure of
the table like creating a table deleting
a table or altering a table all the
commands of ddl are Auto committed which
means it permanently save all the
changes in the database
we have create alter drop and turn
create as ddl commands
next we have data manipulation language
or DML for so DML commands are used to
modify your database it is responsible
for all forms of changes in the database
DML commands are not Auto committed
which means it can't permanently save
all the changes in the database
we have select update delete and insert
as DML commands now select command is
also referred to as dql or data query
language third we have data control
language or DCL
so DCL commands allow you to control
access to data within the database
these DCL commands are normally used to
create objects related to user access
and also control the distribution of
privileges among users
so we have Grant and revoke which are
the examples of data control language
finally we have something called as
transaction control language or TCL so
TCL commands allow the user to manage
database transactions commit and roll
back are example of TCL
now let's see the basic SQL command
structure
so first we have the select statement so
here you specify the various column
names that you want to fetch from the
table we write the table name using the
from statement
next we have the WHERE Clause to filter
out a table based on some conditions so
you can see here where condition 1
condition 2 and so on
then we have the group by Clause that
takes various column names so you can
write Group by column one column two and
so on
next we have the having Clause to filter
out tables based on groups finally we
have the order by Clause to filter out
the result in ascending or descending
order now talking about the various data
types in SQL
so we have exact numeric which has
integer small length bit and decimal
then we have approximate numeric which
are float and real
then we have some date and time data
types such as date time timestamp and
others
then we have string data type which
includes car this war car and text
finally we have binary data types
and binary data types have binary VAR
binary and image now let's see some of
the various operators that are present
in SQL
so first we have our basic arithmetic
operator so you have addition the
subtraction multiplication division and
modulus
then we have some logical operators like
all and any or between exists and so on
finally we have some comparison
operators such as equal to not equal to
this greater than less than greater than
equal to or less than equal to not less
than or not greater than now let me take
you to my MySQL workbench well we will
learn to write some of the import and
SQL commands use different statements
functions data types and operators that
we just learned who is a SQL Developer
SQL Developer is a person who is
accountable in creating and managing
huge data assets of a company
in other terms SQL Developer is a person
who can develop SQL databases as well as
write-in test code let's understand this
with the help of an example let's say we
want to search a particular product on
Amazon website and Amazon has stored all
its data about products in a database
now we will write the product name in
the search bar and when we click on the
search button it will run a SQL query
that fetches all the information about
the product and displays us on the
website so this is the basic task done
by a SQL Developer
now we will understand the
responsibilities of a SQL Developer all
databases have a structure and logic
behind how data is stored and retrieved
a SQL Developer designs the database
accordingly for businesses that is
called database modeling after the
database is created and deployed it's
the SQL Developer who is responsible for
fixing the general issues of the
database
escrow developer should be well versed
with structured query language to create
optimized SQL queries and refines the
existing ones to extract information
from the database
SQL developers run several diagnostic
tests to keep a check on the server and
the database in order to understand how
to organize company's data SQL
developers must communicate with
tactical and non-technical persons from
the business and SQL Developer also
gathers client requirements and
identifies the features that the
database owners want
as data is an asset to a company SQL
developers backup and restore data for
the clients they also perform tasks like
data management and data migration that
is if a company has stored all its data
on a local storage and now it pawn its
data to be stored in a cloud storage so
the safe transmission of the data from
local storage to cloud storage is known
as data migration and that is done by
the SQL developers after knowing the
responsibilities now we should look for
skill set required to be a good SQL
Developer
one should have a good knowledge of SQL
commands functions joints and procedures
let's have a look at few commands such
as create drop alter and truncate these
commands come under data definition
language we also have insert update and
delete commands these commands come
under data manipulation language we have
Grant and before commands these commands
come under data control language we also
have Commit rollback and save point
commands these come under transaction
control language these are the basic
commands a SQL Developer should be
familiar with and a SQL Developer may
have a little command on any one
programming language you don't have to
be expert in programming all you need is
how to interface between application and
your database for example you are using
MySQL and your web application is based
on PHP then you should know how to
connect your application to the database
and how to issue queries
how to fetch results and then how to
display it to the users
one should have a good understanding of
various database Management systems such
as MySQL Microsoft Access Oracle post
way SQL dbase Fox Pro SQL Lite IBM db2
LibreOffice base mariadb and Microsoft
SQL Server one should know integration
of databases with data visualization
software such as power bi and Tableau
which helps businesses to make better
decisions and give you an add-on as a
SQL Developer one should develop
critical thinking and problem solving
skills to create optimized queries
now we'll see how a SQL Developer is
compensated in both United States and
India
in the United States SQL developers draw
an average salary of dollar 72 282 per
annum in India the average salary of a
SQL Developer is rupees 4 lakh 49532.
now we'll see how person can become a
good SQL Developer for that one should
have a good command on structured query
language and know how to interact with
database management system and can issue
queries to get the desired result
earning industry recognized SQL
Developer certifications such as
Microsoft certified professional
developer mcpd or Oracle PL SQL
Developer certified associate which
usually require a passing score on an
exam
and it's important to accumulate as much
practical experience as possible start
by designing creating and querying small
databases connected with your hobbies
and interests for example your favorite
music videos or your personal finances
this will enable you to gain experience
test your knowledge and build your
project portfolio which will be highly
beneficial when you start applying for
your first full-time position
now we will see some major companies
recruiting SQL developers first we have
the multinational Financial Services
Corporation American Express followed by
the multinational Professional Services
Network ernstein young we also have the
messaging company board sir then we have
the e-commerce giant Amazon as well as
the technology and Computer Solutions
company Dell finally in a list of
companies we have the multinational
technology company Google
so let's understand where 10-year
diagram is
an entity relationship diagram
describes the relationship of entities
that needs to be stored in a database
ear diagram is mainly a structural
design for the database it is a
framework made using specialized symbols
to define the relationship between
entities ER diagrams are created based
on the three main components entities
attributes relationships let's
understand the use of ER diagram with
the help of a real world example here a
school needs all its Student Records to
be stored digitally so they approach an
I.T company to do so a person from the
company will meet the school authorities
not all their requirements describe them
in the form of ER diagram
and get it cross-checked by the school
authorities as the school authorities
approve the ear diagram the database
Engineers would carry further
implementation
let's have a view of an ear diagram
the following diagram showcases two
entities student and course and the
relationship the relationship described
between student and course is many to
many as a course can be opted by several
students and a student can opt for more
than one course here student is the
entity and it possesses the attributes
that is student ID student name and
student age
and the course entity has attributes
such as course ID and course name
now we have an understanding of ER
diagram let us see why it has been so
popular
The Logical structure of the database
provided by ear diagram communicates the
landscape of business to different teams
in the company which is eventually
needed to support the business
gear diagram is a GUI representation of
The Logical structure of a database
which gives a better understanding of
the information to be stored in a
database
database designers can use ER diagrams
as a blueprint which reduces complexity
and helps them save time to build
databases quickly ear diagrams helps you
identify the entities that exist in a
system and the relationships between
those entities
after knowing its uses now we should get
familiar with the symbols used in ear
diagram
the rectangle symbol represents the
entities oval symbol represents
attributes a rectangle embedded in a
rectangle represents a weak entity a
dashed over represents a derived
attribute a diamond symbol represents a
relationship among entities double all
symbol represents multi-valued
attributes now we should dive in and
learn about the components of ER diagram
there are three main components of Air
diagram entity attribute and
relationship
entities have weak entity attributes are
further classified into key attribute
composite attribute multi-valued
attribute and derived attribute
relationships are also classified into
one-to-one relationships one to many
relationships many to one relationships
and many to many relationships
let's understand these components of
rear diagram
starting with entities
an entity can be either a living or a
non-living component an entity is
showcased as a rectangle in an ear
diagram let's understand this with the
help of an ear diagram here both student
and course are in rectangular shape and
are called entities and they represent
the relationship study in a dimension
let's transition to weak entity
an entity that makes Airlines over
another entity is called a weak entity
the weak entity is showcased as a double
rectangle in ER diagram in the example
below the school is a strong entity
because it has a primary key attribute
School number unlike the school the
classroom is a weak entity because this
does not have any primary key and the
room number attribute here acts only as
a discriminator and node of primary key
now let us know about attributes
attribute an attribute exhibits the
properties of an entity an attribute is
Illustrated with an oval shape in any
Air diagram in the example below student
is an entity and the properties of
student such as address age name and
role number are called its attributes
let's see our first classification under
attribute that is key attribute
the key attribute uniquely identifies an
entity from an entity set
the text of a key attribute is
underlined in the example below we have
a student entity and it has attributes
name address row number and age but here
row number can uniquely identify a
student from a set of students that's
why it is termed as a key attribute
now we will see composite attribute
an attribute that is composed of several
other attributes is known as a composite
attribute an oval showcases the
composite attribute and the composite
attribute over is further connected with
other roles in the example below we can
see an attribute name
which can have further supports such as
first name middle name and last name
these attributes with further
classification is known as composite
attribute now let's have a look at
multi-valued attribute an attribute that
can process more than one value are
called multi-valued attributes these are
represented as double old shape
in the example below the student entity
has attributes phone number roll number
name and age out of these attributes
phone number can have more than one
entry and the attribute with more than
one value is called multi-valued
attribute
let's see derived attribute an attribute
that can be derived from other
attributes of the entity is known as a
derived attribute in the ER diagram the
derived attribute is represented by
dashed over and in the example below
student entity has both date of birth
and age as attributes here age is a
derived attribute as it can be derived
by subtracting current date from the
student date of birth now after knowing
attributes let's understand relationship
in ER diagram
a relationship is showcased by the
diamond shape in the ear diagram it
depicts the relationship between two
entities in the below example student
study course here both student and
course are entities and studies the
relationship between them now let's go
through the type of relationship first
is one-to-one relationship when a single
element of an entity is associated with
the single element of another entity
this is called one-to-one relationship
in the example below we have student and
identification card as entities we can
see a student has only one
identification card and an
identification card is given to one
student it represents a one-to-one
relationship
let's see the second one when too many
relationship when a single element of an
entity is associated with more than one
element of another entity is called when
too many relationship in the below
example a customer can place many orders
but a particular order cannot be placed
by many customers
now we will have a look at many to one
relationship when more than one element
of an entity is related to a single
element of another entity it is called
many-to-one relationship for example
students have to opt for a single course
but a course can be opted by number of
students let's see many to many
relationship when more than one element
of an entity is associated with more
than one element of another entity is
called many to many relationship
for example an employee can be assigned
to many projects and many employees can
be assigned to a particular project
now after having an understanding of VR
diagram let us know the points to keep
in mind while creating the ER diagram
first identify all the entities in the
system embed all the entities in a
rectangular shape and label them
appropriately this could be a customer a
manager an order an invoice a schedule
Etc
identify relationships between entities
and connect them using a diamond in the
middle illustrating the relationship do
not connect relationships
connect attributes with entities and
label them appropriately and the
attribute should be in our chip assure
that each entity only appears a single
time and eradicate any redundant
entities or relationships in the ear
diagram
firstly we will visit the official
Oracle website that is mysql.com
and now we'll move to the downloads page
now scroll down and click on my sequel
GPL downloads
now under committee downloads click on
MySQL installer for Windows
the current versions are available to
download
I will choose this installer and click
the download button
now here just click on no things just
start my download
once the installer has downloaded open
it
you may be prompted for permission click
yes
this opens the installer
you will be asked to choose the setup
type we will go with custom
click next
now you have to select the products you
want to install
we'll install only the MySQL server
MySQL shell and the MySQL workbench
expand MySQL servers by double clicking
on it
choose the version you want to install
and click on this Arrow
now you have to do the same thing for
applications expand applications
and choose the MySQL workbench version
you want to install and click on the
Arrow
you will do the same thing for MySQL
shell
we'll choose the latest version click on
the Arrow
but these are the products that have to
be installed in a system
now we'll click next
I'll click execute to download and
install the server
this may take a while depending on your
internet speed
as the download is completed click next
and I will see the product configuration
click next
now we'll configure our SQL Server
instance
here we'll go with the default settings
and click next
another authentication select use strong
password encryption for authentication
which is recommended and click on next
now here set the password for your root
user by the way root is the default user
this user will have access to everything
I will set my password
now I'll click on next
and here also we'll keep the default
settings
and click on next
now to apply configuration we will
execute the process
once all the configuration steps are
complete click finish
now you will see the installation is
complete it will launch MySQL workbench
and MySQL shell after clicking on finish
so now the shell and workbench has
started
now we'll connect by clicking on the
root user it will ask for a password
enter the password and it will connect
successfully
yeah about bench has started now we'll
just connect the server
so first we'll open command prompt
now we'll reach the path where MySQL
files are present
local list C
program files
MySQL
my SQL Server 8.0 and then
I'll copy this path
now we'll open the command prompt and
write a command CD space
paste the link and press enter
now we'll write another command that
will be my SQL
minus U
space
now to ask for your password
just enter the password
and press enter
now the server has started and now we'll
see some commands in my SQL workbench
first we will open my SQL workbench
now we'll click on the local instance
MySQL 80
and enter the password to connect to the
localhost
the MySQL workbench has started now we
will see some commands
the First Command we will see is show
databases
show databases semicolon and now we'll
select the whole command and click on
this execute button
and here we will see the result in the
result grid
these are the databases that are stored
already in the database
now there are four databases that is
information schema MySQL performance
schema and sys
now I will select one of the database we
will use MySQL
now we have selected the mySQL database
and now in this database we will see
which tables are stored in this mySQL
database to see that we will run a
command
show tables
these are the tables that are stored in
this mySQL database that is columns
underscore Drive component DB and much
more
so now we'll see what components are
stored in these tables so we'll select
one table that would be component
and we'll see what are the columns and
what values are stored in it
to see that we will run a command select
star
from
components
now we have run this command
and what we will see is that the table
has three columns that is component ID
component group ID component URL but
there are no values there are null
values in the table
now
we will write a command to create a
table
now we will create a table in the mySQL
database
for creating the table the syntax is
create table table name and then we'll
start with the round brackets and then
we will write the column name and then
what column it is whether it's int or
where cat
so now we will drag the command create
table and we will name the table as
persons
and we'll start the round bracket and
First Column would be person ID okay
what type it would be it would be n type
comma
and the next column would be first name
step would be webcast
and the next column
it would be the last name
foreign
in the last column we would be right as
City
now I'll run this command
and see that the table has been created
create table persons person ID first
name worker name worker City
so yeah now we'll insert the values
first we will see what components are
there in this table
select
star
s
use this command
now what would we see is that the table
is created and all the columns are there
but there no values so we'll insert the
values and then see the table
so to do that we will run the commands
that would be insert into
this persons
then values
then we'll start the round bracket
and write the values according to the
column names
so I will write 1
as the person ID
in comma space and then I will write
first name that will I will write would
be for them
foreign
foreign
inserted into the table persons so first
we will see
whether it's inserted or not select
start from
persons semicolon
yeah we can see the result
our first row has been inserted now
we'll insert some more rows and then
we'll sum other commands
so we will copy this
paste here
and just change the values
personally do
now we will insert
holy
and he is also from Delhi so it will let
it remain the same
will execute this command
it's also been inserted into the table
and we will write more commands
a little bit
my
and
one more room
we will execute this command
now we have inserted four rows into the
table
write a command to see whether four rows
are inserted or not
now we'll see another command
to get out the result with a condition
let's do that
[Music]
star from
persons and what condition we should put
would be we would obtain the two rows
with the persons living in the city
Delhi so we will write the command
select star from persons where
City
yeah
equal to
value
semicolon and I would run this command
and we could get paste the two rows
with the persons living in the city
Delhi that is Gotham and Virat
now we will see a command to obtain only
a column from the table
select first name foreign
and now we'll run this command
so what we have got is that is the
column first name from the table persons
so to install SQL server in Windows you
will need two different software
packages the first one being the SQL
Server itself and the second one is a
SQL Server management tool let's
download these let's go back to Google
now type in
SQL
server
done
now you can choose the first option SQL
Server downloads from Microsoft ensure
that you are choosing the software from
the service provider which is Microsoft
itself not the third party software
files
now if you scroll down you can see two
different versions of the SQL Server the
first one being the developer and the
second one being the express if you are
a learner then I would recommend you to
go with the express version because it
has more features than the developer
version and also it is open source now
let's go with the express version
download now
the software file should be downloaded
shortly
so we express the XE file has been
downloaded successfully click on it and
it should be running
now it is asking for the admin
permission get the admin right and then
you should be good to go
once you provide the admin rights the
SQL Server installation will begin so
here you can see the window or the
dialog box which will give you three
different options basic
custom and download Media I would
recommend you to go with the basic
version
select that and now read all the terms
and agreements post type accept
and check the location where the SQL
Server is being installed if you're
comfortable with it you can click on
install or if you want to change go to
browse and select your folder I'm
comfortable with this particular
location which is program files so I'll
click on install
it should be installing in a while
there you go the download is successful
the installation phase might take a
little while
so the downward has been successfully
done and the installation has also
completed successfully now only the
first phase of the installation process
is done right the SQL Server is done but
we need another tool which is ssms or
SQL Server management Studio that you
can get right over here just click on
install ssmv and it will redirect you to
a different web page just click on the
webpage you want to go or the web
browser you want to choose
and let's assume what we said I was
talking about scroll a little
towards them and you can see the option
saying free download for SQL Server
management studio version
19.0.2 so you might be having the latest
versions in the future as well let's go
with the current version click on it
and there you go the system setup is
being downloaded here
it's 629 MB so it might take a while
there you go the Microsoft SQL Server
management Studio has already downloaded
and is being installed right now so now
you can see there is one bottleneck you
need to restart the system or you can
close and start it anyways but let's
choose the restart option
so after the restart the SQL Server
management studio is downloading a few
more packages and the installation
should be done in a while
there you go the installation has been
complete and you have the server
management Studio ready to execute open
that
so here you have the server type server
name and authentication if you want to
change them you can but I'm comfortable
with these and just press connect and
you should be good to go and get started
with you query editor
then you can start writing your queries
on your SQL Server so now we're on the
Ubuntu operating system let's quickly
start our terminal the shortcut key for
that is Ctrl alt D so now we have the
terminal opened so we might have to run
a few couple of commands
so the first one would be sudo apt
upgrade or update
we'll ask for the host password
now you have the update
so usually what happens is when you try
with the default method or when you
drive the default codes or the commands
you might miss a couple of updates or
two or files right so what happens when
you try with the default codes or
default commands you might miss a file
or two so when you update the Ubuntu you
will get the missing files as well now
if in case if you find I've got all the
updates but in case if you find some
files are missing you might receive a
message from Ubuntu saying can't update
or not fetched right in that case you
can try upgrade command
even then if you miss a couple of files
there is another similar command which
says sudo apt full upgrade we should
also try that as well
so basically what happens is you might
have one single command which says sudo
app install MySQL right so that
particular command will run but
unfortunately sometimes it misses to
face complete get I mean it misses to
get all the files So to avoid that we
will try the brute force method which
will get all the files all the updates
on all the executable files you require
to run MySQL and Ubuntu right
just a couple of minutes yes
so similar to upgrade we have full
upgrade
it's done
and in case if you wanted to remove some
unnecessary files you have a command for
that as well so let's take a look at
that
so the sudo apt Auto remove will remove
any of those older packages which you no
longer need after the complete for
Library let's run that
there you go so now we are done with the
open to update let's clear the screen by
pressing Ctrl plus C shortcut with me
the shortcut key control L has been
pressed and the screen has been cleared
now now we are good to go with our SQL
installation command which is sudo APD
get installed
my SQL
yeah so again we Face some issues
regarding the installation so this means
that we might have some files which we
might not need related to mySQL so my
suggestion would be to eliminate those
particular files using the sudo apt get
remove Purge MySQL server MySQL client
MySQL common yes
LS y so we're trying to remove any of
the existing files so let's again
let's try to get Auto remove
foreign
again the update
there you go we have the update and now
we shall try to install the MySQL server
with the following command but the
difference is we are trying to install
it with yes that is hyphen y
providing the permissions
there you go you can see MySQL is
running as pid6045
anyways let's also check the status once
the update is done
there you go let's quickly check the
status by using pseudo system control
status MySQL
and there you go
it says the server is operational and
the main PID is
6240 let's quickly clear the screen
using Ctrl L key combination and now
let's start SQL by using the command so
do MySQL they should start MySQL for you
there you go that's how you install
MySQL and Ubuntu operating system first
let's understand what is MySQL workbench
or MySQL workbench
so
MySQL workbench is a graphical tool for
working with mySQL servers and databases
you may use the MySQL workbench for
Server Administration for creating
entity relationship diagrams and for
running SQL queries
MySQL server is cross platform meaning
that it can run on number of different
platforms such as Windows Linux Mac OS
and others
now
we will see
the MySQL workbench functionalities
so first we have SQL development or SQL
development MySQL workbench enables you
to create and manage connections to
database servers along with enabling you
to configure connection parameters MySQL
workbench provides the capability to
execute SQL queries on the database
connections using the built-in SQL
editor
next we have data modeling the data
modeling functionality of MySQL allows
you to create models of your database
schema graphically
reverse and forward engineer between a
schema and a live database and edit all
aspects of your database using the
comprehensive table editor the table
editor provides easy to use
functionalities for editing tables
columns indexes triggers partitioning
options inserts and privileges routines
as well as views
the third functionality is server
Administration
it enables you to administer MySQL
server instances by administering users
performing backup and Recovery
inspecting audit data viewing database
health and monitoring the MySQL server
performance
fourth we have data migration
now this functionality of MySQL
workbench allows you to migrate from
Microsoft SQL Server Microsoft Access DB
cybase sqlite SQL anywhere
postgres SQL and other relational
database management system tables
objects and data to mySQL
migration also supports migrating from
earlier versions of MySQL to the latest
releases
and finally we have MySQL Enterprise
support
the MySQL workbench has support for
Enterprise products such as MySQL
Enterprise backup MySQL firewall and
MySQL audit
now
let's have a look at the MySQL workbench
additions available to us
first we have the Community Edition so
this workbench Edition is open sourced
and can be downloaded free of cost
it came under the GPL license and is
supported by a huge community of
Developers
then we have the standard edition of
MySQL workbench
the standard edition of my S12 workbench
is the commercial Edition that provides
the capability to deliver high
performance and scalable online
transaction processing that is popularly
known as oltp applications
so the last addition that is the
Enterprise Edition we have is the
commercial Edition that includes a set
of advanced features management tools
and Technical Support to achieve the
highest scalability security reliability
and uptime
now this Edition also reduces the risk
cost complexity in the development
deployment and managing MySQL
applications
now with this theoretical knowledge
let's go ahead and see how to download
and install MySQL workbench on Windows
okay so I've searched for MySQL download
on Google and let me go ahead and click
on the first link which is from
www.mysql.com
this will lead us to the downloads page
I've opened in a new tab and in the
download section if I scroll down
you'll find something called as
MySQL Community GPL downloads this GPL
stands for general public license which
is for free so we will install the
community edition of MySQL workbench
if I click on this
it will take you to another page where
you have all the MySQL Community
downloads and here you will find
something called as MySQL installer for
Windows
I'll click on this
and here you can see we have the MySQL
installer 8.0 version
please go ahead and install from this
link you can just click on download
now we already have a video published on
how to install MySQL on windows so
please click on the above link to know
the steps for installation let me show
you the video so this is the video I'm
talking about which is already published
on our channel that is install MySQL
server and workbench on Windows all
right
now once the installation is complete go
ahead and launch the mysq12 workbench so
here
in the search bar if I just type MySQL
you can see here I have the MySQL
workbench 8.0 version installed I'll
open this
so this is how the interface
looks like it says welcome to mySQL
workbench it tells you what MySQL is and
here I have already created a MySQL
connection now let me show you how to
create a new connection I'll just click
on this plus button and it will open set
up new connection
now here you can give a connection name
let me
type my name as MySQL underscore demo
now the connection method you can keep
it as standard TCP
now the host name will be the default
port number should be 3306 the username
I have kept it as root because this is
what I gave while installing
MySQL
now if you want you can also set the
password
if I click on this you can enter
the password
I'll suggest you to give a strong
password I'll click on OK
and let's
try to test the connection
you can see here it says successfully
made the MySQL connection you have the
host the port number user and
it says
a successful MySQL connection was made
with the parameters defined with this
connection just click on OK and I'll
click on OK again
you can see here we have made a new
connection which says MySQL demo
I'll click on this
and it will open my query editor
so let me open my MySQL workbench where
we will perform some Hands-On
demonstrations and look at how to use
MySQL functions write different commands
and we'll see the results
so here on the search bar I'll type
MySQL
so it says MySQL workbench 8.0 version
let me open it
okay you can see I have a
local instance connection I'll connect
to this
and I'll enter the password
so this is how my MySQL workbench
interface looks like let me just drag
this to the top
okay
now the white workspace that you see
here is called the SQL visual editor and
below
you will have the result Pane and the
history output window I'll show you once
I run a query and on the right hand side
you can see we have a help pin or a help
window
so if you want to
check the documentation
or the usage of a certain command you
can just type here and it will give you
the documentation as you can see I just
choose one command that is Select here
and it has written me the syntax and
what select statement really does all
right
and here on the
left side you can see we have something
called Administration and schemas these
are the different databases that I've
already created so for this demo
we will start by creating a new database
so the command I'll write is create
database if I hit tab it will
autocomplete
and the database name I'll give us SQL
workbench
give a semicolon
I'll select this and you see this
Thunder button if I click on this it
will execute my query
okay you can see here
it has returned me one row affected and
my query was successful
all right
now to move inside this database I'll
use
the command called use SQL underscore
workbench which is my database name
let's run this
you can see we have successfully entered
into our database now we can create any
tables perform any calculations
operations data manipulations retrieve
data of fetch data insert data and lot
of other operations
now under this schema let me just
refresh this so that you can see our
new
database this is our database you can
see SQL workbench currently we haven't
created any tables if I
create a table it will show here you can
see here views stored procedures
functions and other things
so first let's get started by
looking at some of the numeric functions
that are available
in MySQL
so I am giving a comment by typing shift
and then my comment that is numeric
functions
first and foremost we'll see how to use
the absolute function in MySQL
so
for using the absolute function I'll
write select
abs
and inside this ABS function I'll pass
in a value let's say 22
now if I run this
it gives me a result that is 22 since
the absolute value of 22 is 22 because
22 we have passed in as a positive value
now let's say I'll pass in minus 22.
and let's run it
there you go you can see here
my absolute function has dropped the
negative sign and has written me a
positive value which is 22 you can try
for other values let's say I'll
select minus 50
if I run this it returns me 50
all right
next
we'll see how
the mod function works
so the mod function Returns the
remainder of a division
so if I write select
mod
and I want to divide
10 by 4.
let's run this and see the result
you can see it has returned me to
because the remainder for 10 divided by
4 is 2. you can also give an alias name
to this
I'll write as remainder
the reason why I am giving an alias name
is because
the result we have got if you see the
column this is not very readable
now if I run this
you can see the difference there you go
now the output is much readable than the
previous one
okay
so let's say
I want to find the mod of another
division 15 comma 3
as remainder again
I'll run it again
you can see 15 divided by 3 the
remainder is 0
let's try for one more let's say
50.6
divided by 2
you can already guess the result it
should be 0.6 there you go you can see
this is my
remainder
now as I said
the below window is called the history
output window or the paint and this is
called the query result pane
which is part of the MySQL workbench
let me just drag this a bit okay
now moving on to the next numeric
function we will explore the power
function
now suppose I write select
power
4 raised to 2.
let's see the result
I'll run it it gives me
16 which is correct
let's see
I'll write select power
10 raised to 3
you can already
think of the result it should be one
thousand
okay
now like how you
use the power function similarly you can
use the square root function in MySQL
the square root function is written as
sqrt
so you can
get the square root of a number by using
the sqrt function
let's say I want to find the square root
of 4.
if I run this it gives me 2 which is the
square root of 4 I'll edit here itself
let's say I want to find the square root
of 144.
where on this it gives me 12 which is
the
square root of 144
now moving ahead
let's say you want to find the greatest
number within a range of numbers you can
use the greatest function that is
available in MySQL
I'll write select
greatest I'll give a range of numbers
let's say 2 5 18 6.
and let's say 12.
and let me run it
it returns me 18 because 18 is the
largest or the greatest number
in my range of numbers
similarly you can also find the least
number for that you can use the least
function
this will return me the minimum number
present in my range of numbers in this
case it is 2.
all right
there's another function that is
available in MySQL is truncate so the
truncate function truncates a number to
the specified number of decimal places
so suppose I write select
truncate
22.897
comma 1.
let's see the output
okay you can see here
so the truncate function has returned us
22.8 and it has truncated the rest of
the decimal places
I want to
truncate up to two decimal places let's
see the result again
you can see here
it has given us 22.89
next
you have another function called round
so the round function MySQL is used to
round a number to a specified number of
decimal places if no specified number of
decimal places is provided to a round of
function
the round of function rounds the number
to the nearest integer so let's see a
few examples
suppose I want to round the value 22.897
this time I am not passing
the specified number of decimal places
we'll see the result
it has returned me 23 which is the next
highest integer
suppose we want to
round it to two decimal places
and give a comma and then say 2
I'll run it it has given us 22.90
so this 8 9 it has converted to nine
zero similarly if you want to
round the number to one decimal please
it will give you 22.9
all right
now
let's create a student's table and store
it in our MySQL workbench
so I'll just give a
comment called student table or students
table
all right
so the way to create a table in a
database in MySQL workbench
is you write create table followed by
the table name that you want in this
case I'm going to create a student's
table
then you start with parenthesis and
give the
columns that you want in your table
so first I want the student ID you can
think of this as the student rule number
give a space and then give the data type
of the column now student ID should
ideally be of type integer I'm assigning
this as primary key
so the primary key will uniquely
identify each record in a table
and it cannot have any
duplicate values
so ideally if you think all the students
in a school will have a unique roll
number
no two students will have the same roll
number
next column I want is the student name
now the name is of type worker
and I'll give the length as let's say 25
then I want the age of the student age
is also of type integer
and I'll write in the same line
then I need the gender
gender of the student should be of type
character and
the size I'll give us
1.
then we have
doe which stands for date of admission
and it is of type date
then we have the city to which the
student belongs to then city is also of
type
bear care
all right you close the bracket and give
a semicolon let's run this
there you go here you can see in the
history window it says
the table was created successfully now
let's just refresh this again
so that you can see the table
here under MySQL workbench database
under tables you can see we have a
student's table let me expand this
further so that you can see the
columns that we have there you go we
have the student ID the student name
yield gender date of admission and the
City
okay
now it's time to insert a few
records to this table for that
you need to write the insert statement
now I'm going to open a notepad where I
have already written the insert
statement so let me just copy paste it
here
okay so here on my notepad I have my
insert statement already written I'll
just copy this and I'll paste it on my
workspace
okay
if I go to the top you can see this is
how my insert into
command look like
you have insert into followed by the
table name which is students then you
have the values keyword and we have the
set of Records so the first
value represents the student
ID or the roll number then you have the
student's name you have the age you have
the gender then we have the date of
admission and then we have the city to
which the student belongs to
all right
now let me go ahead and run my insert
query I'll just select everything and
I'll hit on execute
you can see here you have successfully
inserted 20 rows of information to our
table
now
if you want to
check all the records in a table
the SQL command is Select start from
table name that is students
if I run this
this is my output you can see we have
the student ID the student name e gender
date of admission and City if I scroll
down there are total
20 rows of information in my table
now the star represents you want to
select all the columns in the students
table suppose
you want to return specific columns from
the table you can mention that in the
select statement itself
suppose I want to select the student
name the age of the student and the city
to which the student belongs to so I
will write select Stu underscore name
which is my column name
comma the age
comma
the city
from my table name that is students
let's run it
you can see the output we have only
three columns displayed in the result
okay
now
let's see how to use the where clause in
SQL or MySQL
so the where Clause helps you filter
specific records based on certain
condition
or conditions
suppose I want to see the students who
are from Pune so I want to display only
the records of students who are from
Pune City so the way to do is I'll write
select
star from
students
where
City
equal to
Pune
now this Pune is a
character type so you need to mention it
within single quotes
let's run it
there you go in the output you can see
there are total four students who are
from Pune you have Joseph
anubhav Akshay and Anand
all right
now
let's say you want to
filter only those students who are from
Miami and their gender is male
again you are going to use the where
clause and along with the where Clause
we'll use the and operator
so I'll write
select
star from
students
where
CT equal to
I'll say Miami
this Miami should be within quotes
I'll use my and operator
and then write the gender should be
equal to
M or meal
again
M should be within single quotes I'll
give a semicolon and let's run it
you can see here
we have Whipple
ishan tanishq and
Amrit who are from Miami city and their
gender is male
cool
now moving ahead
suppose you want to know the students
who are either from City Boston or
Chicago in that case you are going to
use an or operator
I'll just copy this
SQL command and I'll paste it here and
I'll edit in the same query so this time
we want the students who are from
City Boston or Chicago so here instead
of Miami I'll write Boston
I'll use an R clause or an or operator
and instead of gender equal to mail I'll
again write
or city equal to
Chicago
let us
run the SQL query and see what we have
so there are total
six students who are either from City
Chicago or from Boston we also have a
female student Eliana
all right
now moving further
let's say you want to display the
records of the students
who belong to any city rather than
Chicago
in that case you are going to use the
not operator
so I'll write select star from
students where
not City equal to
Chicago
let's run it and see the result
all right you can see total we have
returned 17 rows of information which
means
there are total 17 students who belong
to other cities apart from Chicago if
you see the result you won't find any
student who is from
Chicago City
okay
now there's another important
feature of MySQL where you can group
certain rows of information based on a
particular column or columns
so let's see how to use Group by in
MySQL I'll give a
comment called Group by
now in this group by Clause we are going
to find the total number of students
present in each City
so the way to do is I'll write select
I want to select this city
and then I'm going to use the count
function this is an inbuilt MySQL
function
I am going to count the student IDs
I'll give an alias as
total students
from my table that is
students
then
I am going to group my result based on
each City
let's run this
and see the output
there you go you can see here
so our table has total six cities you
have Pune New York
Miami Chicago Detroit and Boston and
here on the right hand side you have the
total students that we just created
using an alias name and this total
students column has the total number of
students from each City so if you see
here
New York has four students Pune has four
students in Miami Chicago we have four
and three students and in Detroit we
have two students respectively
all right
the next Clause we are going to see is
having
now having and where are kind of similar
but there are certain differences
now
for our example we are going to find the
cities where the total number of
students are more than three if you see
the results pin
so we have Pune we have New York and
Miami as the cities where there are more
than three students
so let me show you how to return these
three records so I'll write select City
comma
I'll count
the students using the count function
and I'll pass my column as student ID
and I'll give an alias as total students
from
my table that is students
I'll use the
Group by Clause Group by City
and then I am going to use having
the count of
student ID
greater than 3.
let me run it
and show you the result there you go
as expected we have Pune New York and
Miami where the total number of students
are more than three
let's see
how the order by
Clause works
so the order by Clause is used to
filter the records based on a particular
order in ascending or descending order
so suppose
see I write select star from
students
and then I'll write
order by let's say City
let me show you the result first
okay you can see
the city column has been ordered in
alphabetical order
so first the city start with b then we
have c d m
and then we have n and p
what if I want to order the resultant
descending order
so again it will alphabetically sort my
result in descending order of City so
on the top we have Pune
because
alphabetically in descending order Pune
starts with p so it appears on the top
then we have New York followed by Miami
Detroit Chicago and Boston
now it's time to explore some string
functions in MySQL
so I have given a comment string
functions
first let's say you want to convert a
certain string into upper case so I can
write select
the function I'll use is upper
and within this function you can pass in
the string let's say
I'll write India
if you want you can give an alias name
as let's say uppercase
I'll give a semicolon
and let's run it
there you go so my input was in sentence
case and using the upper function we
have converted everything into uppercase
similarly let me just copy this
and
I'll show you
if you want to convert a string into a
lower case you can use the lower
function
I'll run this you can see the result
everything is in lower case now of
course I need to change the Alias name
to lowercase
instead of using lower as the function
there is another function that MySQL
provides which is called the L case
I'll just edit this and write L case
and let's see I'll write India in
upper case
let's run it returns me the same result
cool
moving on
let's say you want to find the length of
a string you can use the character
length function
I'll write select
use the function character length
and I'm again going to pass in my
string as India as
let's say total length
let's run it this time I'm going to hit
Ctrl enter to run MySQL command
there you go
it has given us the right result which
is 5 because India has five characters
in it now these functions you can also
apply on a table
now let me show you how to do it let's
say we already have the students table
and you want to find the
length of
each of the student names
so here you can pass
S2 underscore name
and you can give the same Alias name
let's say total length
and then you can write from
table name that is students
if I run this
you can see the output it has given me
total 20 rows of information
this is not readable actually let me
also
display these student names so that we
can compare their
length
all right
I'll run this again
and now you can
see the result so Joseph has six
characters nilis has six Whipple has
five and above has seven similarly if
you see Akshay has six tanishq has seven
Raga was six
come in size 7 rabada has six so on and
so forth
now instead of using this character
length you can also use the function
care length
it will work the same way let's see the
result
there you go it has given us the same
result you can either use character
length or care length
there's another very interesting
function called concat so the concat
function adds two or more Expressions
together let's say I'll write select
I'll use the function
concatenate
the function is actually concat
and I'm going to pass in
my
string values let's say India
is
in Asia
let's run this and see our result
you can see here it has concatenated
everything
let us make it more readable I'll give a
space in between so that
you can read it clearly
now this is much more readable India is
in Asia
and if you want you can give an alias
name as well as let's say merged
there you go
now the same concat operation you can
also perform on a table
I'm going to use the same students table
let's say I want to return the student
ID
followed by the student name
and then
I am going to merge
the student name
followed by a space
followed by the age of the student
and I can give an alias as let's say
name underscore each
from my table that is students
let's see how this works
okay you see here the result is very
clear
we have the student ID the student name
and the concatenated column that we
created which was name underscore each
where we have the
student name with a space followed by
the age of the student
so scroll down you can see the rest of
the results
cool
now moving ahead
let's see how the reverse function Works
in MySQL
so the MySQL reverse function returns a
string with the characters printed in
reverse order
so suppose I write select
reverse
I'll use the same string again let's say
I have India
let's run it you will see all the
characters printed in reverse order
again you can perform the same operation
on
a table as well let's say I'll write
select
reverse
and I'll pass in the column as student
name
from my table that is students
let's run it
it gives you 20 students and all the
names have been printed in reverse order
okay
now
let's see what the replace function does
so the replace function replaces all
occurrences of a substring within a
string within a new substring
so let me show you what I mean
I'll write select
replace
I'll pass in my input string which is
let's say orange is a
vegetable
which is ideally incorrect I am
purposely writing this so that I can
replace the
word vegetable
with
fruit
okay
so what this replace function does is it
is going to find where my word vegetable
is within the string my input string and
it is going to replace my word vegetable
with fruit
let's run it and see the output there
you go now this is correct which is
Orange is the fruit
all right
now
MySQL also provides some trim functions
you can use the left trim right trim and
just the trim function
so let me show you how this
left trim works
left rim or L trim removes the leading
space characters from a string past as
an argument
so say I write select
I'll use the left trim function which is
L trim
and then I am going to purposely give a
few spaces
in the beginning of the string I'll give
a word let's say India
and then I'll give some space after the
bird India
and see how the
Ultram box if I run this it gives me
India which is fair enough
but before that
let's first find the length of my string
so I'll use my length function here and
within this function I am going to
find the length of my string which has
India along with some leading and
trailing spaces I'll paste this here
and I'll run it
okay so the entire string is 17
characters long or the length of the
string is
17. now say I use l trim on my same
string
what it returns me is India
and if I
run length over it you can see the
difference
as in you can see how many spaces were
deleted from the left of the string you
can see here now it says 17
and
I'm going to use l trim
let's see the difference it gives me 12
the reason being it has deleted
five spaces from the left you can count
it
one two three four and five so 17 minus
5 was
12 which is correct similarly you can
use the r trim function which removes
the trailing spaces from a string
trailing spaces are these spaces
when you use left trim it deletes the
leading spaces which is this
now let me just replace Ultram with r
trim which stands for right trim and see
the result
so the length is 10 now the reason being
it has deleted
seven spaces from the right of the
string if you can count it one two three
four five six and seven
cool
you can also
use the trim function which will delete
both the leading and the trailing spaces
so here if I just write trim
and I'll
run it
it gives me five
because India is total five characters
long and it has deleted all the leading
and the trailing spaces
all right
there's also a function called position
in MySQL the position function Returns
the position of the first occurrence of
a substream in a string so if the
substring is not found with the original
string the function will return 0.
so let's say I'll write select
position
I want to find
where
fruit is
in my string that is
Orange
is
a fruit
I'll give an alias as name
the sum error here
it should be within double quotes
now let's run it and see the result okay
it says at the 13th place or at the 13th
position we have the word fruit in our
string which is Orange is a fruit
now the final function we are going to
see is called ASCII so the ASCII
function Returns the ASCII value for a
specific character let's say I write
select
ASCII of the letter small a
if I run this
it will give me the ASCII value which is
97
let's say you want to find the ASCII
value of
4.
let's see the result
it gives me 52.
all right
so that brings us to the end of the demo
session on MySQL workbench
let me go to the top and show you the
things that we covered so first of all
we created a new database called MySQL
workbench which you could
see it here under schemas there was
a database created called MySQL
workbench then we entered into the
database using the command use MySQL
workbench or SQL workbench we explored a
few numeric functions where we saw how
to use absolute mod power square root
least greatest truncate round
and then we created a table called
students we inserted some 20 rows of
information of different students and
their age date of admission City
we saw how to use where Clause how to
use the and and R operator
we used Group by to group our records
based on certain conditions we also used
having
we used order by and then we look at a
few
string functions such as lower upper
concat character length reverse replace
ASCII and position
if you're an aspiring data engineer
looking for online training and
graduating from the best universities or
a professional who elects to switch
careers with data engineering by
learning from the experts then try
giving a shot to Simply learns data
engineering post-graduate program from
Purdue University in collaboration with
IBM the link in the description box and
the pin comment should take you to the
program being offered now let's quickly
look at the syntax we need to create a
table in SQL so we will be using the
keyword create to let the SQL know that
we're trying to create an element which
can be a table or database followed by
that we will be using the table keyword
to explain the SQL that we are trying to
create a table here followed by that a
customized table name then inside that
we will be starting with the parameters
which can be the elephants or columns
which are present in your table column 1
or parameter one it's data type and
constrained so what is a constraint we
will be understanding about the data
wrapping constraint when we are in the
Practical mode Let's quickly try to
understand the syntax over here so these
are the things create keyword table
keyword table name which is a customized
or user defined name for the table then
the parameters involved in the table
that is the columns column one two three
data type and constraint followed by
that close the bracket and use the
semicolon to explain SQL that it is the
end of the code now let's get back to
this equal workbench so we logged into
the SQL workbench so now we have logged
into the SQL workbench now previously we
had created a database that is simply
learn database now we will try to create
the table in the same database now we
will be using the create keyword
table
now table name which can be anything
let's try to create a student database
or employee database
you can see that
I'm using capitals for keywords and
Smalls for the user defined ones just to
make it clear for the reader to
understand what is what if it is in
capital it is a keyword if it isn't
small it is a user defined name now EMP
ID
which is an integer type and then
a constraint
not null
so remember the data type and
constraints that we discussed earlier so
this is it so you're trying to tell the
sequel that the ID what you're creating
is of integer data type and since this
can be a primary keyword it should not
be null right now the next one
employee name
which can be character data type so
let's keep it as c h a r or character
and let's give the size as 115.
now the next one
okay I forgot to give the constraint
default
okay let's not keep this D4 null it
cannot be null as well
then comes the address
which can again be character
and let's give it as 500 SD
size
and followed by that
it can be default
here we are trying to tell SQL that it
is okay to keep the employee address
column as null it can be blank again
it's your wish if you don't want the
address column to be empty you can keep
it as not null and if it's all right for
you to keep it as null then you can
provide it as default null right so
these are the parameters their data
types and the constraints right now we
will understand them a little more
detail in the theoretical section now
followed by The Columns the last one is
to dedicate or create a primary key let
SQL know which is a primary key so
primary key is very important for every
database or table and I'll explain you
that in the theoretical section again
now which is the primary key the ID what
we created for employees that is EMP ID
is the primary key this particular
primary key will be really important
when we are trying to work with two
different tables with one single column
in common between both the tables right
so with that we have created the code
for creating a new table in a database
now let's quickly try to execute it so
there is a small error let's try to
resolve it
yes so the small error that we created
is we did not try to select a database
right before creating a table you need
to select the database or explain SQL
which database is supposed to be used
now for that we have to use the use
keyword and the database name that is
simply learn DB
semicolon now when you run this
particular code SQL will understand we
need to use the simply learn DB and then
it will get access to that particular DB
then it will read this particular code
and try to create a new table let's
quickly run it
and there you go
let's try to eliminate this code for a
while run this now we are using the
simply learndb
eliminate this code
now
on this particular code once again and
okay
so instead of character we can use
worker
and run it
since character limit was 255 and we
gave 500 instead of character if we
provide worker we can provide the
maximum limit so now the table is
successfully created here so that's how
you can create a new table in SQL
now the syntax is as follows now here
you have the insert and into keywords
table name is the user defined name for
the table then you have the columns that
is column number one two and Etc then
after declaring the column names you
have the keyword values which will help
SQL understand this is a tuple and these
are the values involved inside the Tuple
that is Row 1 value 1 Row 1 value 2 so
on and Row 1 value n so this type of
syntax will help you to add one Tuple at
one time and this will take a lot of
time to process you can see to insert
the next apple we are writing a
completely new syntax once again using
the same insert into table name column
one two three and values and row number
two that is the second table right so
this type of code will take longer
duration to run as well as it will take
longer lines or number of lines will be
extra so is there a way where you can
add multiple tuples in one single curve
yes there is so the syntax will be
completely same right so you will be
using one insert into keyword one table
name and once you will be declaring all
the column numbers and once you will be
using the values keyword the only
difference is you will be adding
multiple tuples under the values bracket
right you will be declaring the number
of values you want to include in one
single go and this whole query becomes
as a whole and once you run this query
all the values will be added at once now
that you are clear with the syntax let's
quickly get back to the SQL workbench
and try to run this command
now we are on the MySQL workbench let's
quickly login
there you go we have logged in let's use
the simply learn database once again so
that we get access to the data which we
have so we already have an employee
stable so let's see what's presently
included in employee stable select star
from employee
table
semicolon
so this is the data that we already have
in our table now let's try to add some
more data
so now we will include one single
element or one single Tuple data related
to one single employee right using the
first type of syntax let's quickly
execute this
the command got executed again let's
quickly see what's present in the table
select start
from
employee table again you can see I'm
using lowercase for the user defined
keywords and uppercase for the
predefined keywords just to make sure
that the code is understandable
and which is the user defined keyword
and which is the predefined keyword so
these are the the ones in small case are
user defined and the ones in uppercase
are predefined right so we have
successfully included one single element
or one single Tuple the details which
are related to Prime and now let's try
to modify the same code and try to
include few more tuples inside the same
insert command and try to insert
multiple rows into the table
now here you can see we are using the
same insert into employee table command
and instead of Brian we replaced or we
added six more entries under the values
section right and the only difference is
we are trying to separate the tuples
using a comma you can see we are
enclosing one Tuple inside the
parenthesis and we are separating two
tuples with the help of a Karma right
ensure that you include comma between
every Tuple and you can ignore the comma
for the last stop you can see we are not
using any sort of comma or any sort of
specifier at the end right so and we are
closing the command using the semicolon
in this explains equal that it is the
end now we are going to run this command
and see the output
so there you go the command got
successfully executed now let's again
execute the select command and see if
the data is involved or included or
inserted into the given employee table
now there you go the command got
successfully executed and you can see
the table over here and you can see that
all the data or all the doubles we
included into the table using the insert
command in one go are successfully
included so that's how you insert
multiple rows into a table using SQL so
first let's have a quick look on the
syntax we use to create a database so
first we have a create keyword which
will explain the SQL Server that we are
trying to create a new element which can
be a database or a table next we have
the keyword database which clarifies the
SQL that we are trying to create a new
database the next one is not mandatory
if not exist just we are trying to make
sure that the database that we are going
to create is not already existing so if
you use this if not exist then SQL will
tell you in case if there is an existing
database on the same database name then
it will not allow you to create a
duplicated database and followed by that
we have the database name which can be
anything so I've just created as
database name here now that we are clear
with the syntax let's get back to the
IDE that is my sequel to execute a
command to create a new database so now
we are on the SQL workbench now let's
quickly try to login
there you go now you can see some
existing databases on the left hand side
of the workbench sysr system as the
default one so I already created test
and trial let's try to create a new one
right away so the create keyword
database
keyword and then if not exists
so here you can see I'm trying to
capitalize the keywords so that it's
easier to understand what is the code
and what is the user defined names right
so create a database if not Xs and
click done
DB
that's our code let's try to execute
this
and there you go so here you can see in
the action output create database if not
exists simply learn DP has been executed
successfully now we can run a new code
which says show databases
foreign
this should show us the newly created
database which is simply learn DB which
is right over here let's quickly take a
look at the syntax that we will be using
today so we will be using the alter
keyword and the table keyword followed
by that we will be specifying the table
name in which we want to add a new
column then we have the add keyword and
name the column which you want to add to
your existing table then the data type
of that particular column with
constraints if you have any now that we
are clear with the syntax let's get back
to the SQL workbench where we can
execute this particular command now we
are on the SQL workbench and let us
execute this particular command and see
what we have in our existing table okay
I think we might have to use this
particular command first you need to get
the access to your database then you can
get access to your tables in your
database right so we have this
particular data let's try to add a new
column which explains about the phone
number of a employee working in your
organ position
okay now we can use this particular
command which is called the table
there you go so we have added the column
phone number data type and the
constraint not null and if anything is
not added in that particular column the
default value should be n a right let's
quickly execute this particular command
there you go now let's check if the new
column is added or Not by running the
silk command
there you go the new phone number has
been successfully added and by default
since we did not add any number we have
N A in that particular column so that's
how you add a new column to your
existing table in SQL how do you delete
a row in SQL let's quickly take a look
at the syntax
so we will be using the delete keyboard
and the from keyword adding the table
name and giving a where Clause with a
user defined condition so this will be a
basic Syntax for the process of deleting
a single Row in the SQL table now to
understand in a much better way let's
get back to the SQL workbench so now we
are on the SQL workbench and previously
we tried to create table add some data
using the insert command and update a
value using the update command now let's
say we have to delete the last row which
is 1006 Jeremy Hyderabad let's say
Jeremy found a new job in a new
organization and now you need to
eliminate his credentials from your
database so we will be using the
following code
that is delete
from table name as employee
table
and the where clause
the condition
which is
EMP
ID
is equals to 1 0 0 6 now let's try to
run the code
there you go the employee is being
eliminated from that particular database
now let's try to recheck the table
so select
star from EMP
eror
from the code and there you go the last
ID which was one zero zero six has been
eliminated from your database
now you might be having multiple
questions is adding a date is that tough
and SQL tables no you can add a date and
SQL in the format of worker or character
everything but if you want to perform
analytics then using the date format or
date data type would be more beneficial
right so for the SQL table you do have
some formats to follow so that's exactly
what we are going to discuss in this
particular tutorial now let us imagine
that we're going to create a table using
the following syntax that is create
table keywords table name which is a
user defined table name and the
parameters their respected data types
and at the end let's say we have a date
element as date of joining and for date
of joining we will have the data type as
date right then let's see the code
and you need to make sure that when you
are trying to enter the date element
into your table you need to be a little
more cautious to follow a pattern
SQL has predefined approach to store
dates which is in the format of YY here
mm for month DD for dates you need to
follow this particular way of writing
your date and if you make some minor at
let's say you add a date first then the
month and then the year then obviously
SQL will throw an error so we don't want
that to be happening so in that case
let's try to follow the approach that
SQL has now let's quickly go back to SQL
workbench and see how exactly it works
so here we are back on the SQL workbench
let's run this use database command to
get access to our database there we go
now let's see we have a freshly created
database and it doesn't have anything
right now we will add these particular
details into the data table and here you
see we are following the
year month and date approach right now
let's quickly run this command and there
you go the date has been updated into
the table let's now run the command
again now we have the dates here now
let's say we try to break the rules now
we will try the DD mm and the YY format
here right now let's try to run this
particular code once again so let's
eliminate all the previous elements
and let's consider this as a new entry
right now let's try to execute this
there you go so it will automatically
throw an error saying the date value is
incorrect you need to change this back
to the original form that is YY month
and the date
only then it will accept this particular
value
there you go
so that's how you add date to your SQL
tables the second highest salary in SQL
so this particular type of questions
will be most frequently asked and data
analytics interview questions so let's
try to understand the syntax of how to
find the not just second but any number
of salaries given in a SQL table let's
say your interviewer asked you to find
the top third salary out of fourth
salary you can find that using the same
syntax so the syntax is something
similar to this as shown now but before
we begin if you are an aspiring data
analyst then I have the perfect cause
for you we have the professional
certificate program in data analytics
booster carrier over this data analytics
program in partnership with Purdue
University and in collaboration with IBM
which features master classes and
follows an applied learning model with
real-time projects and business case
studies now that we have a clear
understanding of the pgp data analytics
certification with simply learn in
collaboration with IBM from Purdue
University we will get started with our
tutorial for today's session
so here you can see select star you can
also use these specific columns you want
that is name and salary but I'm
selecting star that is every single
column in my table that is Select star
from employee table Group by salary so
you'll be grouping by salary here and
order by salary descending since we
wanted to find the highest we will be
choosing the descending order that is
increased number that is the highest
number to the lowest number in case if
your employer or if your interviewer
asks you to find the lowest salary then
you will be using the ascending order
right so since we are given the
condition that we have to find the
highest we will use the descending order
then limit n minus 1 let's say You're
supposed to find the fifth highest
salary then the formula will be 5 minus
1 and the limit one that is you just
want one single row to be displayed on
your output right so that's the reason
we'll be giving limit as one right so
this is the simple syntax you will be
following now let's quickly execute this
on MySQL workbench and try to get our
results
back to the Microsoft SQL workbench so
now we are on the MySQL workbench let's
quickly use the database and get access
to our all tables now we have access to
the tables and the employee table which
we were working on
so let's quickly have the show tables
here and
we have employee and employee table 2 we
will be accessing the employee table
which has the salary details so there
you go we have Rakesh Jack Regina Etc
right so here you can see Karen has the
highest salary and the next second
highest salary is Rajesh so we need to
fetch this particular column here right
since our expectation is to find the
second highest salary let's try to
write the following code that is Select
star from employee
Group by
salary
earned by salary
descending order since we want highest
salary and the limit
n minus 1 that is 2 minus 1 or you can
also write as 1 comma 1
and done
and let's quickly execute this code and
there you go now let's say we want to
find the third highest salary so here n
minus 1 3 minus 1 is 2
and execute this
and there you go you have Regina so
that's how you can extract second
highest salary or any number of highest
salary of the lowest salary based on the
query changes you're doing let's say if
you want the highest salary then you
should be using descending order let's
say you want the lowest salary should be
using the ascending order so that's how
you can extract the second highest
salary from SQL tables now how do we
create a view in Excel so it's as simple
as creating a new table the syntax is as
follows you just need to add create a
view and your customized view name as
the statements now what are the
statements statements usually have the
statements of what you call it the query
statements for example select start some
data what you want to fetch from your
table
yes I totally understand select might be
a really short one but sometimes you
might have to add some where conditions
you might have to add some sub queries
and the entire query length might go up
to 10 to 15 lines
right now you might not be able to
execute that query for every single time
so if you create a view for that and if
you just write select that particular
View and you get all the data now let's
understand this more easily by going
through a practical demonstration on
MySQL now we are on the MySQL workbench
we are having a small database which is
flights and in that we have a table by
the name flight data and this is the
data which we have added into a flight
data right let's run this and get the
table so here you have the information
on your table about a few flights you
have the airline date of Journey
departure destination total stops
additional information
etc etc right now let's say if someone
asked you to fetch a flight from Indigo
which is completely Non-Stop
control enter now you have this right
now you face this query for once
and what if someone asks you to get this
data for 10 times a day maybe you have
10 clients who are asking for the same
information would you write the thing
for you 10 times
no right similarly here you have let's
say someone wanted to go to Delhi and
they asked you to get the information
for the flights which are going to Delhi
and someone asked for the flights which
are going from Bangalore to Delhi
right similarly you have many of such
things so what would be helpful here so
let's say you add one more query
which reads as
create
View
now the customized view name could be
anything let's say View
Indigo Non-Stop
as
your query right let's quickly execute
this query and it should create a new
view for you the new view is currently
done
similarly let's try to create a new view
again
create View
let's name it View
lights
Delhi
Kolkata
and the Bangalore daily flights
right now you have the queries ready
or the views ready
now all you have to do is just get the
select statement
star from the view name
this is simpler right
control enter and you have the data over
there now let's say somebody asks you to
fetch the data for flights from
Bangalore to Delhi all you have to do is
Select star and you should be having the
data
there you go right as simple as that so
that's how you can create a view in SQL
and in case if you wanted to drop it
let's say you don't need it anymore so
it's simple just drop the view
and the view name let's say you want to
drop this particular View
paste it there and Ctrl enter there you
go the view got successfully dropped now
when you try to run this query you will
not get it if you're an aspiring data
engineer looking for online training and
graduating from the best universities or
a professional who elects to switch
careers with data engineering by
learning from the experts then try
giving a shot to Simply learns data
engineering post-graduate program from
Purdue University in collaboration with
IBM the link in the description box and
the print comment should take you to the
program being offered
so what exactly are temp tables in SQL
so temp table is a temporary table so
the term temporary is self-explanatory
you know that every database and SQL has
tables right now let's say you created
10 tables in your database and you close
your MySQL workbench or you close your
database and you restart it after a
while and then you will have all your 10
tables intact in your database but
temporary table is not like that it is
something different which has its
existence until the session of the
database is running let's say you open
the database now you have this session
of database running you created the 11th
table as a temporary table and that
particular 11th temporary table will be
existing in the database only until the
current database is running and active
once you close it once you turn it off
or once you restart it the temporary
11th table that you created will type or
it will be eliminated so that is the
meaning of temp table now let's see how
we can create a temporary table
so the syntax is completely similar to
the temporary or to the table what we
usually create right is similar to the
table what we regularly create but the
only catches we will be using the
keyword temporary
create temporary table table name which
is user defined name and inside that the
parameters may be the employee ID
student ID and planning student ID name
Etc right so this is how we create the
temporary table now let's quickly get
back to the simple web page and try to
create a temporary table add some data
into it and try to display the temporary
table if getting your learning started
is half the battle what if you could do
that for free visit scale up by simply
learn click on the link in the
description to know more
now we are back on the SQL workbench
and meanwhile we are logging in
you might have a question right
when you say that the temp table will be
existing or running only until the
database is active then why create those
temporary tables in the workbench right
the sole purpose of using temporary
tables is
in a few cases the intermediate results
of the data analytics process are
important and you can have a quick
reference on intermediate results and
you don't want them to be existing in
your database in a permanent basis right
for such scenarios you can use a
temporary database now here on my
workbench we have a simple code for
creating a temporary table so I'll be
creating the temporary table on the name
of student and we have student ID
integer data type student name worker
and department and student ID will be
the primary key now let's use the
database that is use simple and database
to get access and we have the access num
let's quickly see what and all tables we
have using the show command
enter
and we have two tables employee and
employ table two but not student
right now let's quickly execute this
control enter
and now let's use the insert command
same like we inserted in the previous
tables insert into table name student
parameters ID name department and values
comma separated values student ID name
and departmental Group whatever he took
in college
right now let's execute this code
the data has been successfully included
now let's Select Staff from Sprint that
is view the contents in this particular
table we have the values in this
particular table and let's also see if
we have that particular data included in
the database or not let us show tables
there you go it's not included in the
database but it is active when you try
to you know print the values in that
particular table which is in the
database it will show you but when you
try to fetch that particular existence
or the permanent existence of that
particular table it will not be present
and this particular table will be active
only until the database is active now
let's restart this particular work which
I'm closing it
restarting it
now if I run this I will not get it you
can see the error the database
right okay then let's have the database
selected
and let's try to run the command
there you go
table simply learn DB dot student does
not exist
right
previously when you try to execute the
table was giving us values now we have
the error saying the table does not
exist right that is how a temporary
database runs how to update table in SQL
let's quickly take a look on the Syntax
for today's function so here we have the
update keyword table keyword and the
table name which you want to update and
followed by that we have the set keyword
which will help this equal to set a
particular column name to a new
parameter to which you want to update it
now you are giving a where condition
over here so where is the keyword and
the condition as a user defined
condition and the combination of where
and condition will help SQL to identify
a particular Tuple and update the
parameter under that particular
condition now that we have understood
the syntax let's quickly get back to the
SQL IDE which is my SQL workbench and
try to execute a sample command so we
are on the IDE and previously we try to
create an unplug table so let's select
the same table for that let's use the
database we created that I simply learn
DB
semicolon enter so we are on the simply
on database now to update a table we
need to have some data in it so as we
remember we just try to create a normal
table in the previous session now let's
try to add some data into the same table
using the insert command so let's try to
make use of the insert command and
insert into is the keyword and plot
table is the table name and these are
the columns we have in the employee
table and followed by that we have the
values keyword and followed by that we
have the data which we need to enter
into the table and these items are in
the form of a tuple and every Tuple is
covered using parenthesis and inside the
tuples you have the first one which is
an integer type data which is as it is
and when you come into the text type
data they are covered using the single
quotes So let SQL identify that it is a
character type data now after entering
all the tuples separated by comma we
have a semicolon which indicates the end
of the statement now let's try to run
this particular statement and add the
data into the employee table okay let's
select the database once again and now
let's try to add the data there you go
now we have the data added onto our
employee table let's quickly check the
employee table
select
start from
employee
table
there you go we have all the data added
onto the table employee ID employee name
and employee address let's say the last
employee Jeremy who's been working in
Delhi since a past couple of years and
you decide being the manager you decide
that he should be relocating to
Hyderabad and you need to update the
unclutter table now by changing the
location of Jeremy from Delhi to
Hyderabad now let's try to run our
update query so first we have the update
keyword then employee
table
then
set
EMP address
equals to
Hyderabad
where
condition EMP
[Music]
ID
equals to
foreign
so there you go the code is complete we
have the update keyword followed by the
table name then set keyword to set that
particular column that is the employee
address to the key Hyderabad from Delhi
we are changing it to the Hyderabad
which is value or key value whichever
you consider and since it is a text type
value we are encoding it using the
single quotes then the where clause and
the condition which is employee ID must
be equals to 1 0 0 6. now let's try to
quickly run this command
there you go now let's recheck if the
table has been updated or not so select
star from employee
table
let's run it
and there you go the last location
Jeremy which was Delhi is now updated to
Hyderabad so that's how you update
values in a table
now let's quickly take a look at the
syntax that we will be following to
execute this particular command
the syntax is as follows we will be
using the alter table keyword then the
table name where we want to eliminate
the column followed by that the drop
column keyword and the column name now
let's get back to this equal workmans to
execute this particular command now here
on the SQL workbench and you can see we
have five different columns over here
and we have the phone number column
which does not have anything now we will
try to eliminate this particular phone
number column since we do not need that
for our purposes now the command is
really simple as discussed before we
will be using the alter table keyword
and the table name and the drop column
keyword and the phone number which is
the column name now let's quickly
execute this particular command and see
the output there you go now the column
phone number has been successfully
eliminated now let's run the select
command once again and see the new table
there you go the phone number column has
been successfully eliminated now with
that we have come to an end of this
session on how to eliminate a selected
column in an existing table in SQL that
is how to print or how to obtain current
date in SQL now the syntax is really
simple we have two different commands to
do that we can just type in select get
date or we can just type in select
current date or Cur date so these
particular commands or functions will
fetch as the current date in SQL now to
execute these commands let's get back to
the Practical mode which can be a SQL
workbench so now we're on the SQL
workbench let's login
there you go so we have both the
commands let's try to execute them
so enter and there you go so we have the
current date so that's how you can fetch
current date using get date function or
the current date function in SQL
how to change the data type of a column
in SQL now let's take a quick look on
the syntax we will be using to change
the data type of the column in SQL
so this is a syntax we'll be using so we
will be using the alter keyword table
keyword and table name so Alta is the
keyword which will help SQL to
understand that we are trying to modify
something and we are selecting the table
by offering the table and then we have
the modify keyword which will help SQL
to understand that we are trying to
modify something and we are modifying
the column name from the table selected
and we are modifying that particular
column to a different data type which
will be specified over here in place of
data type keyword right so now that we
are clear with the syntax let's proceed
and execute the command and change some
column data types now we are on the SQL
workbench previously we created an
employee database in simply learn DB and
we will be using the same table here so
we will be typing use simply learn DB
so that we get access to the simply
learn DB and the tables we have there so
let's select all
employee table
Colin let's execute this
so there you go we have the table on our
screen and let's quickly describe the
table using the desc command
and this will give us the data types of
each and every column in our table now
you can see we have pin code in the
format of worker so let's try to alter
or modify this particular pin code
column from worker to integer since it
only saves the numbers right so our
Command for that was alter
table
table name which is employee table
modify with the keyword
modify the column PIN code
to integer
semicolon now let's quickly run this
command
and there you go the command got
executed successfully let's try to
describe the table once again
and there you go now the PIN code was
earlier mentioned as worker and now it
got changed it to integer now that's how
you alter or modify or change the data
type of a column in a table in SQL so
let's quickly take a look at the syntax
that we will be following to change the
column name in SQL so the syntax is as
follows we will be using the alter and
table keywords and we will be specifying
the table name and then we will give the
rename column keyword then the old
existing column name and to the new
column in which we need to change it to
so having a clear understanding of the
syntax let's try to execute this command
in the Practical mode so let's get back
to the MySQL workbench so now we are on
the MySQL workbench let's quickly get
access to the simply learn database
there you go and now let's quickly take
a look at the column names in our
existing table
now you can see the First Column is the
employee number let's try to change that
by using the alter table
command and then
and now the rename keyword
the column name is EMP number
two
EMP ID semicolon
let's quickly execute this command
there you go now let's try to execute
the select command once again and see
the output there you go now the employee
number has been changed to employee ID
now before we execute the actual code
let's take a quick peek on the syntax
that we will be using today now the
syntax is completely similar to the
regular syntax that we usually use but
we'll have the select keyword parameters
that you want to print in your table the
from keyword and the table name which
you are trying to access the only
difference is you will have a new
keyword that is the group by keyword and
based on a certain parameter right now
we would get back to the Practical mode
that is the MySQL work means to
understand the practicality of group by
clause in a much better way if getting
your learning started is half the battle
what if you could do that for free visit
scale up by simply learn click on the
link in the description to know more
workbench now let's get access to a
simply on database there you go now
let's quickly take the look at the
tables we have we have two different
tables
now let's get access to our
employee table
now we have all the employee numbers
employee names Department designation
salary Etc right let's say you wanted to
know the average salary of all the
employees right so that what we select
that is the AVG
average function of salary
closer bracket from
right
let's execute this
there you go now you have the average
salary of the entire office but what
happens when your manager asks you to
find the average of a each and every
Department average salary of the
employees in each and every Department
how would you do that
right every organization has multiple
departments HR development testing etc
etc right now your manager wants the
individual Department's average salary
then you can use this particular clause
which says Group by department so the
entire table will be categorized based
on the Departments and it will be
grouped on the basis of the department
and I'm also using the order by here
which we will discuss in the next
session but to give you a brief
understanding of why we're using order
by let's say your manager asks you to
find the department which has the
highest average salary right then you
will be ordering the tables or ordering
the rows based on the descending order
of the salary now let's quickly execute
this query and see the output there you
go the query got successfully executed
and we have the average salary of each
and every department now before we begin
let's try to take a quick look on the
syntax that we will be using today right
it is simply the select star from table
name using the where clause and the
column which you're choosing for that
and the between operator and we are
giving some constraints and those
different constraints are encapsulated
between an and command here let us say
that your manager tells you to select
all the rows where selecting one single
column that is salary where the
employees have the salary from 10 000 to
20 000 right then you will write the
command select star from table name with
salary between the value 10 000 and the
value 20 000. so this is how the between
command works now let's execute the same
practically let's get back to the MySQL
workbench if getting your learning
started is half the battle what if you
could do that for free visit scale up by
simply learn click on the link in the
description to know more
now we are back on the MySQL workbench
let's make some edits to the same
command select star from employee where
salary
between operator
so we are using floater integer type so
we will not need a single crochet double
quotes number 10 000. and operator
number twenty thousand
right now let's execute this command
there you go now we have all the
employee list which have or who have
their salary ranging from 10 000 to 20
000 that is how to use like operator in
SQL so at first let's take a quick look
on the syntax that we will be using for
getting the like operator operation
right so it's really simple so all you
need to do is Select star from table
name so instead of star you can also
give your selected columns here but by
default I'm using to select the entire
table right and it can go with a where
Clause so after the table name you will
be given the where clause and the column
name that you want to extract and you
will be using the like operator with the
constraints and I'm using the single
quotes here right because this
particular like operation can be used
upon string or worker or character type
data types right so we will represent
that particular data type using single
code now that we are clear with the
syntax let's go to the Practical mode
that is the SQL workbench or MySQL
workbench and execute the like operator
command if getting your learning started
is half the battle what if you could do
that for free visit scale up by simply
learn click on the link in the
description to know more
now we are on the MySQL workbench and we
have some data or tables and let's
consider the employee name so we have
some text or worker type of data type in
the employee name as well as the
employee Department right let's use that
particular data and here we have the
command and Select Staff from employee
table 2 where we can edit the same
command employee name
like
and remember the single quotes right and
we will be using the percentage
operation here right we can give the
full name so we have Jennifer here right
Jennifer or let's remove Jennifer and if
somebody asks you give me all the names
which start with the G right in that
particular situation we will using the
modulus symbol or percentage symbol
right now what we will get is all the
names that start with the alphabet J and
now let's say we found all the names
that include a certain alphabet let's
say r
right then we can use the modulus symbol
again it can start with anything and it
can end with anything but it should have
alphabet R so this is how it works so we
have all the names which start or
include the alphabet are in them right
and that's how we can use the like
operator in SQL you can also use like
operator in this way where you can get
the entire name let's say somebody asks
you to get one single row which has the
employee name as Peter
right you can also do this in this way
there you go you have Pete that is how
to eliminate duplicate records in SQL
table now we can eliminate the duplicate
records in SQL by a few methods so we
will use the most simplest ones the
first one is using the inner join along
with the work loss and the second one is
a sample and the humble distance command
now we have a brief idea on the methods
let's understand them in a much more
detailed way through a practical
demonstration now let's get back to the
MySQL workbench to understand the codes
in a much better way so now we are on
the MySQL workbench and we will get
access to our simply learn database and
we are in the simply learn database so
previously we used to work on our
employee table so let's not work on the
same employee table since we have actual
data there let's try to duplicate that
table so that we will have some
duplicate entries in between so we will
be changing the employee ID numbers and
we will also be using the same employee
ID numbers so the employee ID has some
details to it so we'll be understanding
that in a much more detail while we are
executing the commands and we will also
try to remove the primary key from the
table so I'll also explain why we are
going to include the primary table and
also we'll explain the usage of
eliminating it so when you have the
primary key in the table SQL workbench
or any SQL will automatically stop you
from adding duplicated value yes but
let's say if you add a duplicate entry
with a new primary key right then it
will not stop you so we'll also have a
demonstration about what to do in such
scenarios so now let's try to quickly
create a duplicate employee table which
will be employed table too and then we
will try to add some duplicate entries
into it remember we will not use the
primary key here if the code will be
create
table
employ
e table
two
and everything will be same which is
from the previous table which will be
the employee ID integer type employee
name character type this character type
pin code will be integer and normally we
include the primary key in this way
primary key brackets open
em
so this is the way how we add the
primary key but we are not going to add
it since we want to know what happens if
we enter data which also has the
duplication of the primary key right so
we will not give any primary key over
here
let's quickly run this
then I got the new duplicated table of
employee table has been created let's
try to insert the same values with some
duplication
there you go I have pasted the command
for inserting the values and if You
observe clearly at the end I have
repeated the values of Tony KT summer
June and Gloria so these five will be
the duplicate values and also we are
trying to enter the duplicated primary
key since we did not declare the ID as
the primary key it will accept all these
values let's quickly run this and there
you go the values have been successfully
entered into the table let's quickly see
if we have the duplication
select star
from
employee table
enter there you go so you can see the
duplicate values are also added onto the
table now how do you remove these
duplications remember we discussed the
distinct one distinct method which is
the second one so that happens to be the
most simplest one let's see how it works
so here we will write a simple select
command
select
distinct
star
from the employee table 2.
now this will give us the distinct
values
right but again when you run this
particular command which is Select star
you will have all the details back again
right our job is to eliminate them so
what we will do is we'll create a
duplicate table
so let's name it as the up table
so create table
duplicatable will be the name now
quickly execute this command
and there you go now we have
the
data
which we obtain from the distant command
is stored into the table named as
duplicate table
now let's quickly drop the employee
table 2.
okay the table has been successfully
dropped
so when we ran the same command once
again it says simply learn DB did not
find any table by the name employee
table 2. that means it's been eliminated
now the next thing we need to do is
rename it
so what we're trying to do is we are
trying to use the alter table and we are
trying to rename duplicate copy to
employee table 2 so that we have the
actual table here after eliminating the
duplicated values it's not to copy it's
actually Duke table
right
there you go
now let's execute this
successfully done now if we execute this
particular select command you can see we
have the cleaned data without any
duplicate entries this was one of the
simplest ways of eliminating duplicates
in a SQL table now let's try to get a
step ahead and try to use some join
commands and
where commands and where conditions and
using those we will try to eliminate the
duplications in a table now we are
talking about a table which does have
the you know primary key
and the datas will be duplicated let me
explain you how now let us that layer
the
primary key as employee ID
in
s e m p ID
right now we do have a primary key
now there is no way okay let's try to
create this before that let's try to
truncate employee table 2
so we can use the
not the drop table we can use the
truncate so let's replace drop with
runki so that the data which we have an
employee table will be removed there you
go now
we will or let's quickly drop the table
because we are trying to create the new
table right so let's create the new
table
so once we have executed the drop table
command the table has been successfully
removed now let's try to create this
particular table
enter there you go 3 will got
successfully created now let's try to
duplicate the same entries remember I'm
not changing the primary key here
now when I run this command I will get
an error which says primary key cannot
be duplicated
so here you can see duplicate entry for
9 and you cannot have the duplicate
entries right this is one way to avoid
duplications but what if someone comes
up with a brilliant idea to replace the
primary key now if I change the primary
key
as
17 18.
let's say we also
have this data copied
let's duplicate
right this will be our 19 and this will
be R20 now we have unique
primary keys for all our data and we
also know there are some duplications
let's try to execute this command and
see the output
so somewhere something is not correct
yet
like this one
so Tony has been repeated so we can have
a different ID for Tony
let's say we have Tony as 21
try to execute the command once again
it should be clear now
okay it still has some duplication
somewhere yes it's right here
let's keep this as 22.
okay I think we made a lot of
duplications somehow
let's quickly take a look if all the
major keywords are duplicated or not
so we copied from Gloria
so after Gloria we
we will remove these
so Gloria so we just make sure we're
trying to make sure that the primary
keys are unique here so 10 11 12 13 14
15 16 17 18 19 20.
20
.
22
there you go so now we believe that all
the primary keys are unique let's try to
run this command and see if we get the
same error or not no so now all the data
has been inserted into the duplicate
table which is employee table 2 and we
also have some duplicate entries now how
would you recognize that we don't have
any duplicates or how would you
recognize which data has been exactly
duplicated and how do you even remove it
now the old distinct command is not
going to work
anyhow let's see if it works by any
chance so when I try to run the distinct
command it will give me all 22 rows with
all the duplicate entries right in this
case we can use the first method which
was the join and where condition method
right let's try to do that so we are
going to use the delete command
delete T1
from employee
table
to
T1
inner join
in a join employee table 2 as T2 so we
are declaring two different tables so we
are
considering T1 as one table and T2 as
the next or second table so T1 and T2
are the copies of the same existing
employee table 2 right now we are
joining these two tables and we are
having a wire condition over here so
from table T1 we're going to eliminate
table 1 from table two where we have an
intersection and where we have the
employee IDs greater than employee ID in
employee
okay let's not confuse so
let's execute the command first okay
let's
execute this to understand what I mean
here so here when we go a little down
you can see
14 for Tony right actual employee ID of
Tony is 9 but we have 14 for Tony and
Gloria we have 18 19 20 and again for
KTV we have 22 the actual number of KT
is
10 right so now it will try to recognize
the highest number of employee ID so it
will recognize the highest employee ID
number and it will retain it and rest
all the numbers will be eliminated so
this is the first where condition and
we're also giving a string comparison
function where SQL will try to identify
if there is a similarity between the
employee name of the first table and the
employee name of the second table and we
know that when you give the string
comparison operation if it results in 0
it means the strings are equal if it
results in 1 it means the strings are
not matching now that we understood the
logic of this particular statement let's
try to execute it
so there you go so we have executed the
command now let's try to see what's left
in the table there you go now we should
be having the usual 13 number of
employees in our table and you can see
that the records are retained where the
employee ID number is the highest
remember we had the number 10 as
employee ID for KD and we have that over
here in case if you want the actual
numbers to be placed however they were
you can make a small change to your
command all you need to do is keep this
particular or change this particular
greater than symbol to lower than symbol
and you will retain the actual numbers
of the employee records so that's how
you can eliminate the
duplicate entries in the table
and if you ask me
hey only two conditions are enough don't
you think the PIN code and you know we
also have PIN code and the address of
the employees don't you think that is
also important yes you can also do that
you can make some minor modifications to
your code and try to include all those
remaining things and again you can do
the same right now let's try to
eliminate the data in our table let's
truncate it and we should be having no
data left in our table and let's try to
insert the duplicate entries once again
and okay before that let's try to do
this particular execution remember we
try to keep the employee ID let's try to
execute that and try to print it and we
should be having the actual numbers over
here right as expected
now let's again truncate the data and
try to compare the conditions or we will
be using the where condition and we'll
have all the parameters included in our
condition let's truncate the table and
let's try to add the duplicate entry so
once again
there you go we have all the duplicate
entries enter now what we will be doing
is we will be using the same command but
the only change will be the string
comparison or the where condition right
so you can keep this string comparison
if you want or if you can change that
let me change that actually
so instead of
this we will use this particular command
where we are trying to compare the
employee ID so let's keep the employee
ID as
lesser than so that we have the actual
employee ID numbers and we are using an
and condition over here so that uh this
particular condition should be valid and
the employee name should be equal to the
employee name in T1 and T2
yeah and the the next one is here we
have the employee address so the
employee address in T1 and T2 should
also be same and pin code from both the
table should also be seen so what we are
trying to compare here is we are trying
to keep the employee ID with the least
number or the least value and the names
of the employee should be same the
address of the employee should be same
and the PIN code of the employee should
be seen in that particular condition you
can try to delete the record let's try
to execute this and there you go the
command got executed and now let's try
to execute the select command which
should give us the final result
so here you go control enter and you
have the data here so now we have
successfully eliminated all the
duplicates by comparing the values in
each and every single column and we also
have reading the original ID of each and
every Android
so what is normalization in dbms
so the normalization theory was first
explained by IBM researcher EF cod in
the 1970s so in a database a large
amount of data is stored in different
tables
there can be the possibility of
redundancy being present in the data so
normalization aims to eliminate this
return density from the data and ensures
data integrity
using normalization techniques you can
split a large table into smaller tables
and Define relationships between them to
enhance the clarity in organizing data
it also removes anomalies like insert
update and delete anomalies in insert
anomaly the values such as null are not
allowed to be inserted in a column
so a record about an entity cannot be
inserted into the table without first
inserting information about another
entity
so for example you cannot enter a
customer without a sales order
now in update anomaly the data cannot be
updated correctly because the same
values occur multiple times in a column
and in delete anomaly the deletion of a
record generates inconsistency as it
gets deleted from more than one row
now to understand how normalization
works it is important to learn about
keys in databases
a key is an attribute or a column that
uniquely distinguishes or identifies a
record in a table
a key could be an individual column or a
combination of multiple columns it is a
very important part of relational
database model in reality multiple
tables are needed for storing the data
and those tables are related to each
other as well
now to retrieve any specific record from
a table you need to apply some
conditions but what if there is
duplicate data present and every time
you try to fetch some data by applying
certain conditions you get the incorrect
result of the data
So to avoid these issues we need keys in
a table
now Keys also help to establish
relationships among the tables so here
you can see we have a student table and
it has columns like the student ID you
have the student rule number you have
the student name the city to which the
student belongs to as well as the
department to which the student belongs
to so in this table
ID column is the primary key you can
also have the roll number as the primary
key because this is the column from
which you can identify individual record
for any of the students and here you can
see Department ID is called the foreign
key just wait for a while we learn about
foreign keys in a while
now let's look at the different types of
keys in a database
so we have primary key foreign key Super
Key and candidate key that we are going
to discuss in this video there are other
Keys as well like the composite key
alternate keys cool
now let's understand what is a primary
key
so primary key is a set of one or more
Fields or Columns of a table that
uniquely identifies a record in a
database table it cannot accept null or
duplicate values
okay so here you can see we have two
tables the first is the student table
and the second one we have is the
department table so in the student table
we have columns such as the student ID
we have the roll number column student
name City and the department ID to which
the student belongs to so in this case
the primary key will be student ID
because you can see all the values are
unique and there are no repetitions
as in there are no duplicate values for
the ID column you can also consider the
roll number as the primary key because
in a college or in a school the roll
number for each student in a class would
be unique so here also you can see the
roll numbers are all unique but you
cannot have student name
City and Department ID as the primary
key because
there can be two students with the same
name similarly
there can be different students
belonging to the same city and there
could be
a lot of students from the same
department so these three columns cannot
be the primary key columns only ID and
rule number can be the primary key
columns similarly for the Department
table the department ID is the primary
key
but moving on
next we have
foreign key
so foreign key is a table in a database
that is the primary key in another table
so here we have the same tables as we
saw in the previous slide so here we
have the student table and the
department table
in the student table the department ID
is the foreign key whereas in the
department table the department ID is
the primary key so this means that the
department ID column in the student
table is referring to the primary key
Department ID column in the department
table
all right so moving ahead we have
Super Key
super key is a set of one or more than
one key that can be used to identify a
record uniquely in a table
so super key can have extra attributes
that are redundant for distinct
identification so here we have the
student table and on the right side you
can see we have the list of super keys
so using these columns you can identify
each record in a table so your idea and
student name can be a Super Key
similarly rule number and student name
can be
Super Key then we have ID student name
and City combinedly forming the Super
Key then you also have the roll number
City and Department ID as the super key
there can be other combinations as well
now moving to learning what is a
candidate key so candidate key is the
minimal super key that can identify a
record uniquely in a table each
candidate can work as a primary key so
we have the same table again here and
these are the list of candidate Keys
just to make sure
these candidate Keys should be also part
of the super key so hence a candidate
key is also known as a minimal Super Key
now with this basic knowledge about the
different keys in a database let's look
at the next topic we have types of
normal forms
so we have the first normal form the
second normal form third normal form and
bcnf for Boyce code normal form that we
are going to discuss in this session
coming to learning what is first normal
form
so a relation is in first normal form if
it does not contain any composite or
multi-valued attribute so each table
cell should contain a single value and
each record needs to be unique that is
an attribute of a table cannot hold
multiple values let's see an example
so here you can see we have a student
table and this table is not in first
normal form because we have multi-valid
attribute student phone number for
student IDE 102 with the student name
Sam so here we can see there are two
phone numbers so this becomes a
multi-valued attribute now the table can
be transformed to the first normal form
like this you can see on the right side
so this contains only Atomic values or
single value in each cell so we have
split
a102 Sam having two different phone
numbers into two different rows
now this table follows the first normal
form because each of the cells have
Atomic values
all right now let's
understand what is the second normal
form in a database
so for a table to be in second normal
form the following two conditions should
be met the first is that the table
should be in first normal form and it
should not have any partial dependency
so records should not depend on anything
other than a table's primary key hence
you need to remove subsets of data that
apply to multiple rows of a table and
place them in Separate Tables let's
understand what is a partial dependency
so if the proper subset of any candidate
key determines the non-prime attributes
it is called partial dependency let's
understand this with an example so here
we have a and
the table has three columns we have the
professor ID
then we have the course name and then we
have the course fee
now the course fee attribute cannot
alone decide the value of Professor ID
or the course name similarly the course
fee together with Professor ID column
cannot decide the value of the course
name
course fee column together with the
course name column cannot decide the
value of Professor ID hence
column here becomes the non-prime
attribute as it does not belong to any
of the candidate keys that is the
professor ID and the course name
but here the course fee column is
dependent on the course name so if you
want to know the course fee of a
particular course you need to know the
course name
course name column here is a proper
subset of the candidate key so the
non-prime attribute which is the course
fee is dependent on a proper subset of
the candidate key now this creates a
partial dependency so this relation is
not in 2nf here you can see we have the
professor ID and course name combinedly
forming the candidate key and course V
is the non-prime attribute now to
convert this table into
second normal form we need to split the
table into
two tables here you can see
we have our original course table and we
have split into two tables that is the
professor course table and the course
fee table so the professor course
table has two columns the professor ID
and the course name similarly for course
we have the course name so these are all
unique courses and the course
fees for the different courses now one
thing to notice here is a lot of the
courses
are being taught by the same professors
for example
professor
ID p01 teaches both physics and
chemistry similarly
professor p03 teaches law and politics
and professor p02 teaches economics and
statistics and there are multiple
professors for each of the courses for
example for economics we have p02 and
p05 for physics we have p01 and p04 as
well
and the course fees for a few of the
courses are the same for example
for physics and chemistry the course fee
is five thousand dollars similarly for
economics and statistics the course fee
are the same so six thousand five
hundred dollars now
the second normal form tries to decrease
the unnecessary data getting stored in
memory for example if there are 10
professors teaching the chemistry course
we don't need to store its fee as 5000
for all the 10 records instead just once
we can store it in another table as the
course fee for chemistry is five
thousand dollars
now let's move on to the
next normal form we have the third
normal form
so a relation is said to be in 3 and F
or third normal form if it is in second
normal form and does not contain any
transitive partial dependency
if 3nf is also used to diminish data
duplication and it is also used to
achieve data integrity
let's understand what is transitive
functional dependency
with an example
so a transitive functional dependency
exists if the column entry is dependent
on any other column apart from the key
column in the table
so here we have an employee table and in
this table we have the employee idst
primary key also the candidate key in
this table is the employee ID and there
are a few functional dependencies for
example the employee name is dependent
on the employee ID similarly the
department name of the employees
dependent on the
employee ID column
we have the employee City depending on
the employee ID column again but the
City ZIP code or the city
pin code is dependent on the
employees city name for example if you
want to know the zip code of a
particular place you need to know the
name of the place or the city
so hence
your employee City ZIP column depends on
the
City column and this leads to a
transitive functional dependency so we
need to break the table into two tables
for transforming it into the third
normal form
now let me show you how you can break it
in the next slide so here you can see we
have the original employee table with
all the columns and now we have broken
our original table into two tables with
the name employee details and City
details so here your employee ID becomes
the primary key and we have the employee
name Department name and the employee
City so each of the other non-prime
attributes are depending only on the
primary key or the candidate key here
which is the employee ID
similarly
in this table we have only one primary
key which is the zip code and then we
have the city for each of the zip codes
all right
so this
tells us that all the non-key columns
are fully functional dependent only on
the primary key column
now
moving ahead to the next normal form
which is the boys codes normal form so
boy Squad normal form or bcnf is a
special case of third normal form a
relation is in bcnf if and only if every
determinant is a candidate key so if for
every functional dependency
X determines y
here x should always be a Super Key only
then the relationship is in BC enough
now let's see an example so here we have
an employee table with the columns
employee ID the country to which the
employee belongs to we have the
different departments we have the
department type and the department
number as well
so here one thing to note you can see
there are
two employees from Japan that is from
the same country but these are two
different employees
now you can see the functional
dependencies that exist so
to know the country of the employee you
need to know the employee
ID so your country is dependent on
employee ID similarly your department
type column is dependent on the
department column department number is
also dependent on the department column
and to know the department you need to
know the employee ID so here your
employee ID and Department columns
together form the candidate key
now to transform the above table to
Boy Scout normal form of bcnf we have to
break it down into
three tables you can see here T1 T2 and
T3
so in the first table we have employee
ID as the candidate key or the super key
and then we have the country so your
country is dependent on the employee ID
similarly in table T2 your department
type column and department number
columns are dependent only on the
department column and in the third table
that is T3 your department is dependent
on the employees ID so here the
candidate keys for tables T1 T2 and T3
are employee ID department and employee
idn Department together
so one thing to note is the
LHS or the left hand side of each
functional dependency should be a
candidate or super key for the table to
be in bcnf
and that brings us to the end of this
video tutorial on normalization in dbms
let me just run through whatever we
learned so first we looked at
the basics of normalization in database
management system and why do we need it
then we learned what is a key in a
database table then we looked at the
different types of keys so we understood
what is the primary key what is a
foreign key then we looked at what is
the super key and we listed down a few
super keys for our student table then we
understood how candidate key is related
to Super Key
and then we moved ahead with our types
of normal forms so we explored the first
normal form so we learned here that all
the values in the table should be Atomic
so we broke
our rows into two different rows for the
table to be in first normal form then we
understood about the partial dependency
in a second normal form and how you can
avoid partial dependency in a table
then we looked at
the third normal form and understood
about the transitive functional
dependency using this employee table
and finally we learned about the boy
Squad normal form with an example
now there are other normal forms as well
such as the fourth normal form and the
fifth normal form but in most of the
cases in reality all the data Integrity
issues and the anomalies such as the
insertion deletion or update anomalies
are resolved in the third normal form or
the bcnf form if you're an aspiring data
engineer looking for online training and
graduating from the best universities or
a professional who Alex to switch
careers with data engineering by
learning from the experts then try
giving a shot to Simply launch data
engineering post-graduate program from
Purdue University in collaboration with
IBM the link in the description box and
the pin comment should take you to the
program being offered first
what is Group by in SQL so the group by
statement or Clause groups records into
summary rows and returns one record for
each group it groups the rows with the
same group by item expressions and
computes aggregate functions for the
resulting group
a group by Clause is a part of Select
expression
in each group no two rows have the same
value for the grouping column or columns
now below you can see the syntax of
group by so first we have the select
statement and Then followed by the
column names that we want to select
from we have the table name
followed by the where condition and next
we have the group by clause and here we
include the column names finally we have
the order by and the column names
now here is an example of the group by
Clause so we want to find the average
salary of employees for each department
so here you can see we have the
employees table it has the employee ID
the employee name the age of the
employee we have the gender the date on
which the employer joined the company
then we have the department to which
each of these employees belong to we
have the city to which the employees
belong to and then we have the salary in
dollars so actually we'll be using this
employee stable on MySQL workbench as
well
so if you were to find the average
salary of employees in each department
so this is how your SQL query with Group
by Clause would look like so we have
selected department and then we are
using an aggregate function that is AVG
which is average and we have chosen the
salary column and here we have given an
alias name which is average underscore
salary which appears in the output you
can see here
from employees and we have grouped it by
department so here in the output you can
see we have the department names and the
average salary of the employees in each
department
now let me take you to my MySQL
workbench where we will Implement group
buy and solve specific problems if
getting your learning started is half
the battle what if you could do that for
free visit scale up by simply learn
click on the link in the description to
know more
okay so I am on my MySQL workbench so
let me make my connection first
I'll enter the password
so this will open MySQL editor
so first of all
let me
check the databases that I have
so I'll use my query that is show
databases
let's run it
okay you can see we have a list of
databases here I am going to use my
SQL underscore into database so I'll
write
use
SQL underscore intro
so this will take us inside this
database I'll run it all right
now you can check the tables that are
present in SQL underscore into database
if I write show tables you can see the
list of tables that are already present
in this database to do a demo and
understand Group by as well as having
let me first create an employee table
so I'll write create table
employees
next
I'll give my column name as employee
underscore ID which is
the ID for each employee
I'll give my data type as integer and
I'll assign
employee ID as my primary key
next I'll give employee underscore name
and my data type would be bar car
I'll
give the size as 25
my third column would be the age column
age would obviously be an integer
then I have
my gender column
I'll use character data type and assign
a value of 1 or size of 1.
next we have the date of join
and the data type will be date
we have the
Department column as well this is going
to be of
and 20 will be the size
next
we have the city column
which is actually the city to which the
employee belongs to
and finally we have the
salary column which will have the
salary for all the employees okay
now let me select and run this
you can see here we have successfully
created our table
now to check
if our table was created or not you can
use the describe command
I'll write describe employees
you can see the structure of the table
so far
all right now it's time for us to insert
a few records into this employee stable
so I'll write insert
into
employees
and I'll
copy paste the records which have
already
written on a notepad so let me show you
so this is my EMP notepad and you can
see I have already
put the information for all the
employees so let me just copy this
and
we'll paste it here
all right let me go to the top and
verify if
all the records are fine
all right
so let's run our insert query
okay so you can see here we have
inserted 20 rows of information
and
now let's check
the table information or the records
that are present in our employees table
I'll write select star from employees if
I run it you can see here
I have my employee ID the employee name
age gender
we have the city salary and in total we
have
instead 20 records
now
let me run a few SQL commands to check
how the structure of our table is
let's say I want to see the distant
cities that are present in our table
so I'll write select distinct City from
employees
if I run this
you see here there are total
eight different cities present in our
employees table so we have Chicago the
Seattle Boston we have New York
Miami and Detroit as well
now let's see
you want to know the
total number of departments that are
present so you can use distinct
Department
if I run this
all right you can see we have seven rows
returned and here are the department
names so we have sales marketing product
Tech I.T finance and HR
all right
now let me show you
another SQL command
now this is to use an aggregate function
so I want to find the average age of all
the employees from the table
so I can write select
AVG which is the aggregate function for
average
inside that I have passed my
each column from employees if I run this
so the average age of all the employees
in our table is 33.35
now
say you want to find the average age of
employees in each department
so for this you need to use the group by
clause
I'll give a comment here I want to find
the
average age
in each department
so
I'll write select
Department
comma
I'll write average of age
from
employees
Group by
Department
now if I run this
you can see here
we have our
seven departments
on the left and on the right you can see
the average age of employees in each of
these departments now you can see here
in the output it says AVG of age which
is not readable so I can give an alias
name as
average age
all right
I can bring this down
and if you want you can round the values
also
so you can round the decimal places so
I'll use a round function before the
average function
and the round function takes two
parameters one is the variable and
the decimal place you want to round it
to
so if I run this there you go you can
see here we have the average each of all
the employees in each of these
departments
all right
now suppose you want to find the total
salary of all the employees for each
department so
you can write select
Department
comma
now I want the total salary so I'll use
the sum function
and I'll
pass my column as salary
from
employees
Group by
Department
let's run this query
you can see here
in the output we have the different
departments and on the right you can see
the total salary of all the employees in
each of these departments now here also
you can give an alias name as
total underscore salary
let's run it again
and you can see the output here
all right now moving ahead
you can also use the order by Clause
along with the group by Clause let's see
you want to find the total number of
employees in each City and group it in
the order of employee ID so
to do this I can use my select query
I'll right select
count of let's say employee ID
and I want to know the city as well
from
employees
Group by
City
and next you can use the order by clause
I'll write order by
count of
employee ID
and I'll write desc which stands for
descending
if I run this query
you can see here on the left you have
the account of employees and on the
right you can see the
city names so in Chicago we had the
highest number of employees working that
was four then we had Seattle Houston
Boston Austin
and the remaining also had two employees
so in this case we have ordered our
result based on the count of employee ID
in descending order so we have the
highest number appearing at the top and
then followed by the lowest okay
now let's explore another example
suppose we want to find the number of
employees that joined the company each
year we can use the year function on the
date of joining column then we can count
the employee IDs and group the result by
each year
so let me show you how to do it
so I'll write select
I am going to extract here from
the date of join column
I'll give an alias as year
next
I'll
count the
employee ID
from my table name that is employees
and
I am going to group it by
year
date of join
if I give a semicolon
all right
so let's run this
grid you see here in the result we have
the year that we have extracted from the
data join column and on the right you
can see the
total number of employees that joined
the company each year so we have in 2005
there was one employee similarly we have
in 2009 there were two employees
if I scroll down you have information of
other years as well
now if you want you can order this as
well based on year or count
okay
now you can also use the group by to
join two or more tables together
so to show you this operation let me
first create a sales table
so I'll write create
table
sales
and the sales table will have columns
such as the product ID which is going to
be of integer type then we have the
selling price of the product
now this will be a a float value
then we have the quantity sold for each
of the
products so I'll write
quantity
quantity will of integer type
next we have the state in which the item
was sold
and state I'll put it as worker and give
the sizes 20.
let's run this so that we'll create our
sales table all right
so we have successfully created our
sales table
next we need to insert a few values to
our sales table so I've already written
the records in a notepad let me show you
okay so here you can see I have my sales
text file let me just copy these
information
I'll just paste it on
the query editor
okay
now let me go ahead and
run this
insert command all right so you can see
here we have successfully inserted nine
rows of information so let me just run
it through what we have inserted
so the first
column is the product ID column then we
have the selling price at which this
product was sold then we have the
quantity that was sold and in which
state it was sold so we have California
Texas Alaska
then we have
another product ID which is one two
three
and these are the states in which the
products are sold
so let me just
confirm with the
select statement I'll write select star
from
sales
if I run this you can see we have
successfully created our table
okay
now suppose you want to find the revenue
for both the product IDs one to one and
let's say one two three since we have
just two product IDs here
so for that you can use the select query
so I'll write select
product ID
next I want to calculate the revenue so
revenue is nothing but selling price
multiplied by the quantity so I'll use
the sum function to find the total
revenue
and inside the sum function I'll use my
selling price column
multiplied by
quantity column
I'll give this
an alias name as Revenue
from
my table name that is sales
finally I'll group it by
product ID
let's run it
there you go so here you can see we have
the two product IDs one two one and one
two three and here you can see the
revenue that was generated from these
two products
all right
now let's see
we have to find the total profit that
was made from both the products one to
one and one to three so for that I'll
create another table now this table will
have the cost price of
both the products so let me create the
table first
I'll write create table
let's say the table name is C product
which stands for the cost price of the
products
I'll
Give My First Column as product ID
this will be an integer
and I'll have my second column as cost
price
cost price will have floating type
values
let's run this so we have successfully
created our product cost table
now let me insert a few values into the
C product table so I'll write insert
into
C underscore
product
I'll give
my values
for one to one
let's see the
cost price was 200 and 70 dollars
for each
and next we have my product is one two
three and let's say the cost price for
product one two three was
250 dollars
let's insert these two values okay next
we'll join our sales table and the
product cost table so this will give us
the profit that was generated for each
of the products
so I'll write select
C Dot
product underscore ID
comma
I'll write sum
s dot cell underscore price now here C
and S are Alias names
so if I subtract my
cost price from the selling price that
will return the profit that was
generated
I'll multiply this with s dot
quantity
close the bracket
I'll give an alias name as
profit
from
seals as s
so here s stands for the sales table
I'm going to use inner join
C underscore
product table
as
the Alias name should be C
where
s dot
product underscore ID is equal to C Dot
product underscore ID we are using
product underscore ID because
this column is the common column to both
the tables
and finally
I am going to
group it by
C dot product underscore ID
all right
so let me tell you what I have done here
so I am selecting the product ID
next I am calculating the profit by
subtracting the cost price from the
selling price and I have multiplied the
quantity column
I'm using an inner join to connect my
sales and the
product cost table
and I am joining on the column that is
product ID and I have grouped it by C
dot product ID let's run this there you
go so here you can see for product ID
one to one we made a profit of
eleven hundred dollars and for product
ID one two three we made a profit of
eight hundred and forty dollars so now
that we have learned Group by in detail
let's learn about the having clause in
SQL the having clause in SQL operates on
grouped records and returns rows where
aggregate function results matched with
given conditions only
so now having and where Clause are kind
of similar but where Clause can't be
used with an aggregate function
so here you can see the syntax of having
Clause you have the select statement
followed by the column names from the
table name then we have the WHERE
conditions next we have the group by
finally we have having and at last we
have order by column names so you can
see here we have a question at hand
we want to find the cities where there
are more than two employees
so you can see the employee table that
we had used in our
Group by Clause as well so if you were
to find the cities where there are more
than two employees so this is how your
SQL queries should look like so we have
selected
the employee ID and we are finding out
the count using the count function
next we have selected the city column
from employees we have grouped it by
City And then we have user having clause
so we have given our condition having
count of employee ID should be greater
than 2. so if you see the output we have
the different city names and these were
the cities where the
count of employees was greater than 2.
all right so let's go to our MySQL
workbench and Implement how
having box so suppose
you want to find those departments where
the average salary is greater than 75
000 you can use the having clause for
this so let me first run my table which
is employees
if I run this you can see we had
inserted 20 rows of information and
the last column we had was salary so the
question we have is we want to find
those departments where the average
salary is greater than 75 000 dollars
so let me show you how to do it
so I'll write
select
Department comma
I'll use the aggregate function that is
average
salary
I'll give an alias name as
AVG
underscore salary
from
employees
next we'll use the
Group by clause and I want to group it
by each department
and then I am going to write my having
Clause so in having Clause I'll use my
condition that is having
average of salary
greater than
75 000 dollars
let's run it
and see the output there you go so here
you can see there were total three
departments in the company that is sales
finance and HR where the average salary
is greater than 75 000 dollars
okay
next let's say you want to find the
cities where the total salary is greater
than two hundred thousand dollars
so this will again be a simple
SQL query so I'll write select City
comma
I want to find the total salary so I'll
use the sum function
and I'll pass my column as salary as
I'll give a
Alias name as total from
employees
Group by
City
and then I am going to use my having
clause
I'll pass in my condition as having
sum of salary
greater than
two hundred thousand dollars
all right
so let's run this query there you go
so
so the different cities are Chicago
Seattle and Houston where the total
salary was greater than 200 000 now
suppose you want to find the Departments
that have more than two employees so
let's see how to do it
I'll write select
Department comma this time since I want
to find the number of employees I am
going to use the count function I'll
write count Star as
employee underscore count or EMP
underscore count which is my Alias name
from
employees
next I'll group it by
Department
having
my condition
count star greater than 2.
let's run this
okay
so you have departments such as sales
product Tech and ID where
there are more than two employees
okay now you can also use a where Clause
along with the having clause in an SQL
statement
so suppose I want to find the cities
that have more than two employees apart
from Houston
so
I can write my query as select
City comma
count star
as
EMP count
from
employees
where
I'll give my condition shitty
not equal to
Houston I'll put it in double quotes
since I don't want to see
the information regarding Houston
I'll group it by
City
having
count
of employees greater than 2.
so if I run this query
you see we have information for Chicago
and Seattle only
and we have excluded the information for
Houston
now you may also use aggregate functions
in the having Clause that does not
appear in the select clause
so if I want to find the total number of
employees for each department that have
an average salary greater than 75 000 I
can write it something like this
so select
Department
comma
count
star
as
EMP count
from
employees
Group by
Department
and in the having clause
I am going to provide the column name
that is not present in the select
expression so I'll write having
average salary
greater than 75 000.
this is another way to use the having
Clause let's run this
all right you can see we have department
sales finance and HR and you can see the
employee count where the average salary
was greater than 75 000.
okay
so let me run you from the beginning
what we did in our demo so first we
created a table called employee then we
inserted 20 records to this table
next we explored a few SQL commands like
distinct then we used average and
finally we started with our
Group by clause
followed by
looking at how group I can be used along
with another table and we joined two
tables that was sales and product cost
table to find out the profit
then you learned how to use the having
clause
so we explored several different
questions and learned how to use
having an SQL
SQL join statement or command is often
used to fetch data present in multiple
tables SQL joints are used to combine
rows of data from two or more tables
based on a common field or column
between them now consider this example
where we have two tables an order stable
and a customer stable
now the order table has information
about the order ID which is unique here
we have the order date
that is when the order was placed then
we have the shipped date this has
information about the date on which the
order was shipped then we have the
product name which basically is the
names of different products we have the
status of delivery whether the product
was delivered or not or whether it was
canceled then we have the quantity which
means the number of products that were
ordered and finally we have the price of
each product
similarly
we have another table called customers
and this customer table has information
about the order ID
which is the foreign key here
then we have the customer ID which is
the primary key for this table we also
have the phone number customer name and
address of the customers
now suppose you want to find the phone
numbers of customers who have ordered a
laptop
now to solve this problem
we need to join both the tables the
reason being the phone numbers are
present in the customers table as you
can see here
and laptop which is the product name is
present in the order stable which you
can see it here so using a join
statement you can find the phone numbers
of customers who have ordered a laptop
now let's see another problem where you
need to find the customer names who have
ordered a product in the last 30 days in
this case we want the customer name
present in the customers table and the
last 30 days order information which you
can get from the order date column that
is present in the order stable
okay now let's discuss the different
types of joints one by one so first we
have an inner join
so the SQL inner join statement returns
all the rows from multiple tables as
long as the conditions are met
from the diagram above you can see that
there are two tables A and B A is the
left table and B is the right table
the orange portion represents the output
of an inner join
which means an inner join Returns the
common records from both the tables
now you can see the syntax here so we
have the select command and then
we give the list of columns from table a
which you can see here is the left table
followed by the inner join keyword and
then the name of the table
that is B on a common key column from
both the tables A and B now let me take
you to the MySQL workbench and show you
how inner join Works in reality
so here I'll type MySQL
you can see I have got my SQL workbench
8.0 version installed I'll click on it
so take some time to open
okay
I'll click on this local instance
and here I'll give my password
okay
so this is how an SQL editor on MySQL
workbench looks like
so first of all
let me go ahead and create a new
database
so I'll write create
database this is going to be my command
followed by the name of the database
that is going to be SQL underscore joins
if I give a semicolon and hit Ctrl enter
this will create a new database you can
see here one row affected
now
you can check whether the database was
created or not using show databases
command
if I run it
here you can see I have
SQL joints database
created
now I'll use this database so I'll write
use SQL underscore joins
okay now to understand inner join
consider that there is a college
and in every College you have different
teams for different sports such as
Cricket football basketball and others
so let's create two tables cricket and
football
so I'll write
create
table
and my table name is going to be cricket
next
I'm going to create two columns
in this table the First Column is going
to be cricket
ID
then
I'm going to give the data type as int
and use the auto increment operator
I'm using Auto increment because my
Cricut ID is going to be my primary key
then I am going to give
the name of the students who are part of
the cricket team
and for this I'll use war card data type
and give the length as 30.
I'll give another comma and
I'll assign my Cricut ID as primary key
within brackets I'll give
ID
Cricket ID is nothing but a unique
identifier for each of the players like
you have roll numbers in college
okay
let me just run it
all right so we have successfully
created our cricket table
similarly let me just copy this and I'll
paste it here
I'll create
another table called football
this will have the information of all
the students who are part of the
football team
and instead of cricket I am going to
give this as football ID
all right
and
the name column will have the names of
the students I'll change my primary key
to football ID
all right let me run this okay
so now we have also created our
football table
the next step is to insert a few player
names into both the tables
so I'll write my insert into command
first let's load some data to our Cricut
table
so I'll write cricket and
I'll give my
name column
followed by
values and here I'll give some names
such as
it says Stuart
we have another comma
the next player I'll choose is let's say
Michael
similarly I'll add a few more let's say
we have
Johnson
the fourth player I'll take his let's
say hidden
and finally we have
let's say Fleming
okay
now I'll give a semicolon and run this
okay so let me just check if all the
values were inserted properly for this
I'll use
select star from table that is Cricket
if I run it you can see I have created a
table and have successfully inserted
five rows of information
now similarly
let's insert
a few student names
for our football table
so I'll change this to
football
and obviously there would be students
who will be part of both cricket and
football team so
I'll keep a few
repeated names let's say Stuart
Johnson and let's say hidden our part of
both cricket and football team
then we have let's say
Langer and
let's say we have another player in the
football team that is Aston
I'll just run it okay you can see there
are no errors so we have successfully
inserted values to our football team as
well
let me just recheck it
I'll write select star from
football
all right so we have five players in the
football team as well okay
now the question is
suppose you want to find the students
that are part of both the cricket and
football team in this case you can use
an inner join
so let me show you how to do it
so I'll write select star from
cricket
as I'm using an alias name as C which
stands for Cricket
then I am going to write inner join
my next table is going to be football
as F which is an alias name for the
football table
then I am going to use the on
command or operator
and then
I'll give the common
key that is name here so C dot name is
equal to F dot name
So based on this name column from both
the table my inner join operation will
be performed so let's just run it
there you go so Stuart Johnson and
Hayden are the only three students who
are part of both the teams
all right
now you can also individually select
each of the columns from both the tables
so let's say I write select C Dot
Cricut underscore ID comma
C dot name
comma F Dot
football underscore ID
comma F dot name
from
I'll write
Cricket as C
inner join
football as f
on
C dot name
is equal to F dot name
now if I run this you see we get the
same output here as well
all right
now let's explore another example to
learn more about inner joins so we have
a database called classic models let me
first
use classic models
I'll run this okay now let me just show
the different tables that are part of
classic tables
all right
so here you can see there are tables
like customers there's employees office
there's office details orders payments
products and product lines as well
all right
so
let me use
my select statement to show
what are the columns present in the
products table
okay so this product table has
information about different
product names you have the product code
now this product code is unique here
we also have the product vendor
a little description about the product
then we have the quantity in stock
buying price and MSRP
let's see what we have in
product lines
if I run it you see here we have the
product line which is the
primary key for this table then we have
the textual description for each of the
products this is basically some sort of
an advertisement
all right now suppose
you want to find the product code the
product name and the text description
for each of the products you can join
the products and product lines table
so let me show you how to do it
I'll write my select statement and
choose my columns as product code then
we have
product name
and let's say I want the text
description so I'll write this column
name
okay
then I'll use from
my first table that is
products
inner join
product lines
I can use using
the common key column that is product
line
close the bracket I'll give a semicolon
and if I run it there you go so you can
see the different product codes then we
have the different product names and the
textual description for each of the
products so this we did by joining the
products table and the product lines
table
all right
now suppose you want to find the revenue
generated from each product order and
the status of the product to do this
task we need to join three tables that
is orders order details and products so
first let me show you
what are the columns we have in these
three tables we have obviously seen for
the products table now let me show you
for orders and Order details table
so I'll write select star from
orders
if I run it you can see it has
information about the order number
the date on which the order was placed
we also have the shipment date we also
have the status column which has
information regarding whether the order
was shipped or canceled
then we have some comments column we
also have the customer number who
ordered this particular product
similarly let's check what we have under
order details
so I'll write select star from
order details if I run it
you can see it has the order number the
product code quantity of each product we
have the price of each product then we
have the order line number okay
so using the product
orders and Order details let's perform
an inner join
so I'll write select
O DOT
order number
comma
O DOT
status
comma
I need the product name which I'll take
from the products table so I'll write P
Dot
product name now here o p are all
Alias name for the tables orders
products and I'll use OD for order
details
comma
since we want to find the revenue
we actually need to
find the product of quantity ordered
into
price of each product so I'll use a sum
function and inside the sum function
I'll give
quantity
ordered
multiplied by
the price of each item
I'll use an alias as Revenue
then I'll use my from clause
from orders as o
inner join
order
details as I'll use an alias name as OD
on
I'll write
O DOT
order number
is equal to
OD Dot
order number
I'll use another inner join
and this time we'll join the products
table so I'll write inner join products
as
p on
P Dot
product code
is equal to
OD Dot
product code
and finally I'll use the group by clause
and group it by order number
all right
let me run this
okay there's some mistake here we need
to debug this
it says
you have an error in your SQL syntax
check the manual all right okay I think
the name of the tables is actually
orders or not order
all right now let's run it
okay there's still some error
it says
classic models dot product doesn't exist
so again the product name is
I mean the table name is products and
not product so let's run it again all
right there you go so we have the order
number the status
the product name and the revenue
this we got it using
inner join from three different tables
if getting your learning started is half
the battle what if you could do that for
free visit scale up by simply learn
click on the link in the description to
know more
now talking about left joins
the SQL left join statement returns all
the rows from the left table and the
matching rows from the right table so if
you see this diagram you can see we have
all the rows from the left table that is
a and only the matching rows from the
right table that is B so you can see
this
overlapped region
and the syntax
for SQL left join is something like this
so you have the select statement and
then you give the list of columns from
table a which is your left table then
you use the left join keyword
followed by the next table that is table
B on the common key column so you write
a DOT key is equal to B dot key
okay now in our classic models database
we have two tables customers and orders
so if you want to find the customer name
and their order ID you can use these two
tables so first let me show you the
columns that are present in
customers and orders
I think orders we have already seen let
me first show you
what's there in the customers table okay
so you can see we have the customer
number
the name of the customer then we have
the contact last name the contact first
name we have the phone number then
there's an address column there are two
address columns actually
we have the city name the state
and we have other
information as well and similarly we
have our orders table so I'll write
select start form
orders so I'll write select star from
orders
if I run this you can see these are the
information available in the
orders table
okay so let's perform a left join
where we want to find the customer name
and their order IDs so I'll write select
C Dot
customer name
or let's say first we'll choose the
customer number comma
then I want the customer name so I'll
write C Dot customer name
then we have the
order number column which is present in
the orders table and let's say I also
want to see the status
then I'll give my left table that is
customers
as C
left join
orders as o
on
C Dot
customer number equal to
O DOT customer number
let's run it
okay again there is some problem
all right so the table name is customers
let's run it
so there's another mistake here this is
customer number so B is missing cool let
me run it all right so here you can see
we have the information regarding the
customer number
then
the respective customer names we have
the order number and the
status of the shipment so if I scroll
down you'll notice one thing there are a
few rows you can see which have null
values this means for customer number
125 and for this particular customer
name there were no orders
and similarly if I scroll down you will
find a few more null values
you can see here there are two null
values here for
customer number 168 and 169 there were
no orders available
all right now to check those customers
who haven't placed any orders
you can use the null operator so what
I'll do is here I'll just continue with
this I'll use a where clause and write
where
order
number is null
now let me run this
okay so here you can see there are
24 customers from the table
that don't have any orders in their
names
okay now talking about right joins so
SQL right join statement returns all the
rows from the right table and only
matching rows from the left table so
here you can see we have our left table
as a and the right table as B so the
right join will return all the rows from
the right table and only the matching
rows from the left table
now talking about the syntax so here you
can see we have the select statement
followed by the select statement you
will have the list of columns that you
want to choose
from table a right join table B on the
common key column from both the tables
all right
now to show how right join works I'll be
using two tables that is customers and
employees so let's see
the rows of data that are present in the
customer table first so I'll write
select star from
customers
let's run it so here you have the
customer number the customer name
then we have the phone number the
address of the customers
you also have the country to which the
customer belongs to the postal code
and the credit limit as well similarly
let's see for
the employees table
here I'll change customers to employees
let's run it okay so we have the
employee number the last name the first
name we have the extension the email ID
the job title and also
reports to here means the manager
okay
So based on these two tables we'll find
the customer name the phone number of
the customer and the email address of
the employee and join both the tables
that is customers and employees
so let me show you the command so I'll
write select
C Dot
customer name comma
then we have C Dot phone I'll give a
space here
next I want
the employee number from the employee
table so I'll write e Dot
employee number comma
e dot email from customers as C
right join
employees
as e
on
e dot my common key column is employee
number here so I'll write e Dot employee
number is equal to
C Dot we have
sales
Representatives
employee number
and I'm also going to order it by
the employee number column
okay
so you can see I have my customer name
selected from the customers table the
phone number of the customer then we
have the employee number and the email
address so let me run it
okay there's some problem
all right so the table name is customers
actually
let's run it once again
there you go so you can see here
we have
all the values selected from our right
table which is the employees table you
can see right Zone employees which means
your employee stable is to the right
and then we have the customer name and
phone numbers of
the customers from the customer table
which is actually your left table so you
have a few
employee numbers such as one zero zero
two this one zero five six we don't have
any customer name or phone numbers
okay so there's another popular join
which is very widely used in SQL known
as self joins so self joins are used to
join a table to itself
so in our database we have a table
called employees let me show you the
table first
all right
so here you can see we have the employee
number the last name the first name of
the employee we have the email ID
and here if you see we have a column
called reports two now this you can
think of as the manager column so the
way to read is for example
for employee number 1056
the manager is one zero zero two so if
you check for one zero zero two we have
Dane Murphy
then if I scroll down
let's say for employee number
one one zero two
yeah for employee number 1102 the
manager is one zero five six so here you
can see who is at one zero five six you
have
Mary Patterson
similarly if I scroll down let's see
for employee number 1188
we have
the manager as one one
four three now if I check the table at
one one four three we have Anthony bow
so
so the employee Julie farrelli reports
to Anthony bow
all right
now suppose you want to know who is the
reporting manager for each employee so
for that you can use a self join so let
me show you how to join this employees
table
I'll write select
and then I am going to use a function
called concat
within brackets I'll start with my Alias
name that is m dot
then I'll write last name
I am going to concat last name
followed by a comma
then I'll have my first name
I'll close this bracket
and then I'm going to give my
Alias name let's say manager
comma next I am going to concat
the same
last name and first name and this time
I'm going to use a separate Alias let's
say e which stands for employee so I'll
write e dot last name comma and within
single quotes
I'll
give my comma and then I'll write e DOT
first name
I close this bracket I'll give an alias
as let's say
employee
from
I'll write
employees
as e
inner join
employees
as m
on
m dot
I'll use my common key column as
employee number so I'll write
m dot
employee number is equal to
e dot here I am going to use the reports
to column
and then
I'll
order it by
let's say manager
okay
now let's run this
there you go so you have your two
columns as manager and employee so for
employee Louis bonder
the manager is zeradbander similarly if
I scroll down
you have there are multiple employees
reporting to this particular manager
similarly we have our manager as
anthonybo and we have
different employees who are reporting to
this particular manager and so on
all right now moving ahead
now let's see what a full join is
so SQL full outer join statement returns
all the rows when there is a match in
either left or right table now you must
remember that MySQL workbench does not
support full outer join by default but
there's a way to do it so by default
this is how the syntax of full outer
join looks like
now this statement will work on other
SQL databases like Microsoft SQL server
but it won't work on MySQL workbench
I'll show you the right way of using
full auto join on MySQL workbench
so to so full outer join I am going to
first use a left join and then we'll
also use a right join and finally we'll
use a union operator so the union
operator is used to combine the result
set of two or more select statements
so first of all let me write
C Dot
customer name so for this example I'm
using the customer table and the order
table
comma O DOT
order number
so I just want to know the customer name
and the order number related to the
customer
from
I have
customers
as
C
left join
I'll write
orders as o
on
C Dot
customer number
is equal to
O DOT
customer number
let me just copy this
and after this I am going to use my
union operator
so Union operator is used to merge
results from
two or more
tables
so basically this performs a vertical
join
and next I am going to use my right join
operation so here instead of left join
I'll write write
restore looks fine let me just run it
there you go so we have successfully run
our full outer join operation you can
see we have the different customer names
and the order that each customer had
placed
all right
so that brings us to the end of our demo
session so let me just run through
whatever we did in this session so first
we created a database called SQL joints
then we created two tables like cricket
and football
then we had
inserted a few
rows to each of these tables then we
used this table to learn about inner
join
next
we used a database called classic models
it had multiple tables so we explored
all of these tables like products there
was product lines orders customers and
employees and learned how to use inner
join left join self join right join as
well as full outer join if you're an
aspiring data engineer looking for
online training and graduating from the
best universities or a professional who
Alex to switch careers with data
engineering by learning from the experts
and try giving a shot to Simply learns
data engineering postgraduate program
from Purdue University in collaboration
with IBM the link in the description box
and the print comment should take you to
the program being offered so what is SQL
join in relational databases the
information you want to retrieve is
often stored in various different tables
in such scenarios you'll need to join
these tables to view data in a much
better way this is where SQL join comes
into picture SQL joints is widely used
clause in s in SQL essentially to
combine and retrieve data from two or
more tables
based on related columns or you can say
common fields between them now consider
two tables here table one has three
columns ABC and three records let's say
for reference we'll take them as one two
three similarly table two also has three
columns BCD and three records three four
five here I have taken a different color
combination to represent values that are
present in various columns now instead
of querying each table every time to
retrieve data I'll simply join these two
tables and this will be the following
resultant table also make sure when you
are joining two tables it should
compulsarily have a common column here C
is the common field which forms the
basis to join these two tables here
why we use SQL join flexibility SQL join
allows the user to access and manage
records from more than one table easily
let us understand with an example
consider Mercedes-Benz which is one of
the leading car manufacturers in the
world and let's say they want to access
the records of their customers from the
database now in the database let us take
they have various different kinds of
tables such as customer table order
table vehicle table now if they want to
get the vehicle details of so and so
customer XYZ for that they have to first
query the customer table to get the
customer ID now if once if they get the
customer ID they have to query the order
table to get the order ID and finally
with the help of order ID they can get
the vehicle details now as you can see
this is a time taking process and hectic
at the same time now instead of that
I'll just simply join these tables which
will allow the users to combine rows
from two or more tables based on
different types of conditions in this
way you can access and manage your
records easily
data redundancy SQL join allows the user
to maintain data residency as much as
low as possible so that we can maintain
the amount of data anomalies that is the
duplicate values that are repeated in
various tables in the database
finally efficiency SQL join executes the
query faster and shows the result much
more quickly because instead of using
various sub queries for each and every
table individually we can just simply
join uh two tables using us a simple
single query
types of SQL joints SQL joints are
broadly classified into four types they
are inner join outer join left join
right join and additionally we also have
cross joint which is not that
significant uh in its usage because most
of the times we use the first four
joints now that we have gone through
different types of SQL joints let us
discuss each of them in detail
firstly let us discuss about SQL inner
joint SQL inner join joins two tables
based on a common column and selects
records that have matching values in
these columns now when the condition uh
is applied for these columns the query
checks all the rows of table 1 and table
2. only the rows that satisfy the join
predicate are included in the resultant
table let us now understand the uh
syntax of the SQL inner joint the syntax
is followed as select table one dot
column one table one dot column two
table2 dot column one and so on from
table 1 in a join table 2 on table one
dot column equals to table 2 dot column
now inner join syntax basically Compares
rows of table one with table two to
check if any anything matches based on
the condition provided in the on clause
and when the condition is met it returns
matched rows in both tables with the
selected columns in the select clause
okay
let us now discuss about the SQL outer
join SQL outer join or else it is called
as SQL full join or full outer join is
used to get all the rows which are
present in both the tables that means it
will return all the records which are
present in either left table that is the
table one or the right table that is
table two even if there are no matching
records present in both the tables let
us now understand the syntax the syntax
remains same that is Select table one
dot column one table one dot column two
and so on up to table 2 dot column 2
from table 1 full outer join is the
keyword that we use here table two on
table1.com column equals to table two
dot column now here you have to mention
the uh the same or the similar column
name in the uh after the on predicate
statement
next we have SQL left join
left join or left outer join also known
as left join results in a table
containing all the rows from the table
on the left side of the joint that is
the first table and only the rows that
satisfy the joint condition from the
table on the right side of the joint
that is the second table any missing
values uh for the rows from the right
table in the result of the joint tables
are represented by null values let's
look at the syntax the syntax is
followed as select column list that is
the column that you want to display in
your table now make sure you maintain
the uh
a syntax of the column list that is the
table name dot column name otherwise it
will throw an error so let me just
repeat the syntax the syntax is Select
column list from table one the keyword
that we use here is left join table 2 on
table one dot column equals to table2
dot column so in this way you can use
the left join to display the records
next finally we have the uh SQL right
join now right join or right outer join
is uh opposite to that of the left outer
join now it follows the same rules as
the left join and the only difference is
that all the rows from the right table
and only the conditions satisfying the
rows from the left table are present in
the resultant table that means it will
return all the rows from the right table
and all the matching records that are
present in the left table the syntax
Remains the Same that is Select column
list that you want to display in your
table from table one right join is the
keyword we use table 2 on table one dot
column equals to table 2 dot column
okay
now to sum up all these different SQL
joints and how they work I've taken a
graphical representation of two
different tables here which will help us
visualize the real-time working of SQL
joints now consider table one here which
is columns A and B and Records uh two
different records let's say record zero
record one and similarly we have table
two which have uh columns A and C and
two records that is record zero and
record two now if you apply left join
and by the definition of left join it
will only return those values which will
which are present in the left table and
the matching records that are present in
the right table now here the uh matching
value that are present in both the
tables is 0 and they require values that
are present in the left table is one and
if you consider the right join it will
match the request from both the tables
and it will display the only you know
values from the right table
that is the reason it is being displayed
uh the record 0 and the record two and
if you look at the inner join it'll
match
uh the values from both the tables now
the common value that is present in both
the tables is record zero and if you
finally look at the outer join it will
record it will return all the values
from both the tables irrespective if
they are matching or not that is the
reason uh all the records that is
required zero record one and record two
are being displayed so let's start with
what is a sub query
so a sub query is a select query that is
enclosed inside another query
so if I show you
this is how the basic structure of a sub
query looks like so here
whatever is present inside the brackets
is called as the inner query and
whatever is present outside is called
the outer query so first the inner query
gets executed and the result is returned
to the outer query and then the auto
query operation is performed
all right now let's see an example so we
have a question at hand which is to
write a SQL query to display Department
with maximum salary from employee stable
so this is how our employee stable looks
like it has the employee ID the employee
name age gender we have the date of
joint Department City and salary
now to solve this query
my sub query would look like this
so I'll first select the department from
my table that is employees where
I'll use the Condition salary equal to
and then I'll pass in my inner query
which is Select Max of salary from
employees so what this does is it will
first return the maximum salary of the
employees in the table
then a router query will get executed
based on the salary return from the
inner query
so here the output is
department sales has the maximum salary
so one of the employees from the sales
department earns the highest or the
maximum salary if you see in our table
the employee is Joseph who owns hundred
and fifteen thousand dollars all right
and Joseph is from the sales department
now let's see how this query works so
here we have another question which is
to find the name of the employee with
maximum salary in the employees table so
this is our previous employees table
that we saw and to find the employee who
has the maximum salary
my sub query would look something like
this so I'm selecting the employee name
from my table that is employees where I
am using the Condition salary equal to
and then I'm passing in my sub query or
the inner query so first I am selecting
the maximum salary
this will return a particular value that
is the highest salary from the table and
if you see our table the highest salary
is hundred and fifteen thousand dollars
so our query becomes select employee
name from employees with salary equal to
115 000 so the employee name is Joseph
here and
that's the output now if you want to
break it down
here you can see first the inner query
gets executed
so our SQL query will first execute the
inner query that is present inside
brackets select maximum salary from
employees the result is hundred and
fifteen thousand dollars and then based
on the returned result our outer query
gets executed so the query becomes
select employee name from employees
where salary equal to hundred and
fifteen thousand dollars and that
employees Joseph
all right
now we'll learn the different types of
sub queries so you can write sub queries
using select statement update statement
delete and insert statement we'll
explore each of this with the help of
example on my MySQL workbench
so let's learn some queries with the
select statement
so sub queries are majorly used with the
select statement and this is how the
syntax looks like you select the column
name from the table name then you have
the
where condition followed by The Columns
that you want to pass the operator and
inside that
you have this sub query so here is an
example that we will perform on our
MySQL workbench so in this example we
want to select all the employees who
have a salary less than average salary
for all the employees
this is the output so let's do this on
my MySQL workbench
all right so let me log into my local
instance
I'll give my password
okay so you can see I'm on my MySQL
workbench so let's start by
writing a sub query using the
select statement
okay so for this demo session we'll be
using a database that is sub queries you
can see it here I have a database called
sub queries
so I'll
use this
sub queries database
and we'll create a few tables as well
okay
if I run it
now we are inside the sub queries
database
so
let me just show you the tables that are
present inside this database I'll write
show tables
if I run it
okay there are two tables employees and
employees underscore B uh we'll use this
table throughout our demo session
all right
now for our select sub query we want to
fetch the employee name the department
and the salary
whose salary is less than the average
salary so we will be using the employees
table so let me first show you
the records and the columns we have in
the employees table
so I'll write select start from
employees and run it okay you can see
here we have 20 rows of information
we have the employee name the employee
ID age gender date of joint Department
City and salary so this is the same
table that we saw in our slides
okay
now for our sub query I'll write select
I want to choose the employee name
the department
and the salary
there should be a comma here instead of
a period
next I'll give my table name that is
employees
where
my salary is less than and after this
I'll start my inner query or the sub
query I'll write select
average salary so I'm using the AVG
function to find the average salary of
all the
employees
from my table that is employees
if I give a semicolon
and run this
you'll see the output
so we have total 12 employees in the
table whose salary is less than the
average salary now if you want you can
check the average salary
so the average salary is 75 350 dollars
now the employees who have a salary less
than the average salary
so these are the people
all right
now moving back to our slides
okay
now let's see how you can use sub
queries with the insert statement
now the insert statement uses the data
returned from the sub query to insert
into another table
so this is how the syntax looks like so
you write insert into table name
followed by select individual column so
start from the table use the where
clause and then you give the operator
followed by the inner query or the sub
query
so here
we will explore a table called products
table
we are going to fetch few records from
the products table based on a condition
that is the selling price of the product
should be greater than 100 so only those
records will fetch and put it in our
order stable all right
so we are going to write this query on
my my SQL workbench so let's do it
I'll give my
comment as
update sub query
all right
so first of all let's create a table
that is
products so I'll write create table
products
then we'll give our column names the
First Column would be the product ID of
type integer
then we have the column as item or the
product
which is of type worker 30
next we have the
selling price of that product the
selling price will be of type float
and finally we have another
column which is called the product type
and again product type is of
the data type worker I'll give the size
as 30.
close the bracket and give a semicolon
now let's just run it
okay so we have successfully created our
products table
now let's insert a few records to our
products table
so I'll write insert into
products
followed by values
I'll give
four records the first product ID is one
zero one
the product is
let's say jewelry
then the selling price is let's say
eight hundred dollars and the product
type is it's a luxury product
next let's insert one more
product detail the product ID is one
zero two
the product
is let's say t-shirt
the price is let's say hundred dollars
and the product type is
non-luxury
[Music]
next
I'll just copy this
to reduce our task
we'll edit this
the third product's ID is 103
the product is laptop
and let's say the price is thirteen
hundred dollars
and it's a luxury product
I'll paste again and finally I'll enter
my fourth product
which is let's say
table
and the price is
400 and it's a non-luxury product
I'll give a semicolon and we'll insert
these four records to our products table
you can see
we have inserted four records let's just
print it now so I'll write
select
star from
products
if I run it
you can see we have our four products
ready
now
we need to create another table where we
are going to put some records
from our products table so that new
table is going to be the orders table so
I'll write create
table
orders
now it will have three columns the
order ID
order ID will be of type integer then we
have
product
underscore sold
this would be of type
varying character of size 30 and finally
we have the selling price column
this will be of type float
let's create our orders table
the table name should be orders and
there is some mistake here okay
you should close the brackets okay
let me run it
so we have our order stable ready
now
let's write our
insert sub query
so I am going to insert
into
my table that is
orders
and I'll select
the product ID
comma the item
and the selling price or the sale price
from
my table that is products
where
I'll write
product ID
in
I'll write my inner queries select
broad ID or the product ID
from
products
next I'll give a where Clause where
the selling price
is greater than one thousand dollars
so let me tell you what I am going to do
here I am going to insert into my orders
table
the product ID the item name and the
selling price from my products table
where
the product ID
has this condition so let me first run
this condition for you which is Select
product ID from products where the
selling price is greater than 1000 if I
run this
okay there is some issue here
the column name is actually prod ID
now let's run it again so that we can
see the product IDs of the products
which have a selling price greater than
1000 so it is one zero one and one zero
three now let's run the entire query
there is another mistake here let's
debug the mistake
now this should be product ID instead of
product underscore in
let's insert again all right so we have
successfully inserted two records to our
table that is orders now let's see the
order stable I'll write select star from
orders
if I run it there you go so there were
two products from a product table that
were jewelry and laptop which have a
selling price greater than one thousand
dollars so the selling price for jewelry
was 1800 and for laptop it was thirteen
hundred dollars so this is how you can
use a sub query using the insert
statement all right now going back to
our slides again
all right
now let's see how you can use sub
queries with the update statement
now the sub queries can be used in
conjunction with the update statement so
either single or multiple columns in a
table can be updated when using a sub
query with the update statement
so this is how the basic syntax of an
update sub query looks like so you write
update table followed by the table name
you set the column name to give the
where operator and then you write your
inner sub query
so we are going to see an example
where we will use this employee stable
and using this employee stable we will
update the records of the salaries of
the employees
by multiplying it with a factor of 0.35
only for those employees which have age
greater than 27.
so we are going to use a new table
called employees underscore B for this
as well so let's see how to do it
so I'll give my comment as
update sub query
before we see the sub query let's see
what we have in the table employees
underscore B
this is basically a replica of the
employees table
there you go it has the same records
that our employees table has we are
going to use both the employees table
and the employees underscore B table to
update our records
so I'll write
update
employees
set
salary equal to
let me bring this to the next line
I'll write set salary equal to
salary
multiplied by point
three five
where
age
in
then I'll write select
each from
my other table that is
employees underscore B
where
age is greater than equal to
let's say 27.
all right
so let me run through this query and
tell you what we are going to do so I am
going to update the records of the
employees table specifically for the
salary column so I'm checking if the age
is greater than 27 then will multiply
the salaries of the employees with a
factor of 0.35 in the employees table
let me just run this then we'll see our
output
okay so it says 18 rows affected which
means there are total 18 employees in
the table out of the 20 employees whose
ages greater than 27 now if you see I'll
write select star from
employees
you can see the difference in the
salaries
if I scroll to the right you can see
these are the updated salaries
okay
now if you check for employees who have
an each
less than or equal to 27
for example Marcus whose age is 25 his
salary is the same we haven't updated
his salary then if you see
if we have okay there is one more
employee Maya
we haven't updated the salary of Maya
because the age is less than
27.
all right
now let's go back to our slides again
as you can see we got the same output on
our MySQL workbench
now let's explore how you can write sub
queries with the delete statement
now sub queries can again be used in
conjunction with the delete statement so
this is how the basic syntax of a delete
query using sub query would look like
you write delete from the table name
where Clause the operator value followed
by the inner query in within brackets
so here we are going to use the
employees table and what we are going to
do is we'll delete the employees whose
ages greater than equal to 27. so let's
see how you can do it
all right so I'll
keep my comment
as
delete sub query
so we'll follow the syntax that we saw
I'll write delete
from
my table name that is employees
I'll write
where
each
in and then I'll start my inner query or
the sub query I'll write select each
from
employees underscore B
where
age is let's say
greater than equal to
32 or let's say the age is less than
equal to 32
close the bracket and I'll give my
semicolon
let me first run the inner query for you
so that you get an idea of the employees
who are less than
32 years of age
so there are nine employees in the table
who have an age less than equal to 32 so
we are going to delete the records
if I run this
okay it says nine records deleted
now let's
print or display what we have
in the employees table
if I run this
there you go so if you see the age table
we have total 11 employees now and all
their ages are greater than
32 because we have deleted all those
employees who had an h less than equal
to 32. okay
so
let me show you from the beginning what
we did so first we used our sub queries
database then we used our employees
table
so we started by looking at how you can
use the sub query
with a select statement this should be
insert instead of update
so we learned how to write an insert sub
query
we use two tables products and our order
stable
moving ahead we saw how to write
sub queries using the update command
so we updated the salaries of the
employee by a factor of 0.35 for those
who had an each greater than equal to 27
and finally we saw how to use the sub
query using the delete statement so we
deleted all those records for the
employees whose age was less than equal
to 32. so I am on MySQL workbench so
first let me go ahead and create my
connection
I'll give my password
all right now this will take you to my
SQL editor okay so first and foremost
let me create a new database called
triggers
so I'll write my SQL command as
create
database
triggers
let me run this
okay so you can see here one row
affected I have created my database that
is triggers
next I'm going to move inside this
database so I'll write the command use
triggers
let's run this
okay
now inside this triggers database we'll
be creating our different tables so
let's check if we have any tables I'll
use the command show tables
now you see there are no tables in this
database
all right
first let's see how before insert
trigger works
so for before insert trigger we'll
create a table called customers and
verify the age of each customer
so I'll give a comment before
insert
trigger
so let me go ahead and create my
customers table I'll write create table
customers
and I'll give my column names as
cast underscore ID which is customer ID
this is going to be an integer then we
have the age of the customer
this is again an integer
and we'll have the
name of the customer
the name of the customer will be a varka
type I'll give the size as 30
all right
let's create this table okay so we have
successfully created our customers table
now moving ahead I am going to write my
before insert trigger command so we'll
start with a delimiter
so a delimiter is a marker for the end
of each command
next
I'll write my create trigger
followed by the trigger name
I'll give a valid trigger name such as
each underscore verify
I'll write
before trigger
it should be before insert
on
my table name would be
customers
then I'll write for
each row
if
Nu dot each
is less than zero
then
set
new DOT each
equal to 0 which means
while inserting your values to the each
column in case the each value is
negative we'll convert the each to zero
I'll give a semicolon
and then I'll write end if
I'll give another semicolon
and
close the delimiter
now let me run this
okay so we have created our trigger
now
let's insert a few values
onto customers
so I'll write insert into customers
values
1 0 1 which is the customer ID I'll give
the age as 27 and let's say the name of
the customer is James
let's insert another record
give the value as 1 0 2 and this time I
am purposely giving the age as minus 40
Which is less than 0 so that you can see
the output clearly
I have given the customer name as Amy
let's insert two more records the
customer ID with 103 has an ease of 32
and let's see the name is Ben
I'll give another comma
and finally we'll insert our fourth
customer record
the customer ID is 104
the age I am giving as minus 39 Which is
less than 0 again and let's say
the customer name is Angela
all right
now let me run this
okay so we have successfully inserted
four rows of information to our
customers table
now let's see the difference since we
had created a
each verify trigger
which would
change the values of the each column in
case the each value is less than zero so
now that we have inserted four records
to a customer
so
let's see what we have in the customers
table
now let me run it
there you go so if you see this
for those customers where the age was
less than zero such as 102 and 103 you
can see here
our trigger has automatically converted
those values to zero
if you can see the trigger we had
created
we had set our new age to zero if the
age was less than zero
and this is the output we get
so here we looked at how a before insert
trigger works all right now moving ahead
let's understand how an after insert
trigger works so I'll give a
comment here
as after insert
trigger
now in this example we'll create two
tables customers and message
now the trigger will be fired if the
birthday column has a null value in the
customer's table you will get a message
to update your date of birth
okay so first let me create
my customers table
now since we already have one customer's
table I'll name it as customers one
and
let me give the column names
so the First Column would be the ID
column this is going to be an integer
and I'll use the auto increment
parameter
and this will be my primary key as well
next we'll have the name of the customer
this is going to be of type worker
and I'll use
not null constraint
next
we'll have the email ID of the customer
this is again going to be of Barca type
and
the column we are interested in is the
birthday column
so I'll write birth date
this is going to be of type date
okay
so let's create our table
all right now we'll create our second
table
which is going to be
message
let's create the columns this will have
ID int and
I'll use the
Auto increment operator
next we'll have the
message ID
this is going to be of integer type
will
have a column called message
this will be a varka type let's say 300
characters
and not null
and I'm going to set
my primary keys
as ID and
message ID
let's create our second table then
so we have some error here let's debug
the error
okay so I forgot to close the bracket
here all right now let me
run this table all right so we have
created our message table as well
next
I'll write my after insert trigger
command so I'll write
delimiter
next I'll use
create trigger command so I'll write
create
trigger
my trigger name would be check
underscore null underscore date of birth
after
insert
on
customers
one
for
each row
begin
if
new DOT
birth date
is
null
then
we are going to insert
into our message table
we'll give the columns as
message ID and
message
values
new DOT ID comma I'm going to use the
concat function
where I'll
give my
message let's say hi
followed by the name
followed by
let's say please
update your
date of birth
okay
now I'll write end if
I'll
close the delimiter
okay
so let me go to the top and recheck
if you have created a trigger correctly
so I have my trigger name after insert
on customers 1 for each row begin
if our new birthday has a null value
then we'll pass in a message saying hi
the name of the customer
then the message would be please update
your date of birth
all right so let's run the
trigger okay
now
the next step is to
insert a few records to customer table
so my name of the table is customers one
okay
I'll keep the column names as name
email
and birth
okay
will
pass in a few values
so our first customer's name let's say
is Nancy
comma
I'll give my
email ID let's say Nancy at the rate
ebc.com
now
let's see I'm purposely passing the date
of birth as null
I'll give a comma
my next customer let's say the name of
the customer is Ronald
and then I'll give the
email ID
such as Ronald at the rate
xyz.com
and this time I am going to pass in the
date of birth let's say 1998
November
and let's say 16th
okay
now we'll
add another customer let's say Krish
will give the email ID of Chris
so Chris at the rate xyz.com
and let's see
we'll give the date of birth as 1997.
08 20.
and finally We'll add
one more record for another customer
let's say Alice
I'll give the email ID as Alice at the
rate abc.com
and this time I'll purposely pass
the date of birth as null
all right
so let's run the insert query okay
now
let me display the message table for you
so that you can
see the output
and how our
after insert trigger works
there you go so if you see this we had
inserted four rows of information out of
which the first customer ID and
the fourth
ID had null data birth so for those two
values you have the messages hi Nancy
please update your date of birth and
then you have high Alice please update
your date of birth now you can give a
space between High and
the name of the customer
all right now moving ahead let's
understand how before update trigger
works so I'll give a comment here as
before update
okay
now
to show you how before update works
first we'll create
a table called employees
all right so let me create my table that
is create table
employees
I'll give my column as
employee ID
this is going to be an integer type
and
it will be my primary key
next we'll have the employee name
this will be of
War car type
and let's say the size would be 25
comma then we'll have the age of the
employee age will be of integer type
and finally we'll have the salary of the
employee salary will be of type float
let's create this table
all right now the next step is to insert
a few records to
our employees table
okay so here on the notepad I have
already
written my insert query so I have
inserted nearly seven records so let me
paste it here all right
I'll just go ahead and run this insert
query so that we'll insert
seven employees to our table
okay
next
we'll write our before update trigger
command
so first and foremost I'll write
my delimiter
followed by the create trigger command
I'll give my
trigger name as update underscore
trigger
let's bring this to the top
okay
I'll use
before update
on
my table that is employees
for
each
row
I'll write begin
my condition would be if
new DOT
salary
is equal to let's say
ten thousand dollars
I'll write then
set
new DOT
salary
equal to
85 000 dollars
I'll give a semicolon
then I'll use
else if
new DOT salary
is less than
ten thousand dollars
then
I'll set
new DOT salary
to let's say
seventy two thousand dollars
I'll give a semicolon
I'll end the if statement
I'll close the delimiter
by giving a semicolon
okay
so
if you see the employees table we have
the salary values here
now in case
while updating the table
if the salary is equal to ten thousand
dollars will set the new salary to
eighty five thousand dollars
else if the salary is less than ten
thousand dollars we'll set the salary
column values to seven to two thousand
dollars
so let's go ahead and run this
trigger query
all right
now let me use my
update command so I'll write update
employees
I'll write set
salary is equal to let's say eight
thousand dollars
now if you see our trigger query we are
setting the salary to eight thousand
dollars which is clearly less than
ten thousand dollars so our new salary
would be seven to two thousand dollars
so let me run this okay
so you can see here six rows affected
so I'll write now select star from
employees
let's run this
okay if you see this
we have converted our salary column to
72 000 since we updated the salary to
eight thousand dollars and according to
our trigger query if it's less than ten
thousand dollars the salary should be
seven to two thousand dollars which you
can see here
all right now moving to our final demo
this time we are going to explore how
before delete trigger command works
so in this example we'll create a table
called salary
we'll store the deleted record in a new
table using the before delete trigger
so first
I'll give my comment as
before trigger
comments are always useful
since they make your query more readable
so let me now create my salary table so
I'll write create
table
salary
I'll give my
column name says Eid which is employee
ID
and I'll set it as primary key
comma
I'll give another column let's say valid
from
which means the date from which this
salary was effective
is going to be of type date and not null
and then I'll have the amount
will be of type float
and again not null constraint
let me run the create table
command okay so we have created our
salary table now the next thing is to
insert a few values
so I'll write insert into salary
I'll give my column names as Eid comma
valid from
comma amount
I'll write values
my first employee ID would be one zero
one
followed by a date let's say 2005.
me
and
0 1 which is first of May 2005.
let's say the amount is 55 000 dollars
I'll give another row of information
this time the employee ID is 102
and
I'll give a valid from date
let's say the amount is 68 000.
I'll give
another employee ID let's say one zero
three
2006
zero nine zero one
and let's say the amount is seventy five
thousand dollars
okay
let's run this
all right
you can verify also so I'll write select
star from salary
you can see here we have inserted three
rows of information
all right
the next step is to create
another table that will store the
deleted rows so I'll write create
table
let's say the name of the table is
create
or let's say salary delete
I'll write salary Del
now this will have the ID
the type would be integer and primary
key
I'll also use the auto increment
operator
next we have the Eid which is of type
integer
I'll write valid from
date and not null
then I have the amount column which is
of type float and not null
my final column would be deleted
at
the data type will be time stamp
I'll use the
default constraint as now
so this will return the time and the
date at which the record was deleted
all right
let me create this table okay
finally
let me write my before delete trigger
command
so I'll first declare my delimiter
let's say this time I'm using the dollar
symbol
I'll write create
trigger
my trigger name would be
salary underscore delete
before
delete
on my table that is salary
for
each row
I'll write begin
next
let's insert
into
salary
delete
I'll give my columns as employee ID
valid from
an amount
now we'll insert a few values
I'll write values
Old Dot Eid
comma
Old Dot
valid from
comma Old Dot amount
I am going to
close
with the delimiters
all right
so let's run our
before delete trigger
all right
now let me go ahead and delete one of
the records from the salary table so
I'll write delete from salary where
employee ID is let's say 103.
let me run this query
okay so you have successfully deleted
one of the
records in the table
now if you see
our other table that is salary delete
you will find
this information present in the salary
delete column so we have deleted one row
of information that is for employee
id103 which you can find it here now
the final column that is delete at shows
the time at which the information was
deleted or the row was deleted
all right so let me go to the top and
just
give you a recap of what we did in this
demo so first we created our database
called triggers
then
we started with before insert trigger
where we inserted customer table and
then
we verified the age of the customers
so we saw if the age was less than zero
then we set these to zero
we inserted a few records to the
customer's table and purposely we
inserted some negative age records and
then we converted this either cost to
zero
then we learned how an after insert
trigger works so we created two tables
customers one and message
so wherever
the customers date of birth was missing
we passed in a message saying hi the
name of the customer please update your
date of birth
all right
now moving ahead
we saw how before update trigger works
and finally we learned about
before delete trigger if you're an
aspiring data engineer looking for
online training and graduating from the
best universities or a professional who
Alex to switch careers with data
engineering by learning from the experts
and try giving a shot to Simply launch
data engineering postgraduate program
from Purdue University in collaboration
with IBM the link in the description box
and the print comment should take you to
the program being offered
python as you must be aware is a high
level general purpose programming
language that can be used for data
science and Analytics
in this tutorial we will learn how to
work with databases and tables using SQL
with python
to do this demo we'll be using our
jupyter notebook and the MySQL workbench
you can see it here
so we will write our SQL queries in the
jupyter notebook with python like syntax
if you don't have MySQL or Jupiter
notebook installed so please go ahead
and install them first
while installing the MySQL workbench you
will be asked to give the username and
password let me show you
so I am on my MySQL workbench so once
you connect it will ask for the username
and the password so I've given my
username as root and password you can
give
while installing it
we'll be using the same user ID or the
username and the password to make our
connection
so let's get started with our Hands-On
demonstration part
first and foremost let me go ahead and
import the necessary libraries
I'll give a comment as import libraries
all right
so first
I'll import
MySQL dot connector
next
from mysql.connector
I am going to import
my error method or the error module
next I want to import pandas as PD
so let's run this
okay there is some error here
this should be capital E and not small e
all right
you can see I have imported my important
libraries
now
I'm going to create a function
that will help us create a server
connection
so I'll write my user defined function
by using the def keyword
I'll write create underscore
server underscore connection
this is going to be my
function name
and it will take in
three parameters first is the hostname
next is the username
and then we have the user password
all right
I'll give a colon
and then in the next line I am going to
Define a variable
which is going to be connection and I'll
assign it to a value called none
now we'll be using exception handling
techniques to connect to our MySQL
server
the try block lets you test a block of
code for errors and the accept block
will handle the errors so I'll write
try and give a colon
and then
I am going to reassign the connection
variable
to a method which is
MySQL Dot
connector
dot connect
now this
mysqlconnector.connect method sets up a
connection so it establishes a session
with the MySQL server if no arguments
are passed it uses the already
configured or default values so here we
are going to pass in
three parameters the first is the
hostname
I'll write host equal to
hostname which is host underscore name
I'll give a comma
then I'll write
user
equal to
user underscore name
next will be my
password
and I'll assign the value user
underscore password
all right
now
I am going to
use a print statement and write
MySQL
database
connection
successful
after this
I'll give my except block
so I'll use the keyword accept
here I'll write error as
err
do a colon and then I'm going to use the
print statement
here I am going to use some
print formatting techniques using the F
letter
I'll write error colon
and I'll use curly braces
give RR and then I'll close the
double quotes
after this
I am going to
return
my connection
all right
let me give a comment here
we are going to assign our password
so we need to put our
MySQL
terminal password
so this password you assign it while
installing MySQL workbench
I'll write
p w
and I'll give my password which is
simply at the rate one two three four
five
and then
I'm going to
give my database name so I'll give
database name
here
I am going to write DB
equal to this is the database I want to
create which is going to be MySQL
underscore python
let me just scroll this down
okay
now
I'll say
connection
equal to
I'll pass in my
user defined function name which is
create
server
connection
and the parameters which are going to be
localhost that is my
host name
my username which is root and then I'll
give PW
which is my password that is exactly
simply at the rate one two three four
five let's just run it now
okay there is an error here we need to
remove this
double quotation
all right
made another mistake here this this
should be root
okay you can see here mySQL database
connection successful
all right
next
we are now going to create a database
that is MySQL underscore python so I'll
give a comment create
MySQL underscore python
database
again to create this database I am going
to create another user defined function
using the def keyword
I'll write
the function name as create database
passing the parameters as connection
comma query
give a semicolon
and in the next line
I'll write cursor equal to
going to make the connection so I'll
write connection Dot
cursor
and I'll give the parenthesis
so this mysql's cursor of MySQL
connector python is used to execute
statements to communicate with the mySQL
database the MySQL cursor class
initiates objects that can execute
operations such as the MySQL statements
okay
next
I'm going to again use my try and accept
block so I'll write
try
give a colon and here I am going to use
cursor Dot
execute
within that I am going to pass in my
query
next I'll use a print statement
and the message I am going to display is
database
created successfully
after this
I'm going to write my accept block
I'll write accept
error as err
or give a colon and then I'll use a
print statement I'll write print
I'll use the formatting again
error
colon
then I'll write
within single course I'll give curly
braces err and then I'll close the
double quotes
next
let's
use the variable
create
underscore
database
underscore query
and
here I am going to write my
SQL query to create the database so I'll
write create
database
and followed by that I'll give my
database name which is going to be MySQL
underscore python
okay
after this
I'll call my function which is create
database
and I'll pass in the parameters the
first one is connection
and next
the query is create underscore database
underscore query let me just copy it
and I'm going to paste it here
all right so what I am doing here is
I am creating a new function
that is to create a new database with
the name
MySQL
underscore python which you can see it
here
now this function takes in two
parameters connection and query
I'm using the connection dot cursor
function which is often used to execute
SQL statements using Python language and
then I have created my try and accept
blocks
so this try block statements will try to
create my new database which is MySQL
underscore python in case it fails to
create the new database
the excerpt block will work so here I am
writing my SQL query to create a new
database which is create database
followed by the database name and I am
assigning it to a variable which is
create database query and then I'm
calling my function create database and
passing in the two parameters connection
and the query all right so let's just
run it all right you can see here it has
created my database successfully
now
you can verify this by checking the
MySQL workbench or the MySQL shell
you can see on the MySQL workbench here
on the left panel under schemas there is
a database called MySQL underscore
python let me just expand it now we
haven't created any table so it's not
showing it now
the next step we are going to connect to
this database
so let's go ahead and connect to our
database that we have just created I'll
write the comment as connect to
database
now to connect to a database I'm again
going to create a user defined function
using the def keyword I'll write create
underscore
DB which is for database underscore
connection
and the parameters it will take is the
host name
followed by the username
then we have the user password
and finally we have the
database name
I'll give a colon
in the next line I am going to create my
variable
which is connection and then I'll assign
it to a value
none
after this I am going to use my
exception handling techniques so I'll
write my drive block first
I am going to reassign my connection
variable
using the
MySQL connector method so I'll write
MySQL Dot
connector dot connect
so this method
will take in the
parameters
so first
it will take the
hostname
I'll write
host equal to
host underscore name
I'll give a comma next it will take the
username so user equal to user
underscore name
give another comma
next
it will take the user password
I'll use pass WD equal to
user underscore password
we'll give another comma
and this time
it is going to be the database name so
I'll write database equal to DB
underscore name
now
let's use the print statement
and the message we are going to print is
MySQL
database
connection
successful
all right
finally
we'll write my
accept block I'll write accept
error as err
give a colon and then I'll use the print
statement
f
within double quotes I'll write error
colon
within single quotes curly braces I'll
write err and we'll close the double
quotes
finally
this function
will return
the connection value
all right
let's run it and there you go
it has run successfully so we have
connected to our database
now it's time for us to execute SQL
queries
I'll give another comment saying
execute
SQL
queries
all right
now to execute our SQL queries I'll use
another user defined function which is
execute
underscore
query
and I'll pass in the parameters as
connection and
query
give a colon
I'm going to write
cursor
equal to
connection dot cursor
now this is used to establish a
connection and run SQL statements
next we'll use the try and accept block
so I'll write try
cursor
Dot
execute
this will take in one parameter which is
going to be my query
and then I'll write
connection
Dot commit
which is another method
now let's use the print statement
so I'll write
print
let's say the message would be query
was successful
and then
we'll write our accept block which is
accept
if the try block doesn't work through an
error
using the print statement
within double quotes inside the inside
the curly braces I'll write err
and close the double quotes
all right so let's run it okay so we
have successfully created our
various functions that were needed to
create a database establish a connection
and to execute our queries
all right
now it's time for us to create our first
table inside the MySQL underscore python
database
so to do that I am going to write my
create command in SQL
so first we are going to assign our SQL
command to a python variable using
triple quotes to create a multi-line
string so let me show you how to do that
I'll write my
variable name
which is going to be create
orders
table
it is always recommended to use relevant
variable names to make it more readable
and now
I am going to use triple quotes
so the triple quote
will ensure
I can create my multi-line string inside
the triple code I am going to write my
create command which is create table
here I am going to create an order
stable first
and
inside the orders table I am going to
create my
column names the First Column would be
the order ID
it is going to be of type integer and
I'll assign this order ID as my primary
key column
you'll give a comma next
the second column would be
customer
underscore name
the customer name column would be of
type
varying character so I'll write worker
and I'll give a size of 30. and this is
also going to be
not null
moving ahead my fourth column would be
the product name column
so I'll write product underscore name
product name will be of type
varying character the size is let's say
20 and it is also not null
next I am going to create my
fourth column which is the date on which
the item was ordered or the product was
ordered
so I'll write date ordered
the data type will be date
next
I'll create
a quantity column to keep track of the
number of quantities that were ordered
this is of type integer
my next column would be unit price which
will basically have information about
the price of each unit of product
unit price can be of type float
and finally I'll have the
phone number of the customer
I'll write phone number phone number can
be kept as of type varying character
I have assigned a size of 20
now let's give a semicolon and
will
close the
triple quotes
all right
so this is how the syntax would look
like
next
to run this we are first going to
call our create DB function so let me
give a comment as
connect to the database
I'll write connection
equal to
create underscore DB underscore
connection
my parameters would be
my hostname which is localhost my
username which is root
comma my password
and then my database name which is MySQL
underscore python so I'll write just DB
all right
finally let's execute this query using
the execute underscore
query function that we had created
earlier
this takes in two parameter the first
one is connection
followed by
the variable name which is create
orders underscore table
let us run it
okay there is some error here let's see
what's the error
okay so here we have put four double
quotes this should be triple quotes now
let's run it
okay there is another here let's debug
it
says name cursor not defined
let me just roll it to the above cell if
you see here in our execute underscore
query
function instead of
cursor
I have written cursor so R is missing
let's read on this
and now let's run this again there you
go you can see here mySQL database
connection successful even our query was
also successful
now if you want to recheck if the table
that is orders was created or not you
can check it on the MySQL workbench so
let me show you how to do it so I am on
my MySQL workbench and under MySQL
underscore python database you have
something called Stables let me just
right click and I'll select refresh all
there you go you can see this Arrow just
click on this arrow and here you can see
we have a table called orders so we have
created a table called orders now you
can check the columns as well you have
the order ID you have the order ID the
customer name product name ordered date
quantity unit price and phone number now
it's time for us to insert a few records
to this table which is orders
now to insert records I'll give a
comment as insert
data
I'll start with the
variable name let's say the variable
name is data underscore
orders
I'll give triple quotes
next
I'll write my insert into command so
I'll write insert
into
my table name that is orders followed by
values
and now I'll start entering
my records for each of the rows so first
I'll give 1 0 1 which is the order ID
then I'll give the
customer's name let's say Steve
and the product he had ordered is let's
say laptop
then I'll give my date in which the item
was ordered
let's say it is 2018
I'll choose
zero six as the month and the date is
let's say 12.
we give another comma this time we'll
pass in the quantity which is 2
let's say the price of each laptop was
eight hundred dollars
and
will give a
phone number this is random let's say
six to
9 3
7 3
0
let's say
802
all right similarly I am going to insert
five more records of different customers
and their items that they have purchased
to the stable orders so here on my
notepad I have my rest of the five
records let me just copy it and we'll
paste it in the
cell here this will save us some time
okay
let me recheck if everything is fine
I'll give a comma here all right so we
have
six customers in our table which have
their customer IDs from 101 to 106 you
have Steve Jaws Stacy Nancy Maria and
Danny you have the different items they
have purchased laptop books trousers
t-shirts headphones and smart TV is the
date on which they had ordered this item
the number of quantities they had
ordered
and then we have the unit price and some
random phone numbers
so let's
create the connection now I'll write
connection
equal to
I'll write create
underscore DB underscore connection
then I'm going to give my same
parameters let me just copy it from the
top which is localhost
the host name
root is my username then we have
password and the database name
and then
I'll use the same query as above which
is execute query
I'll copy this
paste it here and instead of create
orders table variable output as data
underscore orders
so this will store my
insert into command you can see the
variable I have used here is data
underscore orders
now it's time let's just run it
all right
there was some mistake here let's debug
it
again this would be triple quotes and
not
4 now let me rerun it again there you go
you can see here mySQL database
connection successful and my query was
also successful
now
we'll create
another user defined function which will
help us read query and display the
results
so I'll write
my function name as DF read underscore
query
this will take into parameters
connection and query
then I'll write cursor
equal to
connection dot cursor
I'll put my
result as none
and then I'll use my try and accept
block I'll write try
cursor Dot
execute
this will take in one parameter which is
query and then I'll
give another variable which is result
equal to
cursor dot fetch all now this virtual
method will return
all the
results in the table
I'll write return
result
next
we'll use the accept block
so I'll write accept
error as err give a colon and I'll reuse
my print statement
scroll this down
foreign
error
give a colon followed by a space
within single quotes
inside curly braces I'll give err and
close my double quotes
let's run it
all right so now we are all set
now we are going to use our select
Clause having whereby
then we'll see how to use Auto by Clause
some inbuilt functions we'll update some
records delete some records and do a lot
of other stuff
so
let's start with our first query
so our first query is going to be
using the
select statement
all right so suppose
I want to display all the records that
we have inserted into our order stable
so the way to do is
I'll assign my query to a variable let's
say q1
I'll give
triple quotes
within triple quotes I'll write select
star from orders
we'll give a semicolon followed by the
triple quotes
now we'll establish the connection so
let me just go to the top and I'll copy
this line
which is to connect to our database
I'll paste it here
now we'll
create a variable called results that
will store the result of this query
and we are going to assign this variable
to
our function that is read query and this
read query will have
two parameters the connection and the
variable name which is q1 for the query
next to display I am going to use a for
Loop I'll write for
results
for result
in
results
print
I'll say result
now we are done
let's just run this query
there you go you can see here you have
successfully printed
all the rows in our table which is
orders you can see we have six records
in total
now we are going to explore a few more
queries so let me just copy this and we
are going to edit in the same query
I'll paste it here
next let's say you want to display
individual columns from the table and
not all the columns so let me
let me create the variable Q2
now instead of star I am going to
display only the customer name
and let's see the phone numbers of the
customer so I'll write phone underscore
number
all right the rest all Remains the Same
let me just recheck it and here instead
of
q1 will put Q2
and
let's run this cell all right you can
see here now we have displayed only two
columns the First Column is the customer
name and then we have the respective
phone numbers
okay
now let me just paste that query again
now we are going to see how you can use
an inbuilt function that is
in our table we have the
order date and from the order date we
are only going to display the different
years that are present in the order date
so to do that I am going to use the ear
function I'll add this query instead of
q1 I'll make it Q3 and here I am going
to write select
here which is my function name from my
column which is date ordered
from orders and here I'll change this to
Q3
q1 Q2 Q3 are basically query 1 query 2
and query three let's run it there you
go so we have successfully extracted the
different years present in the order
date column
now if you want to display the distinct
or the unit dates present in the column
you can
use the distinct keyword in the select
statement so the way to do it is I'll
write select
distinct
give a space
the rest of the query Remains the Same
and here instead of Q3 I'll write Q4
I'll make this as Q4
let's run it
you can see 2018 and 2019 are the unique
your values that are present in the
order date column
okay
now moving ahead
let's write our fifth query and this
time we are going to explore how you can
use the where clause
so I'll change this to Q5
before I write my query
so let's say you want to display all the
orders
that were ordered before
31st of December 2018.
so to filter this we are going to use
the where clause
so I'll write select
star from orders
next I'll write where
my date underscore ordered
is less than
within course I'll give my date value
which is 2018 December
31st
so all the items or the products that
were ordered before 31st of December
2018 will be displayed so let's run it
all right you can see here there are
three orders in our table which have
been ordered before
31st of December
now moving ahead
we want to display
all the orders that were made after 31st
of December
so here
what you can do is I'll just copy the
above query again I'll copy this line
so instead of less than 31st of December
2018 I'll make it as greater than so
every order that was placed after 31st
of December will be displayed
if you run it so you can see here there
are three orders in our table which were
ordered after 31st of December 2018.
now moving ahead
let's write a seventh query
now let's see how the order by Clause
Works in SQL so you can filter your
results based on a particular column or
sort it based on a particular column
so this is going to be my query 7.
I'll write it from scratch again let's
see
you want to display all the columns from
the table so I'll write select star from
orders
then I am going to use order by
unit price
I'll give a semicolon
let's run this query and see the output
now if you see the result here
and you mark the unit price column
the result has been ordered in ascending
order of unit price you see here it
starts
with the lowest price and then
goes on with the highest price towards
the end now if you want to order it in
descending order you can use the keyword
desc
so this will ensure your top
or the most expensive products appear at
the top and the least expensive products
appear at the bottom
all right
next
let's see how you can create a data
frame
from the given table so as you know
using jupyter notebook and pandas you
can create data frames and work on it
very easily so with this table also we
can create our own data frame
so for that let me create an empty list
first I'll write from
DB equal to I'll assign this as an empty
list
so we are going to return a list of
lists and then create a pandas data
frame
next I'll write my for Loop I'll write
for result in
results
I'll assign result
to
list of results so I am converting the
result into a list
and then I am going to append it to the
empty variable or the empty list which
is from underscore DB Dot append
I'll append the result to
my empty list
next
we need to pass in the
columns now that will be part of our
data frame so I'll write
columns equal to this column I'll pass
it
Within
a list so I'll give my first column as
order ID then we have the
customer name
next I have my
product name
then I have the date on which it was
ordered
give a comma then we'll have the
quantity column
let me write it in the next line
next we have the unit price column
and finally we have the
phone number column so I'll write within
double quotes
phone number
and this we are going to assign it to a
data frame so I'll be using PD Dot
data frame which is my function to
convert a list into a data frame
my variable I am going to pass is from
underscore DB
and I'll write
my next argument is columns equal to
my variable name that is columns
finally let's display
the data frame which is DF all right
so here I am creating a empty list first
and then
I am creating a
for Loop and I am appending the results
to my empty list here you can see I have
created my column list
and using PD dot dataframe I'm
converting the list into a data frame
if I run this
this is append and not appends
all right you can see we have our
data frame ready this is the index
column it starts from zero onwards and
then we have the different
column names
okay
now let's see how to use the update
command
now suppose
you want to
change the unit price of one of the
orders
you can use the update command so the
way to do it I'll first
create my variable let's say update
and I'll give three
quotes or triple quotes
then I'll use my update command which is
update followed by the table name that
is orders next I'll write set
let's say unit underscore price
if you see this let's say I want to set
the unit price of trousers from 50
dollars to let's say 45 dollars I want
to update this particular record so I'm
going to write set unit price column
equal to
45 dollars where
the order ID equal to
one zero three
so this query will update the
third row in our table which is order
id103
so it will update from 50 to 45 dollars
I'll close the triple quotes
and now
I'll use the
connection
queries again
let me just paste it here
all right
I'll delete
these three lines of code and instead of
that I'll put execute underscore
query
and this will take into parameters as
always which is going to be connection
followed by the variable name that is
update
let's run it you see here it says mySQL
database connection successful query was
successful
now you can recheck that
to do it let me just go to the top and
we'll
so just copy our first query which is q1
I'll copy this
and I'll paste it here
let me just rename this now
this will be
Q8
and I'll change this as well
right select start from orders where
my order ID equal to one zero three
let's see the unit price of one zero
three now you can see here instead of 50
now we updated it to 45 dollars
all right
now the last command we are going to say
is how you can delete a record from the
table
I'll write delete command as my comment
now to delete a query
I'll first
give my variable name which is delete
underscore order
and I'll pass in within
triple quotes
next I'll write my delete query which is
delete from my table name that is orders
then I'll give my where Clause where
let's say I want to delete my order ID
105.
let me just go to the top and explain
you again
so if you see this we want to delete the
order id105 which was for customer name
Maria and shared ordered headphones we
want to completely remove this
particular record so
I have my delete query ready
now let me just
create my connection and display the
results
so I'll go to the top and I'll copy this
connection command which also has the
execute query command
and I'll paste it here
and I'm going to make a change here
instead of update we'll write delete
underscore order
everything looks good let's just run it
you can see that our query was
successful
and now
if you want to print it let me just show
you
I'll just copy this
will paste it here
I'll make this as q9
I want to verify if my order id105 was
deleted or not
instead of the statement I'll write
select start from orders
and here I'll change this to q9
if I run this you can see it here you
can Mark order id105 was deleted and it
no more appears in this table
all right
so this brings us to the end of the
demonstration on SQL with python let me
just
scroll you through what we did so first
we imported the important libraries
MySQL connector then we imported the
error function then we imported pandas
using PD
we learned how to create a server
connection to mySQL database we created
a new database that is MySQL underscore
python and now we connected to the
database
we created a function to execute our
queries we saw how you can write a
create table command
then we inserted a few records to our
orders table
we created a read underscore query
command to read the queries and display
the results
then we started exploring our
different SQL commands one by one we saw
how to use select query
then we selected a few individual
columns from our table
followed by using a
inbuilt function which was here then we
saw how to use the distinct keyword
after that we used our where Clause to
filter a table based on specific
conditions
we saw how to order your results based
on a particular column
then we saw how you could convert the
table into a data frame using
PD dot data frame function
finally we learned how to use the update
command and the delete command
now what is SQL Server
in any application development today in
any computer application which we
develop database SQL Server plays a very
important and pivotal role
ql servers are used for Persistence of
information in your database which can
be retrieved mined determined or you can
query it at a later point of time
the benefit of having any SQL Server is
that data is persisted in a structured
efficient manner so that it can be
retrieved later quickly and meaningfully
so SQL Server is a relational database
management system in which you can
create tables two-dimensional tables and
connect them using referential Integrity
like primary key foreign key and other
kind of Integrity constraints you can
maintain in this relational database
SQL Server is developed and marketed by
Microsoft so this is a Microsoft product
but it is compatible with all the
Technologies which you want which you
might be using or you might want to use
like node.js Java Etc where you want to
connect your middleware application
server with Microsoft SQL Server
now what is the usage of SQL Server
apart from the definition which I just
shared with you for maintaining and
building databases persistential
databases there are other usages also
which I'll explain you now the first one
is SQL Server analysis service which is
used to analyze data
now the SQL Server analysis service or
ssas is a multi-dimensional analysis
tool that features online analytical
processing provide powerful data mining
capabilities and deeper Dimensions to
business information within a relational
database
multi-dimensional analysis is an online
analytical processing technique olap
technique that produces the ability to
analyze large quantities of data by
storing data in Access and cells instead
of traditional relational
two-dimensional view in rows and columns
ssas places predictive analytic
capabilities in the hands of information
workers by creating an instant
connection to backend data using
familiar applications such as Microsoft
Excel SharePoint etc for analysis visual
representation and collaboration
the next is SQL Server reporting
Services which is used to generate
reports now SSRS is a framework of
reporting mechanisms such as the report
Builder report designer report manager
and Report server that work together
through a web interface to enable the
development of concise interactive
reporting Solutions in print or Web
format
report Builder and Report designer are
two SSRS components for generating
reports report Builder is a simple
solution for the information worker or
business user to create quick reports
without the need to understand the core
structure of the data
the report designer is a tool for
developers because it adds complexity to
custom reports development and you
create data models in it using this tool
requires an understanding of the
business intelligence development Studio
shell in visual studio and the
underlying structure of the data so you
have to be aware of it thoroughly
according to Microsoft the report server
is the core process engine in SSRS that
manages the processing
and delivery of reports using processors
the report manager is an administrative
tool that controls reporting Services
through a web interface
now let's talk about another important
component which is SQL Server
integration Services ssis which is being
used to perform ATL operations extract
transform load now ssis is the data
warehousing arm of the SQL Server
equipped with Superior extract transform
and load capabilities ETL it provides
the vehicle for moving data from
different data sources to another and
changing the data if necessary
the three components in the ssis
platform for starting the data
integration process are the Import and
Export wizard ssis designer and ssis API
programming
the Import and Export wizard simply
transfer data from source to destination
but does not include data transformation
capabilities it's the ssis designer is
an integrated component of the business
intelligence development Studio used for
the development and maintenance of
integration service packages
ssis API programming module allows you
to code ssis packages using any number
of programming languages so there are a
lot of features which are available to
you in order to
manage your data create your data
pipeline structure it build
visualization reports perform ETL
operations Etc so it's an entire
solution Enterprise solution
now let's see what are the different
kind of SQL Server editions Microsoft
provides five editions with various
tools and services and pricing options
as per the needs so enough two additions
of SQL Server which are free of charge
are SQL Server developer and SQL Server
Express now the developer SQL Server
Edition works and function exactly like
an Enterprise SQL Edition the only
difference is the license is used for
testing and development purpose only
this Edition is generally used by
developers to build and test
applications on top of the SQL server
but they can't take it to the production
SQL Server Express Edition now is the
free entry level database version and is
ideal for Learning and building desktop
and small server data driven
applications but not meant for any
serious computation while also having
incredibly limited features
now the other additions are used for
commercial purposes
SQL Server web Edition
it is a low total cost of ownership
option for web hosts and web value add
providers to provide scalability
affordability and manageability
capabilities for small to large scale
web properties
s the SQL Server Enterprise Edition
delivers comprehensive high-end data
center capabilities with blazing fast
performance unlimited virtualization and
end-to-end business intelligence
enabling High service levels for Mission
critical workloads and end-user access
to Data Insights this version has all
the features required for Big Data
now SQL Server standard edition this
delivers basic data management and
business intelligent database for
departments and small organizations to
run their applications and support
common development tools for on-premise
and Cloud enabling effective data
management with minimal I.T resources
now let's look at some advantages of SQL
Server instances
its installation is of different
versions on one machine you can maintain
different installations the maintenance
of production development and test
environments can be done separately
you can maintain a standby server
so installation is streamline it can be
installed via Setup Wizard and the
prerequisites updates are detected and
downloaded by the installer
automatically
the complexity of the installing the
software is minimized significantly
because of automatic installation of
updates
other components such as analytical and
database Services can be installed
separately afterward automatic updation
also reduces maintenance costs quite
significantly
SQL Server 2008 uses policy management
to detect security policies that are not
compliant so this feature allows only
authorized personal access to the
database security Audits and events can
be written automatically to log files
Ms SQL server has built-in transparent
data compression feature also along with
encryption users don't need to modify
programs in order to encrypt the data
the MS SQL server has access controlled
coupled with efficient permission
management tools further it offers an
enhanced performance when it comes to
data collection
okay and coming to the cost reduction so
it has lower cost of ownership SQL
Server includes effective data
management and data mining tools along
with disk partitioning your server's
Optimum maintenance can be ensured by
following effective data management
practices these practices also help you
ensure the availability and
recoverability of data choose from over
300 in-demand skills and get access to 1
000 Plus hours of video content for free
visit scale up by simply learn click on
the link in the description to know more
now let's move on to creating a database
in SQL Server
so I have installed the default SQL
Express on my machine and now I'm gonna
create a database called SQL tutorial
so let's create a database called SQL
underscore
tutorial
okay
now I will write certain queries on top
of it
first I'll create a table
customers let's create a table customers
which has columns customer ID which is
its primary key the name which has
worker customer ID is int age which is
an integer gender male female will
notify it with one character address
which is generally a large num string
value so we'll keeping it back at 20.
item which is vertical 15 and price okay
so let's
create this table
okay so now if you see this table has
been created dbocar dot customers now
all the relevant columns which I created
here has been
present now I have prepared a script to
insert some sample values
so that
we can
query this so I have inserted around
about 20 values
so let's just check whether my data is
present I'll do a select star from my
customer tables and you can see now the
20 rows with the customer ID customer
name age gender address the item which
the customer is purchased and the price
at which he has purchased
now let me show some variations of the
queries which we can perform
now select star means you have selected
all the columns I only want to select
some
selective columns like customer name and
gender so I can also do that you just
need to give the name of the
customer and the gender column
next query I want to check what is the
distinct values of the gender in my
customer tables
so I will only get two values which is
male and female so there is no other
value apart from M and F in my customer
table
next I have a query where I want to find
which all are the customers who have
purchased an item who all are the
customers who have purchased an item
which is having price greater than 250
rupees
a grade so out of 20 only 12 other
customers who have purchased a price
item which is greater than 250 and you
can see all the items which are listed
over here are greater than 250.
next okay I want the customers who are
living in New York
okay fine I just have to change the
where Clause where instead of the price
I am now looking at the address which is
in New York
now it is also possible that you can
apply another filter okay
people living in New York but age is
greater than 28. perfect I only have two
customers who are living in New York but
having age greater than 28
or I want the female customers who are
purchasing items greater than 380 rupees
okay only one out of 20. okay Elena
now we saw examples of and condition
there is also possibility that okay you
want female customers or customers who
are greater than age 30 so you will get
both the records age greater than 30 or
female customers both the records will
come
or
customers who are in Chicago or
purchasing
items greater than 420 so these are the
examples of or conditions
now let's take another example of not
now I want that the customers who are
not
purchasing price less than 650 the
reverse right greater than 650 so I'll
get this answer
or I want the customers who are not
living in New York apart from New York
any other address so all these customers
are there okay
so now these are the examples which I
showed you are the examples where you
can play around you can filter data
applying the where clause
now let's take another example of
aggregated functions in SQL
now amongst the list of customers the
data set of customers which I have I
want to know what is the minimum age of
my customer when a minimum age is 18
years
so when the minimum age amongst the all
the customers is 18 and the maximum is
I can just change it to Max
is 61. so the age range of my customers
who are purchasing are from 18 to 61.
okay now another example hypothetical
example I want the average age of my
customers
where customer ID is greater than 105
okay so if you see
select star where customer ID is greater
than 105 I have 15 customers and amongst
these my average age of my customers is
35.
similarly instead of average I can take
the sum total of the
age
above 105 which is 539 sum total okay
now
I'll show you an example of like
I want the name I want the customers
list where addresses
which consists of e letter E in their
address it anywhere in the string
beginning in the middle because I have
like is a keyword like percentage plus e
percentage means e can come in any part
of the string
okay
and if I just change this example I
remove the percentage from here it means
that I want the customers whose
addresses end with e so only Pune will
come into the picture Okay so
so this is the difference
now coming select start from customers
where age which between 20 and 30 so I
want all the customers which have belong
to age between each 20 and 30 inclusive
so 20 and 30 both are inclusive so it
means the customers which with age 20
and all 30 will also come in this result
set
next example I want the count of total
customers in my
data set which is 20 I inserted 20 so I
know now I actually
I want the count of male customers
oh out of 2019 our mail okay great
and if I group by now let's see an
example of
Group by so I'm on
the count of customers grouped by
address so how many are living in Boston
how many in Chicago Detroit Miami New
York and Pune so I have a customer wise
total count total this is the address
Group by okay so it's a very important
concept you can Group by any column and
then you can do a measure count account
a sum an average you can do any
aggregated calculation this is the other
columns which are not in the group by
like another example I want an average
age per address so in Boston the average
age of my customers 34 who are
purchasing items Chicago 35 only 43 so
like that you can do some analysis this
is all data analytics
now let's see another example
I want to I want to filter data now
after doing a group by it's not so
please note this is different from where
clause in where Clause means filtering
Data before grouping having Clauses used
once you want to filter data after
grouping so you are doing a group by
address count of customers and then only
those cities should come where count is
greater than 2 okay so the customers
the only those addresses are listed
where customers count is greater than 2
okay
now this is an example of
inner queries
you want
Group by customer name in age only those
customers having age greater than the
average age of overall okay so my
average age
if I say my average age
from customers is 36 so overall all the
customers which are more than 36 should
come over here listed over here and
that's what has happened okay
foreign
let's talk about order by let's like
sorting
you want to order by address so it has
ordered by by default
dcdmn P which is ascending
and if you apply keyword descending so
it will do the reverse way
similarly I can order by age which is
descending highest stage first lowest
below
or you can do order by multiple columns
where order by address descending and
then same address within the same
address the customers should be
ascending addresses are descending but
within the address the customer names
are sorted in ascending fashion a first
BCD like that
now this is an inbuilt function in SQL
Server reverse if you see this has
reversed the name of the customers it's
in Reverse fashion
okay the characters are reversed
another example is where you are now
this is not on the table this is just a
sample query where you are replacing
vegetable with fruit
so orange is a fruit so you've replaced
vegetable with the fruit it is just uh
you don't need a table you can just also
write such queries where you don't need
a table
okay
then there is a function called L trim
which is which will remove all the
blanks from the left hand side
R trim which will remove the blanks from
the right hand side
okay let me read an R trim it will
remove the blanks from the right hand
side and then there is trim function
which will remove from both the sides
left and right
now let's take an example of update
command I want to update the name of my
customer whose customer ID is 103 first
let's check what's the name
foreign
I want to change it to Smith and if I
re-query it is changed to Smith okay so
this is an example of
update
now if I want to delete let me check who
is at one zero one I want to delete
customer one zero one Joseph I will
delete it and now if I want to check
okay there's no customer at one zero one
okay now let's stick one other example
this is like another example of inbuilt
function asci it'll give you the asci
code of the character ski a
Sky 4 etc etc right
so there is n number of uh possibilities
there's a n number of queries which you
can write if you're an aspiring data
engineer looking for online training and
graduating from the best universities or
a professional who Alex to switch
careers with data engineering by
learning from the experts then try
giving a short to Simply learns data
engineering postgraduate program from
Purdue University in collaboration with
IBM the link in the description box and
the print comment should take you to the
program being offered So currently I am
on my MySQL workbench let me connect to
the local instance
so I'll give my password
and click on OK
all right so this is my MySQL workbench
query editor so first we are going to
learn sub queries let me give a comment
and write sub queries
all right so first of all let's
understand what a sub query is so a sub
query is a query within another SQL
query that is embedded within the where
Clause from clause or having clause
so we'll explore a few scenarios where
we can use sub queries so for that I'll
be using my
database that is SQL underscore intro so
I'll write my command use SQL underscore
intro now this database has a lot of
tables I'll be using the employee stable
that is present inside SQL underscore
intro Let me just expand this and you
can see here we have an employee stable
so let me first show you the contents
within this table I'll write select star
from employees
let me execute it
okay you can see here we have the
employee ID employee name each gender
there's date of joint Department City
and salary and we have information for
20 employees if I scroll down you can
see there are 20 employees present in
our table
so let's see you want to find the
employees whose salary is greater than
the average salary
in such a scenario you can use a sub
query so let me show you how to write a
sub query
I'll write the select statement
in the select statement I'll pass
my column names that I want to display
so the column names I want are the
employee name
then I want the department of the
employee and the salary of the employee
from
my table name that is employees
next I'll use a where condition where
my salary should be greater than the
average salary of all the employees so
I'll write salary greater than
after this I am going to write my sub
query
so I'll give select
average of salary
from
my table name that is employees
and I'll close the bracket and give a
semicolon
so what it does is
first it is going to find the average
salary of all the employees that are
present in our table
once you get the average salary number
we'll use this where condition where
salary is greater than the average
salary number
so
the inside sub query let me run it first
if I run this
this gives you the average salary of all
the employees which is 75 350 dollars
now I want to display all the employees
who have salary greater than 75
350 dollars so let's run our sub query
there you go so there are eight
employees in our table who have a salary
greater than the average salary of all
the employees
all right
next
let's see another example
suppose this time you want to find the
employees whose salary is greater than
John's salary
so we have one employee whose name is
John
let me
run the table once again
okay if I scroll down
you see we have an employee
as John
you see this
our employee ID 116 is John and his
salary is sixty seven thousand dollars I
want to display all the employees whose
salary is greater than John's salary so
basically all the employees who are
earning more than 65 000 I want to print
them
so let's see how to do it I'll write
select
I want the employee name comma the
gender of the employee
I also want the department and salary
from my table name that is employees
I'll write where
salary is greater than
I'll start my
opening bracket inside the bracket I am
going to give my inner query that is
Select
salary
from employees
where
the employee name is John
So within single quotations I'll give
John as my employee
and end with a semicolon
so
let me first run my inner query
so this will give us the salary that
John has which is sixty seven thousand
dollars now I want the employees who are
earning more than sixty seven thousand
dollars
so let's run our
sub query
okay so you can see
12 rows returned which means there are
12 employees in our table who are
earning more than sixty seven thousand
dollars you see here all these employees
have a salary greater than sixty seven
thousand dollars
okay
now
you can also use sub queries
with two different tables so suppose you
want to display some information that
are present in two different tables you
can use sub queries to do that
so
for this example we'll use
a database that is called classic models
you can see the first database
so let me use this database called
classic Model so I'll write use classic
models
now this database was actually
downloaded from the internet there's a
very nice website I'll just show you the
website so this is the website that is
MySQL tutorial.org
you can see here they have very nice
articles blogs from where you can learn
MySQL in detail so we have downloaded
the database that is classic models from
this website you see here they have a
MySQL sample database if you click on
this
it will take you to the link where you
can download the database so they have
this download link which says download
MySQL sample database
and the name of the database is classic
models all right
so we are going to use this classic
models database throughout our demo
session if I expand the tables
section you can see there are a lot of
tables that are present inside this
classic models database we have Cricket
customers as employees
office there's orders order lines and
many more
so for our sub query we'll be using two
tables that is order details and
products table first let me show you the
content that is present inside
the products table first
if I run this
you see here it says 110 rows return
which means there are 110
different products that are present in
our table which has the product code the
product name
product line we have the product vendor
description quantity in stock Buy price
MSRP
the other table we are going to use is
order details which has the details of
all the orders
let me show you
the records
order details tables has okay so there
are thousand records present in this
table you have the order number the
product code quantity ordered price of
each item you have the order line number
as well
okay
now
we want to know the product code the
product name and the MSRP of the
products whose price of each product is
less than hundred dollars for this
scenario we are going to use two
different tables and we are going to
write a sub query
okay
so
if you see here in the order details
table we have a column called price each
I want to display the product code the
product name and the MSRP of the
products which have a price of each
product less than hundred dollars
so the way I'm going to do is
I'll write select
product code comma
product name now one thing to remember
that this product name is actually
present inside our products table
and product code is present in both the
tables that is production order details
here you can see this is the product
code column
comma MSRP which is present inside the
products table again
from my table that is
products
where
I'll write
product
code
I'm going to use the in operator
next I'll write my inner query that is
Select
product code
from my table
order details
where
my price of each product
is less than 100 dollars
let me run this
okay so you can see there are total 83
products in our table which have
a price less than hundred dollars you
can see the
price here
okay
now we learn another Advanced Concept in
SQL which is known as stored procedures
I'll just give a comment saying
stored procedure
okay
so first let's understand what is a
stored procedure
a stored procedure is an SQL code that
you can save so that the code can be
reused over and over again
so if you want to write a query over and
over again save it as a stored procedure
and then call it to execute it
so in this example I want to create a
stored procedure that will return the
list of players who have scored more
than six goals in a tournament
so I have a database called SQL
underscore IQ
these are a few databases that I've
already created so this database has a
table called players if I expand the
tables
option you see we have a table called
players and you can see the columns
player ID the name of the player the
country to which the player belongs to
and the number of goals each player has
scored in a particular tournament
so I'll write a stored procedure that
will return the list of top players who
have scored more than 6 goals in a
tournament
so first of all let me Begin by
using MySQL underscore IQ database
will run it
so now we are inside the SQL underscore
IQ database
let me
select
star from players to show the
values that we have in the players table
you can see there are six players in our
table
we have the player ID
the names of the players the country to
which these players belong to and the
goals they have scored
so I'll write a stored procedure
so the stored procedure syntax is
something like this it should start with
a delimiter
okay
in the delimiter I'll write
ambition ampersand
next I'll write
create
procedure
followed by
the procedure name
let's say amount to
name my procedure as top underscore
players
okay
next statement is begin
after begin I'll write my select
statement
I want to select the name of the player
the country
and the goals
each player has scored
from my table that is
players
where
I'll write goals is greater than
6.
will give us semicolon
then
I'll end my
procedure with a delimiter that was
double ambison
next
I'll write
delimiter
and give
a semicolon
now the semicolon suggests
this is a default delimiter
and there should be a space okay
now let's run our stored procedure
there you go so you have successfully
created a store procedure now the way to
run a stored procedure is
you need to use the
call method and give the procedure name
that is top underscore place in our case
with brackets and a semicolon
let's execute it
okay there is some problem here
so we made a mistake while creating a
procedure
the name of the column is goals are not
goal
let me create that procedure again
okay it says the procedure top
underscore player already exists let's
just
edit the procedure name instead of top
player we'll write it as top players and
similarly we'll edit here as well
now let's create it again
okay
now to
call my procedure I'll write call space
followed by the procedure name which is
top underscore players
if I run this you can see
we have two players in our table who
have scored more than six goals so we
consider them as the top players in a
particular tournament
all right
now there are other methods that you can
use while creating a stored procedure
one of the methods is by using an in
parameter
so when you define an in parameter
inside a stored procedure the calling
program has to pass an argument to the
stored procedure
so I'll give a comment
stored procedure using in parameter
all right
so for this example I'll create a
procedure that will fetch or display the
top records of employees based on their
salaries
so if you have a table
in our SQL underscore IQ database which
is called employee details
I'm going to use this table you can see
we have the name of the employee the age
sex then we have the date of joint City
and salary
using this table I'll create a procedure
that will fetch or display the top
records of employees based on their
salaries
and we'll use the in parameter so let me
show you how to do it
I'll write
delimiter
this time I am going to use
forward slash
I'll write
create
procedure
followed by the procedure name let's say
SP for stored procedure
sort by
salary is the name of my procedure
and inside this procedure I'll give my
parameter
in
I'll create a variable VAR and assign a
data type integer
then I'll write begin
followed by my select statement where
I'll select the name
each
salary
from
my table name that is
EMP details or employee details
I am going to order this by
salary
descending
and
I want to display
limited number of
records so I'm using this
limit keyword and my variable VAR which
I
created here
I'll end my select statement
I'll end my stored procedure with
forward slash
and I'll go back to my default delimiter
that is semicolon
all right
so let me
run this
there should be a space here all right
so let's run this
okay you can see we have successfully
created our
second stored procedure which is sp
underscore sort by salary
now you can also check whether the
stored procedure was created or not here
you have an option to see the stored
procedures let me just refresh this
and you can see we have
three stored procedures that we have
created so far one is sp underscore sort
by salary
the other two were top underscore player
and top underscore players
okay
now let's call our stored procedure I'll
write call
space followed by the stored procedure
name which is sp underscore sort
by salary
and inside this I'll give my parameter
which was actually VAR and this VAR
we have used in limit
let's say I want to display only the top
three records of the employees who have
the top three highest salaries
okay so let me run it
there you go so Amy Sarah and Jimmy but
the top three employees who have the
highest salary
so you saw how you could use the in
parameter in a stored procedure
we created a variable and that variable
we used in our select statement and we
called our stored procedure and passed
in that
variable
okay
now
instead of a select statement inside
stored procedure you can also use other
statements let's say update
so I'll create a stored procedure to
update the salary of a particular
employee
so in this procedure instead of Select
statement we'll use the update command
in this example we'll use the in
operator twice
so let me show you how to do it
I'll write my delimiter first which is
going to be forward slash
then I'll write create
procedure
my name of the procedure is going to be
update salary
and inside the
update salary name
I'll write in
and then
temp
underscore name which will be a
temporary name variable and the type
I'll assign is worker 20
I'll again use my in parameter I'll
write in
next
my other variable would be new
underscore salary
and the data type would be float
I'll write begin
and write my update
command or update statement I'll write
update
table name that is employee details set
salary
equal to
new underscore salary
where
name is equal to
my temporary variable that is temp
underscore name
so this is my
update command and I'll
end the delimiter
all right
so let's run this
okay we have successfully created our
stored procedure if I refresh this
you can see I have my stored procedure
update underscore salary
okay
now let's see
first of all I'll
display
my
records that are present inside
employee underscore details table okay
so we have six rows of information let's
say you want to update the salary of
employee Jimmy or let's say
Mary
from 70 000 to let's say seventy two
thousand
or let's say eighty thousand so I'll
call my stored procedure that is update
underscore salary
and this time I'm going to pass in two
parameters the first parameter will be
the
employee name and next with a comma I'll
give my new salary that I want to
so my employee name let's say is Mary
and the salary I want
to be updated is let's say eighty
thousand dollars
we'll give a semicolon
and I'll run it
you can see it says one row affected now
let's check our table once again
there you go if you see this record for
Mary we have successfully updated the
salary to eighty thousand dollars
now moving ahead
we learn to create a stored procedure
using the out parameter so I'll give a
comment
stored procedure using out parameter
okay
so suppose we want to get the count of
total female employees
will create total employees as an output
parameter and the data type would be an
integer
the count of the female employees is
assigned to the output variable which is
total underscore emps using the into
keyword let me show you how to write a
stored procedure using the out parameter
so first I'll declare my delimiter
to forward slash
I'll write
create
procedure
followed by the procedure name
it is going to be SP underscore
count
employees
and inside this I am going to give my
out parameter and the variable name that
is total underscore
emps which is total employees and the
data type will be integer
next I am going to write begin
followed by my select statement that is
Select I want the
count of total employees
and the output I am going to put into
my new variable that is total underscore
emps
from my table that is EMP underscore
details
where
sex is equal to
F which means female
I'll give a semicolon
next I'll end it
with the developmenter and I am going to
change the delimiter to a default
delimiter that is
colon
so let me tell you what I am doing here
I am creating a new stored procedure
that is sp underscore count employees
using this stored procedure I am going
to count the total number of female
employees that are present in our table
EMP underscore details so I've used my
out parameter and I'm creating a new
variable called total underscore emps
the data type is integer here in the
select statement I am counting the names
of the employees and the result I am
storing it in total underscore emps
I have used my wear condition where the
gender of the sex is female
so let's run this
okay so we have created our stored
procedure let's refresh this
okay you can see we have a new stored
procedure SP underscore count employees
now
to call it I'll write call
the name of the procedure that is Count
underscore SP underscore count
employees
within brackets I'll pass in the
parameter as
at the rate
F underscore EMP
will give a semicolon then I'll write
select
at the rate F underscore
EMP as female employees
okay
so as is an alias name let's run this
one by one first I'll call my procedure
and then we'll display the total number
of female employees you can see in our
table we have three female employees
all right
now with this understanding
let's move on to our next Topic in this
tutorial on Advanced SQL now we are
going to learn about triggers in SQL
so I'll give a
comment here
reverse in SQL
so first let's understand what is a
trigger so a trigger is a special type
of stored procedure that runs
automatically when an event occurs in
the database server there are mainly
three types of triggers in SQL we have
the data manipulation trigger we have
the data definition trigger and login
triggers
in this example we'll learn how to use a
before insert trigger
so we will create a simple students
table that will have the student's rule
number the age the name and the students
marks
so before inserting the records to our
table we'll check if the marks are less
than 0
so in case the marks are less than zero
a trigger will automatically set the
marks to a random value let's say 50.
so let's go ahead and create our
table that is
students
all right
so I'll write
create
table
Turin
now this table will have the student
rule number
the data type is integer
it will have the age of the students
again the data type is integer we have
the names of the students so the third
column would be
name
the data type would be variable
or varying character
size I'm giving it as 30 finally we have
the marks as floating type
so let's create this table which is
student
so we have created our table
now
I'll write my
trigger command
so trigger command will start with
delimiter like how our usual stored
procedures have
next
time I'll write create trigger
then you need to give the
name of the trigger that is Mark
underscore
let's say verify
I am going to use a before insert
trigger so I'll write before insert
on my table name that is student
next I'll write for each row
if
new DOT marks
is less than 0
then
we'll set
new DOT
marks
equal to 50.
so this is my
condition first we'll check
before inserting if any student has
marks less than 0 we'll assign a value
50 to that student because usually the
marks are not less than 0 in any exam
I'll write end if
semicolon and I'll close the delimiter
so this is my
trigger command I'll run it
it says triggle already exists so in
this case we need to update the
trigger name let's say
I'll write marks underscore verify
underscore
student for St
let's run it again
okay there is an error here because
in our table the column name is Mark and
not marks so here we need to change it
as Mark instead of marks
all right
let's run it
okay so we have created our trigger
now
let me insert
a few
records to the student table
so I'll write insert into student
I'll write
values
and give the values as
501 which is the student roll number the
age is let's say 10
the name is it's a Ruth
and the marks is let's say 75 point
zero
if a comma we'll insert our second
student record
student rule number is 502
age is 12
the name is let's say Mike
and this time I'm purposely giving a
value of minus 20.5
give another comma
we'll insert the Third
record
for student rule number 503
ages 13
the name is Dave
and
let's say the marks obtained by Dave is
90
.
now we'll insert our final record for
student number
504
these is 10
neem Islander as Jacobs
and this time again I'm purposely giving
the marks in negative
12 point let's say 5.
close the bracket and give a semicolon
and I'll run my insert statement okay so
we have inserted four rows of
information to our student table
now
let me run the select query I'll write
select star from student
if I run this you see the difference
there you go
so originally we had inserted
for 502 the marks was minus
20.5 and for 504 for Jacobs the marks
was minus 12.5
our trigger automatically converted the
negative marks to 50 because when we
created our trigger we had set our marks
to 50 in case the marks were less than
zero
so this is how a trigger works
now you can also
drop a trigger or delete a trigger you
can just write drop trigger followed by
the trigger name in this case our
trigger name is
St
I'll just paste this here
and if you run this it will
automatically delete your trigger
you give this as a comment
okay
now moving on
now we are going to learn about another
crucial Concept in SQL which is very
widely used
this is known as views so views are
actually virtual tables that do not
store any data of their own but display
data stored in other tables
views are created by joining one or more
tables
I'll give a comment as views in SQL
okay
now
to learn views I am going to use my
table which is
present inside classic models database
now this database as I mentioned we had
downloaded
we had downloaded it from the internet
so first of all let me write
use classic models so I'll switch my
database first
all right now we are inside classic
models
so here
let me show you one of the tables which
is called customers so I'll write select
star from customers
okay
I missed s here
let's run it again so this is my
customer table which is present inside
classic models database it has the
contact last name the contact first name
the customer name customer number we
have the address State country and other
information
now I'll write a basic view command
using this custom table the way to write
is I'll write create
View
followed by The View name which is cast
underscore details
then you write as
select
I am going to select a few column names
from my original customer table which is
this one so I need the customer name
let's say I need the phone number
and the city so you have this
information here you have the phone
number and the City
all right
I'll write from my table that is
customers
if I run this
my view that is cast details will be
created
let's run it there's some error here
because the name of the table is
customers and not customer
I'll give an S and I'll run it again
all right so you can see we have created
our view
and to display the contents that are
present inside our view I can write
select star from followed by The View
name that is custom details
let's run it
there you go so we have the customer
name the phone number and the City of
the different customers that we have in
our table
all right
now let's learn how you can create views
using joins so we'll join two different
tables and create a view
so for that I am going to use my
products table and the products lines
table I am talking about the product
stable and the product lines table
present inside classic models database
so before I start let me display the
records that are present inside the
products table
let's run it so these are the different
products you can see here
now let's see what we have in product
lines table
so we have the product line the text
description and there's some HTML
description and image
so
I'll create a view by joining these two
tables and will fetch specific records
that are present in both the tables
so let me first start by writing create
View
followed by The View name that is
product underscore
description
as
I'll write
select
product
name
comma
then I'll write
quantity
in stock
I also want the MSRP
now these three columns are present
inside the products table and next from
the
product lines table I want the text
description
of the products
so I'll write from
products table
I'll give an alias as p
followed by Inner join my other table
that is
product lines as let's say PL
on
the common column that is product line
so P Dot
product line
is equal to
I'll give a space
PL Dot
product line
okay
so here we have used an inner join to
fetch specific columns from both the
tables and our view name is product
underscore description let us run it all
right so we have our view ready
now let me
view or display what is present inside
our product underscore description
View
I'll add select start from
product underscore description
let's run it
there you go so we have the product name
the quantity in stock msrpn textual
descriptions of the different products
in the table
okay
now there are a few other operations
that you can perform let's say you want
to rename a view instead of product
underscore description you want to give
some other name
so I'll just give a comment rename
description
so to rename a description you can use
the
rename statement I'll write rename table
product
underscore description Which is my
old name
I want to change this name to let's say
I'll give vehicle description
since
all our products are related to some of
the other vehicle so I'll write vehicle
description
okay
let us run it
all right so here you can see I have
renamed my
View
so here if I just refresh it
and I'll expand this you can see we have
the cash details view and we have the
vehicle underscore description View
okay
now either you can view all the views
from this panel
or you can use a command let's say
I'll write display views
just a comment
now to show all the views you can use so
full tables
where
table
underscore
type is equal to within single quote
I'll write View
so this is the command that will display
all the views that are present inside a
database
there is some
error here let's debug the error
this should be
okay so instead of table types it should
be table type equal to view
let's run it
you can see the two different views that
we have one is customer details another
is vehicle underscore description
okay
now you can also go ahead and delete a
view
for that you can use the drop command
so I'll write drop
view followed by The View name let's say
I want to delete
customer underscore details or cast
underscore details view
I'll write drop View cast underscore
details
let's run it
you can see
here we don't have the cast underscore
details view anymore
all right
now moving to our final section in this
demo
here we will learn
about Windows functions
now Windows functions were Incorporated
in MySQL in the 8.0 version
so Windows function in MySQL are useful
applications in solving analytical
problems so using the employees table
present inside my SQL underscore intro
database
so we will find the total combined
salary of the employees for each
department
so first let me switch my database to
SQL underscore
into database
I'll run it okay
I'll display my table
that is employee
so here we have 20 employees in our
table
using this table
we are going to find the combined salary
of the employees for each department so
we'll partition our table by department
and print it total salary and this we
are going to do using
some windows functions in MySQL
so I'll write
select
I want the employee name
the age of the employee
and the department of the employee
comma
next I'll write
this sum of salary
over
I want to partition it by
Department
so I'll write Partition by Department
which is Dept
and I'll give an alias as
total salary so that it will create a
new column with the name total salary
from my table that is employees
the output will be a little different
this time
let's execute it and see the result
there you go so here we have created
another column in our result that is
total salary and for each of the
employees and the respective departments
you have the highest salary so in
finance the highest salary of one of the
employees was
155 000 dollars
similarly if I come down we have the
highest salary from HR if I scroll
further we have the highest salary from
it marketing product sales and the tech
team
all right
now we'll explore
a function which is called row number
now the row number function gives a
sequential integer to every row within
its partition
so let me show you how to
use the row number function I'll write
select
row underscore number function
over
my
column would be
salary so I'll write order by salary
I'll give the
Alias as ronum
we give a comma
and I want to display the employee name
and the salary of the employee
from my table that is employees
and I'll order by
salary
so let's see how our row number function
will create
sequential integers okay you can see
here we have a random column and we have
successfully given row numbers to each
of the records you can see it starts
from 1 and goes up till 20.
okay
now this row number function can be used
to find duplicate values in a table
to show that first I'll create a table
I'll write create table
let's say I'll give a random name that
is demo
and let's see we have in this table the
student ID which is of type integer and
we have the student name
which is of type worker
the size is 20
I'll create
the small table with a few records
let's create this table first
now we are going to insert a few records
to our demo table so I'll write insert
into
demo
values
I'll give 101
the name is
Shane
give a comma
I'll insert the second student name 102
the name is Bradley
give a comma
this time
for 1 0 3 we have
two records
let's say the name of the student is
hereth
you give a comma I'll copy this
and we'll paste it again so we have
duplicated one zero three
next we have one zero four
the name of the student let's say is
Nathan
then again let's see for
the fifth student which is Kevin we have
two records
I'll copy this
and I'll paste it here
let me give a semicolon and we'll insert
these records to our table demo
all right
now
let me just
run this table for you I'll write select
star from demo
if you see this we have a few
information that are duplicated in our
table
that is for student id103 and student ID
105.
now I am going to use my
row number function to find the
duplicate
records present in my table I'll write
select student underscore ID comma
student underscore name
I'll give another comma and write
Rue underscore number
within brackets
I'll write partition
by
St underscore ID
comma
St underscore name
okay
then I'll write
order by St underscore ID
close the bracket I'll give an alias as
ronum
from my table that is demo
let's just run it
you can see here
okay
let me just
delete n from here and do it again
all right if you see here that is just
one student in the name Shane we have
one student in the name Bradley
but here if you see for herath
the second record it says to which means
there are two records for hirath and if
I scroll down there is one record for
Nathan and there are two records for
Kevin which means Kevin is also repeated
okay
now we are going to see another Windows
function that is called rank function
in MySQL so the rank function assigns a
rank to a particular column
now there are gaps in the sequence of
rank values when two or more rows have
the same rank so first of all let me
create a table
and the name of the table would be a
random name we'll give it as let's say
demo one
and it will have only one
column let's say variable a of type
integer
we'll create this table first okay
now let's go ahead and insert a few
records to our
table which is demo one so I'll write
value
101
102
let's say 1 0 3 is repeated
I'm doing this purposely so that in the
output you can
clearly distinguish what the rank
function does
we have one zero four
one zero five
we have one zero six
and let's say 106 is also repeated
finally we have
one zero seven
okay
let me insert these values to my table
that is demo one okay this is done
now
if I write
select
VAR underscore a
and use my rank function I'll write rank
over
then I'll
order by my variable that is VR
underscore a
as
an alias name let's say test rank
from
my table that is demo one
let me execute this and show you how the
rank function works
now if I run this there you go
so here if you mark
so for variable a101
the test rank is one for one zero two
the test tank is 2 but
for this value which is 1 0 3 the test
rank is repeated because there was a
repetition for one zero three
so we have skipped the rank 4 here for
104 the rank is 5 now for one zero five
the rank is six now
one zero six again since the record was
repeated twice we have skipped the
eighth Rank and
our rank function has signed the same
value which is 7 for 106 and for the
last value 107 the rank is nine
all right
now moving ahead we'll see
our final Windows function which is
called first value
so first value is another important
function in MySQL so this function
Returns the value of the specified
expression with respect to the first row
in the window frame
all right
so what I am going to do is
I am going to select
the employee name
the age and salary
and I'll write
first underscore
value which is my function and pass in
my employee name
and then I'll write over
order by
my
column that is salary descending
I'll give an alias as highest underscore
salary
from my table that is employees
so let me run this and see how the
first
underscore value function works all
right so in our table
Joseph was the employee who had the
highest salary which was hundred and
fifteen thousand dollars so
the first value function populated the
same
employee name throughout the table you
can see it here
now you can also use the first
underscore value function
over the partition
so let's say you want to display the
employee name who has the highest salary
in each department so for that you can
use the partition
I'll write select EMP underscore name
comma
I want the department
and the salary
comma
I'll use my function that is first
underscore
value
followed by
the name of the employee inside my first
value parameter
I'll write
over
here I am going to use partition
I am going to partition it by
department since I want to know the
employee name who has the highest salary
in each department
and I am going to order by
salary
descending
and I'll give my Alias again as highest
salary
from
my table that is employees
so let's run this and see the difference
in the output okay
so as you can see here
we have
the employee who had the highest salary
from each department so for finance Jack
had the highest salary from HR it was
Marcus similarly in it it was William
if I scroll down for marketing it was
John per product it was Alice who had
the highest salary similarly in sales we
had Joseph
and in Tech we had Angela
so this is how you can use the first
underscore value function using
partition
all right
so that brings us to the end of this
demo session on our tutorial
so let me just scroll through and show
you what we did from the beginning first
we learned about sub queries in SQL so
we initially wrote a simple sub query
and then we used our classic models
database which was downloaded from the
internet and also shown you the link
from where you can download this
database here we used two different
tables and we performed a sub query
operation
we learned how to create stored
procedures
so we learned how you can use the in
operator or the in parameter as well as
the out parameter in stored procedure
after stored procedure we learned
another crucial Concept in SQL which is
called triggers now triggers are also
special kind of stored procedures so we
saw how to write a before insert trigger
you can see it here
next
we learned how to delete a trigger we
also saw how to work with views in SQL
so views are basically virtual tables
that you can create from existing tables
we also saw how you can use views using
two different tables and an inner join
and
we learned how to display views how to
rename
view names
how to delete a view and finally we
explored a few Windows function
if you're an aspiring data engineer
looking for online training and
graduating from the best universities or
a professional who Alex to switch
careers with data engineering by
learning from the experts and try giving
a short to Simply launch data
engineering postgraduate program from
Purdue University in collaboration with
IBM the link in the description box and
the print comment should take you to the
program being offered injection so let's
begin with what is SQL injection
as the name suggests SQL injection
vulnerability allows an attacker to
inject Mauritius input into a SQL
statement so SQL stands for structured
query language which is a language used
by an application to interact with the
database now normally this attack is
targeted towards a database to extract
the data that is stored within however
the vulnerability does not lie in the
database itself the vulnerability will
always lie in the application
it is the developer's prerogative of how
to develop the application how to
configure it to prevent SQL injection
queries from happening a database is
created to answer questions and if a
question is asked it is supposed to
answer it database needs to be
configured for some amount of security
but the vulnerability the flaw here for
SQL injection will always lie in the
application itself it does how the
application interacts with the database
that needs to be modified that needs to
be maintained by the developer rather
than just configuring the database
itself so the attacker at this point in
time when they send a query to the
application will form a malformed query
by injecting a particular command or an
operator that is recognized by the SQL
language and if that operator is passed
through the application to the database
then the database basically gets cracked
or does a data dump because of that
unwanted character coming in so this
character needs to be filtered at the
application Level itself now let's look
at a quick demo so what we have done
here is I have this virtual machine
called ovasp broken web applications
virtual machine version 1.2 I'm going to
power this on
till this power is on I'm going to show
you where we can download this utility
from so you can just
look for ovasp broken web application
project download you'll find it on
sourceforce.net click on the link
you can download the broken web
application project from here this is a
1.9 GB download and you can have a zip
machine directly for VMware or every
Oracle virtual box
now this is an application that has been
developed by ovasp which stands for open
web application security project which
is a not-for-profit organization and
periodically releases the most top 10
risks that an application uh will face
for that particular year
so they have given a web application
with inbuilt vulnerabilities for
professionals like us to practice upon
to developables our skills upon because
doing this in the real world is illegal
I cannot go onto a website to
demonstrate how a SQL injection attack
works
uh neither should you try your hands on
it till you become very well rehearsed
with it so till to upgrade your skills
to upskill yourself please download this
machine host it in a VMware Workstation
or a Oracle virtual box and you can uh
then try your skills on it right so just
going back to the browser here if I open
up uh a new tab you'll see that this
machine has booted up and has an IP
address called 71.132 so if I just go on
to that IP address and I type in 192 168
71.132
and you'll see the OS Brooklyn web
application project and there are a lot
of training applications realistic
intentionally vulnerable applications
old versions of real applications and so
on so forth so there is a lot of
applications in built over here that you
can try your skills upon we are going to
try to use the ovas mutility over here
uh this gives you the uh OS top 10 risks
for 2010 2013 2017 is the latest one so
far uh but the difference between 2013
and 2017 is that some of these have
changed but not all of them the order
has changed a little bit but you can see
that SQL injection is on the top A1
amongst the injection attacks right and
you can see there are multiple types
that have been given here the SQL
injection for extracting data or SQL
injection for bypass authentication or
insert your injection
attacks blind SQL injection and then
there is a tool called SQL map which is
available freely on on your Linux
machines Carly Linux or parrot Linux
whichever you want to use uh for your
practice targets and so on so forth so
if I just take you here for bypass
Authentication
and this is a regular login page that an
application may have right you look at a
username you look at password you type
that in and you log in so let's say I
don't know a password here I'm just
going to type in the username test
password as
psswrd I'll try to log in and it shows
me that the account does not exist so
the authentication mechanism does work I
did try type in a username and password
it wasn't recognized so the account does
not exist now let's try to type in a SQL
query here I'm going to just give it a
single quote which is an operator that
is recognized by the SQL language which
when the database tries to execute uh
will cause the database to dump some
data or to bypass authentication in this
case and I'm going to give it a
condition single quote
or one equals one space hyphen hyphen
space and I'm going to click on login
now right now I'm not logged in at all
and we tried our username and password
and we weren't able to log in so now if
I log in you will see that it gives me a
status update saying the user has been
authenticated and I'm logged in as admin
got root so that is what these SQL
queries can achieve I'm going to log out
right now and we're going to look at the
basics of SQL injection so looking at
that small demo looking now let's look
at what types of secret injections are
available so the first is inbound SQL
injection the there are two subtypes
within in band error based injection
attack and a union based injection
attack the second type is blind SQL
injection attack where there's a Boolean
based and a time-based attack and the
third one is out of bound SQL injection
attack now what is Advanced SQL
injection attack in bandage where we are
either attempting the error base or the
union base what is error based uh we
send a query to the database we craft a
query to the database and uh it
generates an error message and it dumps
the error message right in front of us
on the screen that makes us realize that
there is a flaw and there there is some
information that is dumped on the screen
which we can then further utilize to
craft our further queries as we go ahead
whereas Union base is the it is where we
combine multiple statements at the same
time so if you look at the URL earlier
in the URL you would see a large
structure in that URL uh we can try to
add more two or more statements within
the URL itself to combine them and then
confuse the database into executing both
the statements together and giving a
data dump at the same time right so what
would a error based uh SQL injection
look like if I go back to the same
database uh which is here right and if
you remember the username we gave it a
single code or one equals one space
hyphen hyphen space we gave it the
condition right so basically what it did
was this a single quote is an operator
that goes to the database selects the
default uh table in the user tables in
this database column and then Compares
it to the condition that is given so the
condition that we gave was is one equals
1 which is always true so what it did
was it selected the default user table
that was available in the database and
instead of comparing it to a password it
compared it to the condition so if I
give it 1 equals 2 where the condition
is false and if I log in you will see
that the account doesn't exist comes
back again because the condition was
false and instead of comparing the user
account to the password it basically
compared the user account to the
condition so if I give it a single quote
or 1 equals one hyphen iPhone space
and login you can see that this is a
correct condition and thus we are able
to log in now before we even go to that
extent if I just forget the condition
over here and just give it a single
quote the operator and I send this
operator to the database and I click on
login you will see that it generates an
error which is right on top and it tells
us the line the file where the error
happened and you can see it happened in
the MySQL handler.php file right and
then it gives us the message you have an
error in your SQL syntax check the
manual that corresponds to yours MySQL
server version for the right syntax to
use now why would a hacker want to do
this in the first place because there
are different types of databases so
there is a MySQL Ms SQL or Microsoft SQL
Oracle SQL IBM db2 all of these are
variations of the SQL database uh they
use the SQL language however every
database has its own Command right there
they have their own syntax they have
their own uh specific commands that are
utilized for the database so in this
scenario the hacker wants to identify
what database is being currently
utilized so they can craft those
particular queries so now with this
injection with just me sending the quote
and the error getting generated I now
come to know that we are using a MySQL
server and the version of that server is
5.1.73 and the rest of the information
about uh where the handlers are located
and so on so forth
right this gives the information to the
hacker of how they want to proceed next
what kind of queries they want to create
what kind of syntax they want to utilize
so error base attack is where you
generate these kind of Errors uh and you
get this information the union base is
where you craft your queries within the
URL or you can try to combine multiple
statements within the input fields and
try to generate a response from that
when we come to Boolean based SQL
injection uh sends a SQL query to the
database which forces the application to
return a different wizard depending on
whether the query runs it true or a
false result so basically if the input
is false the input both the inputs are
false the output would be false there's
one input that is false the other input
that is true input B the output would be
true and so on so forth right so
depending on the result from the inputs
the attacker will come to know which
input is true with this you can then
access the database of the website so
you're trying to figure out by sending
out multiple inputs and then analyzing
the output to see what exactly which
command exactly worked what was the
resultant output of that command thus
from this kind of an information the
hacker can infer their next step forward
then you have time based SQL injections
uh now there are times when a database
administrator and application
administrator has done some security
configuration and thus have disabled
verbose error messages now what is a
verbose error message the error message
that we saw right here
is a verbose error message that means
that the message gives out details the
message gives out details about what the
database is the version and whatnot so
if
they have sanitized these errors
and you no longer can generate these
errors and thus you cannot figure out
what database is then what do you do
right for example if I just take you to
Simply learn
foreign
take you to a URL that is supposedly not
accessible you can see that it gives a
generic error oops like it looks like
you have crash landed on Mars it doesn't
give you a verbose error that we saw
here so this gives us a detail error of
what went wrong where it gives us the
database the version of the database and
where the query went wrong and etc etc
etc whereas on this side where there's
some there's a lot of security that goes
in here so you can see that it doesn't
generate a error it just get a generic
page in front of you so in that case
what does a hacker do so the hacker then
injects a time-based query in the URL
which allows us to verify whether the
command is being executed or not so we
put in a Time weight
let's say 10 seconds of time wait so if
we the moment we inject the query if the
query times for 10 seconds and then gets
executed that means that the SQL
injection is possible however
if we inject the query and it just gets
executed without the delay that means
that the time uh injection attack would
not be uh possible on that particular
site out of bound is not a very common
attack it depends on the features being
enabled on the database management
system that has been used by the web
application so this can be a somewhat of
a misconfiguration error by the database
administrator where you have enabled
functions and not sanitize them so you
have not done in access controls
properly you have not given account
control so queries should never be
executed at an administrative level they
should always be executed a user level
with minimum privileges that are
required for that query to be executed
now if you're allowing these kind of
functions
to be to be enabled at the dbms and
there is an administrative account that
can have access to them at that point in
time and out of bound injection attack
is possible so let's look at how our
website works right uh how SQL works on
a website now the website is constructed
of HTML hypertext markup language which
would include JavaScript for
functionality cascading style sheets for
the mapping of the website right and
then the react.js and whatnot uh for for
the functionality now when we send a
query to the website it is normally
using the HTTP protocol or https
protocol when the query reaches the
application the application would then
go ahead and generate the SQL query uh
at the client side you'll have all these
scripting languages coming in on the
front end that we can utilize to craft
queries and then send them across at the
server side you will have uh databases
like Oracle MySQL MSC well and so on so
forth that will then execute those
queries right so just to give you an
example if I use a tool called Postman
what we generally do when we craft a
query is we send out a get request
to the website and then we'll see a
response from the site with the HTML
code and everything so this is a tool
that is utilized by software testers to
test the responses that you're going to
get from various websites so yeah on the
left hand side you can see I've used it
on quite a bit uh here we have an
example for gmail.com so let's continue
with that so this is a get request being
sent to Gmail the moment I send it is
going to create an HTTP request and send
it across the response that I get is
this this is the HTML code for gmail.com
right these are the cookies these are
the headers that include information so
it you can see this is a text HTML
character set utilized is utf-8 and the
configuration that has been done with
the application right so this is where
uh everything comes in this is the
cookie that has been sent with that
particular request that I had sent out
now if we Analyze This query right so
when we went on to this application and
I in that single quote and we generated
this error right you can see that the
application converted this into a SQL
query so the query was select username
from accounts where the username in
quote single quotes and we use the
support right the single quote right
there so uh that's where we use that
operator and that's where the exception
error occurred so these are the kind of
queries that are structured by the
application and then taken on to the
database for execution when we type in
uh it is a HTTP get request with the
username and password within that query
that is sent to the application the
application converts it into a SQL query
sends it to the database and the
database responds with the appropriate
response so how do we prevent SQL
injection in the first place
use prepared statement and parameterized
queries these statements make sure that
the parameters pass in the SQL
statements are treated in a safe manner
so for example we saw that the single
code was an operator
this shouldn't be allowed to be utilized
in the first place right so here what we
are doing here is a secure way of
running a SQL query in the jdbc using a
parameterized statement Define which
user we want to find so there's a string
the email comes in connection to the
database we are going to figure out how
the connection is going to be passed how
it is going to be created construct the
SQL statement we want to run specifying
the parameter right so we Define how is
it going to be uh created what is going
to be created what can be passed to the
database and what should not be passed
to the database
so that is one way of utilizing prepaid
statements and parameterized queries
where we have object relational mapping
most development teams prefer to use
objection object relational mapping
Frameworks to evade the translation of
SQL results set into code objects more
seamless so this is an example of object
relational mapping
where we map certain objects
and allow that to be executed and then
escaping inputs in a simple way to
protect against most SQL injection
attacks many languages have standard
functions to achieve this right so you
need to be very careful while using
Escape characters in your code base when
a SQL statement is constructed not all
injection attacks rely on abuse of quote
characters so you need to know what
characters are being utilized in the
configuration that you have created in
the structure that you have created in
the code that you have created
uh which characters are being recognized
as operators you need to sanitize those
operators and you need to uh basically
ensure that these operators cannot be
accepted as user input if they are
they're feeded out by the application
and they never reach the database other
methods of preventing SQL injection are
password hashing so that passwords
cannot be bypassed the passwords cannot
be recovered passwords cannot be cracked
uh third-party authentication you use
oauth or some other service for a single
sign-on mechanism does you rely on a
third party
to maintain the security of
authentication and what kind of
parameters are passed for example uh
using LinkedIn logins or Facebook logins
right for the Layman you normally go on
to Facebook and you allow if you're
using a game right if you start playing
a game you're allowed to log into the
game using your Facebook credentials or
your Google credentials now that is not
just for ease of use but the game user
the developer has outsourced the
authentication mechanisms to third
parties such as Facebook or Google
because they understand that that
authentication mechanism is as safe as
can be Facebook and Google are wealthy
organizations uh hire a lot of Security
Experts and the development for their
authentication mechanisms is Top Notch
small organization cannot spend that
kind of money on security itself right
so you use a third party authentication
mechanism to ensure that these kind of
attacks may not happen then web
application firewalls uh having a web
application firewall and configuring it
properly uh for SQL injection attacks is
one of the Sure Shot method of
mitigating or minimizing the uh threat
in the first place so at this point in
time you have realized that the
application has some vulnerabilities for
SQL injection and instead of recoding or
restructuring the application uh you
want to take the easier way out or the
cheaper way out so what you do is you
you install a web application firewall
and you configure the web application
firewall to identify malicious queries
and stop them at the firewall level
itself so they never reach the
application and thus the vulnerabilities
on the application don't get executed
buy better software
and I'll keep on updating the software
so it's not necessary that once you have
a software you install it it's going to
be safe for Life new vulnerabilities are
discovered every day every hour and it
may so happen what is secure today
may be completely insecure tomorrow or
the day after right so you need to keep
on upgrading the software if there are
no upgrades available and the
vulnerability still exist you might want
to migrate to a better software and does
ensure that you don't get hacked right
always update and use patches
organizations keep on sending out
updates and patches as and when they are
released you need to install them to
enhance your security postures and then
continuously monitor SQL statements and
databases use protocol monitors uh use
different softwares use the firewalls to
keep on monitoring what kind of queries
you're getting and based on those
queries you want to ensure the inputs
and the queries that are creating uh are
not detrimental to the health of the
software that you have so the key
takeaways that we have seen here in a
nutshell are what is a SQL injection
attack we have seen the types of SQL
injection attack how the how it works
and how to prevent SQL injection attack
now we have done a couple of demos
firstly let us understand what is SQL
SQL as it stand is defined as structure
query language is basically a
standardized programming language that
is used to manage databases and it
performs various operations on data in
them initially created in 1970s SQL is
widely used by many companies and
Technologies nowadays
SQL is used for modifying database
tables and index structures it is also
used in adding updating and deleting
rows of data it is also used to retrieve
subsets of information from within the
database management system
now SQL is used to perform various
actions such as to insert data to update
data modify and delete the data in the
database as well
now when we talk about SQL it is
important that we talk about relational
database systems as well a relational
database system or RDM rdbms is a
database system that stores and fetches
data in the form of table that is in the
form of rows and columns tables are used
to store data in relational databases
about related objects each column
contains attributes of data whereas each
row holds a record of unique data known
as a key which helps in making
relationship between different data
points that is present in different
table which makes us easy to understand
now these relational databases or rdbms
are managed using SQL language
to perform various operations therefore
SQL codes are used to retrieve
information from these relational
databases by doing various interactive
operations like using join create
truncate delete alter and Etc
let us now look at some popular SQL
databases some popular SQL databases
that are available are MySQL Oracle
database Microsoft SQL
server SQL Lite and post gray SQL
now that we have understood what is SQL
let us now understand what is nosql
nosql database is a non-relational
database management system that does not
require a fixed schema that is the data
store is not stored in the form of
tables in nosql databases
basically it avoids any uh joining or
creating or scaling the databases in SQL
the major purpose of using a noise scale
database is for distributed data storage
which is having high volumes of data
storage needs nosql is used for big data
and real-time web applications like for
example companies like Amazon Facebook
Google correct terabytes of users data
and every single day
so basically nosql database stands for
not only SQL or not SQL and it is
introduced in the year 1998 by Karl
Strauss a traditional rdbms uses SQL
syntax to store and retrieve data for
further insights now instead a nosql
database system encompasses a wide range
of database technologies that can store
structured semi-structured as well as
unstructured data
let us now understand why we use nosql
we use hierarchical storage structure
instead of a table like structure
that means before relational databases
companies used a hierarchical database
system which with a tree-like structure
for database tables now these early
database Management Systems enable users
to organize large quantities of data
however they were complex often required
a particular application and in a
limited way which they could uncover the
data that is stored now these
limitations eventually led to the
development of relational database that
is the data that is stored in tables uh
so a skill provided an interface to
interact with relational data and
allowing the analyst to connect Tables
by merging on common fields But as time
passed the demand for faster and more
desperate usage of larger data sets
became increasingly more important for
emerging Technologies for e-commerce and
other big giants for that nosql has
became the alternative for everyone
now another reason is it is now we have
constant addition of new features and
functions in the nosql database right
so that means like we know that
technology is being rapidly evolved and
huge enormous amounts of data has been
released on a daily basis and it's
important that we store this data and
access in a quick way now no SQL is the
best database to use for large amounts
of data or forever changing data sets it
is also best use when you have to have
flexible data model or need that don't
fit into a relational model
and finally when if if you want that
there is no relationship between any
stored data and the field is not
important then you can use nosql as well
let us now look at some popular nosql
databases some popular musical databases
are mongodb Apache hbase Cassandra redis
neo4j and Etc
let us now look at some types of nosql
databases that are present firstly we
have document oriented the document
database typically stores
self-describing Json XML and bson
documents they are similar to key value
stores but in this case a value is a
single document that stores all the data
to related to a specific key popular
fields in the document can be indexed to
provide faster retrieval without knowing
the key as well each document can have
same or different data structure
mongodb couchdb cloudant are some
examples of document based uh nosql
database next we have key value pair
database the data in this is stored like
a key value pairs key value pair data
stored in database in the form of a hash
table each key is unique in this case
the value stored may be an integer
string a binary object a Json object Etc
the key Value Store based database is
simplest database among all the data
databases in nosql database
redis coherents are examples of some key
Value Store databases
next we have column based or column
store database in nosql which is in this
the data stored in grouped columns
instead of rows every column values are
stored separately it delivers high
performance on aggregate functions like
count sum Max minimum group of columns
are data stored in key spaces like
schema and rdbms these faces contains
group of rows of columns
and hbase bigtable aquilomo are some
examples of column store databases
and finally we have graph oriented or
graph store databases data in this is
represented in the form of a directed
graph it consists of nodes and edges
nodes represent an entity and any Edge
represents the relation between the two
nodes node H to be unique social
networks Logistics paytl data used uh
graphical storage database neo4j
infinite graph Orient DB flock DB are
examples of some graph storage database
next let us understand how exactly nosql
database works for that I am going to
take the example of mongodb database now
mongodb is based on the nosql document
store model in which data objects has
stored as separate documents inside a
collection instead of a traditional
column and row of a relational database
now uh mongodb groups data through
Collections and basically a collection
is simply a grouping of documents that
have a same or similar purpose a
collection acts similarly to a table in
a traditional SQL database however it
has a major difference a collection is
not enforced by a strict schema that is
it does not have any fixed schema at all
instead documents in a collection can
have slightly different structure from
another as needed this reduces the need
to break items in a document into
several different tables at as it is
often done in an SQL implementation now
coming to document a document is a
representation of a single entity of a
data in mongodb database a collection
consists of one or more related objects
major difference that exist between
mongodb and SQL in that documents are
different from rows row data is flat
with one column for each value in the
row however in mongodb documents can
contain embedded sub-documents providing
a much closer inherent data model for
your applications now if I just have to
map what are exactly and how it is
different from rdbms a collection in a
mongodb is equivalent to the tables in
rdbms and a document in mongodb is
equivalent to the rows in rdbms and
Fields in mongodb is equivalent to the
columns in rdbms
so this is how a document looks uh in a
mongodb as you can see this is similar
to a row in rdbms but we just have a
field and a value that is taken
separately instead of a tabular value
and another important thing to note here
is that a mongodb supports Dynamic
schema which means one document of a
collection can have a number of fields
while the other document can have less
or same number of fields that is if a
collection can have four Fields while
other document can have only just two
fields which is basically not possible
in a relational database which does not
exist it does not support because it
needs a particular and a fixed schema in
that if getting your learning started is
half the battle what if you could do
that for free visit scale up by simply
learn click on the link in the
description to know more
let us now understand some differences
between the SQL and nosql firstly SQL is
a relational database and nosql is a
non-relational database that means SQL
databases are in the form of tables that
can contain rows and columns and they
have fixed logical schema design all the
data in SQL is arranged in tabular
format and it is well suited for complex
queries and on the other hand nosql
databases is a non-relational database
that means it does not store data in the
form of tables and contains Collections
and inside every collection there is a
document that contains the data of a
single entry this data is stored in the
form of a key value pair unlike SQL
where we store data under the fixed
schema
so as we discussed uh SQL has a fixed
schema design and structure and nosql
has a dynamic schema design and
structure
SQL can handle complex queries whereas
nosql can handle large volumes of data
now SQL is vertically scalable
now uh SQL databases support vertical
scaling which means it improves the
single server by increasing Ram SSD or
CPU in vertical scaling we are
restricted to a signal system and we can
improve it as much as we want till the
Practical limit whereas a nosql database
we can do horizontal scaling because
they support distributed computing or
distributed systems in horizontal
scaling we can add another node or
competitor for better performance and we
can add in number of such servers or
nodes as per a requirement so as
discussed we can add as many as nodes as
we want and this is why we prefer nosql
for high scalability because there is no
limit for scaling
and finally it follows acid properties
that is atomicity that means transaction
should be performed at once or it
shouldn't happen at all consistency that
means the state of a database should
remain consistent before and after the
transaction isolation one transaction
shouldn't affect another transaction and
should be independent and we lastly
durability now successful transaction
should be reflected even if there is any
system failure whereas the noise skill
follows cap property
that is consistency availability and
partial tolerance
let us now discuss some advantages and
disadvantages of using nosql firstly let
us discuss about the advantages
nosql provides high performance and
scalability and it also has a lot of
availability and flexibility it is open
source and it is schema less as well
that is you can directly uh download the
nosql databases from the internet unlike
some commercial databases that are
available in the internet
while on the other hand there are some
disadvantages as well that is it lacks
the standardization that means it does
not have a fixed query in order to
retrieve data from the databases which
result in consistency issues and since
it has all these consistency issues and
does not retrieve data properly it has a
limited query capabilities
so that brings us to the end of today's
session on SQL versus no SQL guys so you
might have a doubt that when you need to
use SQL and when we need to use nosql
now SQL is easiest to work with
relational databases that is it is
useful when you want to perform complex
queries using various operations like
join and Etc and if you want to perform
quick data storage and retrieval
operations you can use SQL whereas you
can use nosql if you are designing a
distributed systems and if you want a
hierarchical storage structure instead
of a tabular like structure also nosql
gives you the flexibility to create
Dynamic structures and can add features
as you as you want also there is no
asset properties during the creation of
any applications while creating nosql
databases as well if an aspiring data
engineer looking for online training and
graduating from the best universities or
a professional who Alex to switch
careers with data engineering by
learning from the experts then try
giving a shot to Simply learns data
engineering post-graduate program from
Purdue University in collaboration with
IBM the link in the description box and
the pin comment should take you to the
program being offered so let's get
started with the first question
so the first question is to State the
difference between where and having
clause in SQL
now wherein having a very widely used in
SQL to solve specific problems
now let's look at the difference one by
one
so where Clause is used to filter the
records from the table based on the
specified condition and can be used
without the group by clause on the other
hand having Clause is used to filter the
records from groups based on specified
conditions
now where Clauses cannot have aggregate
functions so you cannot use some count
average Min and maximum functions in the
where clause while in the having Clause
you can operate on aggregate functions
and those aggregate functions are used
to filter values from a group
now where Clause is implemented on rows
or at row level
so for each row of data you have the
WHERE condition applied
having Clauses are implemented on
columns so for each column of data you
have the having condition applied
now another important difference between
where and having is that the where
Clause is executed before the execution
of the group by clause and after the
execution of the from clause
on the other hand the having Clause is
executed after groups are created now we
will learn more about where and having
and understand the usage better when we
tackle practical problems in this video
now moving to our next question which is
how is drop different from truncate
so drop and truncate are two different
commands
so drop command is used to drop the
whole table removing the table
definition and its contents while
truncate deletes all the rows from the
table
now we can drop the whole table
structure in one go so the view of the
table does not exist by using the
truncate command the existence of all
the rows in the table is lost but the
view in the table exists
now Integrity constraints will be
removed in drop command while the
Integrity constraints will not be
removed when you use the truncate
command
now moving to our third question now
this is a practical question so we will
be using a
table which is present in my mySQL
database so the table name is called
employees and I want to find the lowest
salary of the employees in each
department
you can see here this is how my employee
stable looks and
the output query would be something like
this so here since I want to find the
lowest salary of the employees so I am
using a Min function to find the lowest
salary in the table and then I am
grouping
all the employees and the results by
department so let's do this on MySQL
workbench
okay so here I am on my MySQL workbench
first let me go ahead and create a new
SQL script so I'll click on this
and that will create a new script okay
so here we'll write our commands
all right
so
our question was to
find the
lowest salary
for each department
okay so I've given my comment to make my
commands and whatever I am doing more
readable
so
first before I proceed
I need to
select my database so I'm going to use
my SQL underscore into database
so I'll write use SQL underscore intro
now this database has a lot of tables
that we'll be using in this
interview questions
video I'll run it okay
we are in our SQL intro database now
there is a table called
employees let me show you the table
first
if I write select start from employees
okay so here you can see this is the
table I'm talking about
now these are the
rows that are present in the table we
have 20 rows and here you can see the
different columns we have the employee
ID employee name e gender
we have the department City and salary
now there's the same table that we have
also used
in our other videos that are already
Live on YouTube okay
so
let's solve our question to find the
lowest salary for each department now
for that
I'll write select
I'll select my department column which
is Dept
comma and then
to calculate the lowest salary or to
find the lowest salary I'm going to use
the Min function so that will return the
minimum salary
present in the salary column so I'll
write Min salary as I'm giving an alias
name as let's say
lowest
underscore salary
from
my table name that is employees
then I'll write
Group by
Department
now I am grouping it by Department
because we want to find the lowest
salary of the employees in each
department
now let's run and see the result
there you go
I'll just
move it to the top so that you can see
the results clearly
okay so here we have total seven
departments you can see at the bottom
and
in these seven departments you can see
in sales 70 000 let's say dollars was
the lowest salary in marketing we had
fifty five thousand dollars as the
lowest salary similarly if I scroll down
we have other departments like Tech it
finance and HR so
these are the lowest salary
in each department
all right
now moving to our next question
so our fourth question is which query
will help you fetch unique values from a
column in a table
so this is a multiple choice question
which is another type of question that
is often asked in the SQL interviews
now we have multiple queries here and
you need to choose the right query that
will solve our problem
so since I want to
get the unique values from a column in a
table
so the right option would be to use the
distinct keyword in the query so if I
write select distinct followed by the
column name let's say you want to find
the distinct cities or the distinct
departments in the employees table so
the query would be select distinct City
or let's say Department from the table
name that is employees
hence this is the right option if you
want to find any unique values from a
column
now moving to the
fifth question
the fifth question says
it is actually a similar question here
we want to write the SQL query to fetch
unique departments from the employees
table
so as we saw this is our employees table
and if you want to find the unique
departments from the employees table you
can just write select distinct Then
followed by the column name
which is departments here so Dept from
employees let's
do this on our MySQL workbench
okay so let me just scroll down
and I'll
give a comment here
that is we want to find the unique
departments
so the query would be select
then I'll use the distinct keyword if I
hit tab it will auto complete
then I have my column that is Department
from
my table name that is employees
if I run this
the query will give us
the unique departments that are present
in the table so here we have total seven
unique departments in the table you can
see here we have sales marketing product
ID
finance and HR
but
if you see our original table which is
the employees table
so there are total
20 records and if you see the department
column there are
multiple departments to which each of
these employees belong to
okay
now moving ahead
now the sixth question is to write an
SQL query to fetch the unique values of
departments and print their length now
this question consists of two parts
first we need to fetch the unique values
of departments that we saw in our fifth
question
and then we want to print the length of
each of the Departments so for that I am
using the distant keyboard to find the
unit departments and then I'm using the
inbuilt length function that is present
in MySQL to find the length of the
department and then I am using an alias
that is length underscore Department
from employees so let's say this on our
workbench
okay so let me
give a comment
I'll say unique
departments and length
okay so the query would be I'll write
select
distinct
Department
and then
let me just scroll down
and give a comma
and use my inbuilt length function see
I'm hitting tab to autocomplete and
inside the length function I'll give my
column name that is Department
I'll give an alias as
Department underscore
length
from my table that is employees this is
pretty simple so first I am finding the
unique departments and then using the
length function I am finding the length
of each department let's run and see
okay you can see the result here so
sales the length is 5 marketing the
length of marketing is nine so basically
you're counting the number of characters
that are present in
each of the Departments so in sales
there are total five characters in
marketing there are total nine
characters in product there are total
seven characters in it we have just two
letters int so hence the length is 2
similarly finances 7 and HR is two
because we have just two letters H and R
okay so this is another variation of
using distinct along with
any inbuilt function
all right
now moving to the seventh question
the question is what is the use of DT
function in SQL
now date div
Returns the number of days between two
date or date time or time stamp values
so D diff is another
crucial inbuilt function that is present
in MySQL
so here is how you can use the DD
function so it will return the number of
days between two dates or date time or
timestamp values so here I have two date
values that is
10th of
April 2021 and I have
30th of March 2021
so this query will give us the total
number of days that lie between these
two dates and similarly
here is another example of using the
date div function so I want to calculate
the total number of days there are
present between today's date so I am
using the Now function and between
20th of April 2021
so let's do this demo on the workbench
all right first I'll give a comment
saying
DD function
okay
now the way to use this I'll write
select
and then
you can see here once I type date
MySQL workbench is automatically
suggesting some of the inbuilt functions
I am going to use date div
and within D div I'm going to pass in
two values so I'm passing into date
values let's say 2021
April
so I'll write 0 4 and let's say
10th of April
I'll give another comma
and I'll pass in my second date value
that is going to be
30th of
March 2021
all right
now another thing to note here is the
date value should be present inside
quotations
if you want you can give an alias as
well
I'll write as total T's
let's run it
there you go it has given us the output
as 10 so there are total 10 D's between
31st of March
2 10th of April
now let's see another example I'll write
select
date div
and we'll pass in
my Now function so the Now function
Returns the
current date that is today's date
and I'll give another date value let's
say
2021
April 20th
now we'll see the results if you want
you can give an alias name so that the
output is more readable here
I'll run it okay so between
today's date and
my previous date that was 20th of
April there are total 49 days
so today's date is actually 8th of June
so between 20th of April and 8th of June
there are total 49 days
all right
now moving ahead
now in the eighth question we want to
write an SQL query to display the
Departments that have more than two
employees
so this is our employees table that we
have been using and here is how the
command looks like so here we are using
both Group by and having
now I am grouping by Department because
I want to display the Departments that
have more than two employees now for the
second filter I am using the count
function of the employee IDs and
checking if the employees
in each department are more than two or
not
let's do this
let me
move down a bit and I'll give a comment
departments with
more than
to employees
okay
now let's write our query
so I want to select
the department and then
I'm using the count function to count
the
employee IDs in each department or the
employees present in each department
from my table that is employees
I'm going to group by Department
and then I'll use having
my count of
employee ID
this should be greater than 2.
so
our query will return only those
departments which have more than two
employees
let's run and see
there you go so we have total four
departments that is sales product Tech
and it
where we have more than
two employees you can see here sales has
four employees product has three Tech
has four
and it has three the rest of the
Departments like Finance HR and others
have less than two employees
now if you want you can give an alias as
well
let's see as total employees
okay
let me run it again
and here you can see I have the column
name as total employees
okay
so moving ahead
the ninth question we want to display
the details of the employees for all the
Departments except marketing
now here I have my employees table now
if I were to display all the details of
the employees apart from
marketing department
I can give a condition like where
Department
not equal to marketing so this is the
way how you write not equal to so you
use the less than and greater than
symbol another way to do is use the
exclamation mark and give equal to so
this means
select all the employees where
department is not equal to marketing now
let's do this
I'll move down a bit
and will give a comment as
details of employees apart from
marketing
so the query would be select
star from employees
I'm using star because I want to display
all the details that means I want to
display all the columns
then I am going to use my where
condition where
Department
not equal to
marketing
I'll put marketing under
quotes
let's run it and see the results
there you go so we have
total
18 rows of information
and if you see the department column we
have all the Departments apart from
marketing now if you remember
our employees table had total 20 rows of
information out of which two are missing
which means there were two employees who
were from marketing department and those
departments were not displaying
now
another way to do is
to use
exclamation mark and equal to
so this also means select all the
employees where department is not equal
to marketing let's run this you see here
it gives us the same result and has
returned us
18 rows of information
leaving apart
the employees from the marketing
department all right
now moving ahead
so our 10th question is to write an SQL
query to print the details of the
employees who have joined before
April 2010 and after May 2005.
so here is my employee stable
and this is my SQL query so here we are
using just a wear condition to filter
our results and
my condition is the employee should have
joined after May 2005 so I have written
after 31st of
May 2005 and before April 2010 which is
before
31st of March 2010. let's do this
I'll
give a comment here
we'll write
employees
joined
before
April
2010
[Music]
and
after
May 2005.
now let's write our SQL query so I'll
write select star from
employees
where
my date of join if you see here I have a
column called date of join which has the
details about the day on which the
employee had joined the company
so I'm going to write where date of join
is greater than
31st of
May
2005 so I'll write
2005
this is one of the formats to use
date values
so this is the year value this is the
month value and this is the D value
and
my date of join
should be
less than
31st of March 2010 so I'll write 2010
March 31st
I hope you are able to understand this
date of join greater than 31st of May
2005 means
after May 2005 and date of joined less
than
31st of March
2010 this means employees joined before
2010 April
let's run it
okay so we have total three employees in
our table you can see the date of join
and all of them have joined
after May 2005 and before April 2010.
okay
now moving ahead to the 11th question
so here we want to find the employee
with the third highest salary from the
table
so I have my employees table here and my
command would look something like this
so here we are going to explore how to
write sub queries in SQL so I'm using
the sub query here where I am trying to
find
the employees who have the
top three salaries or the top three
employees who have the highest salaries
and from that I am going to filter out
my third highest salary employee so
let's do it on our workbench okay so
I'll come down and let me give a comment
as
third highest salary
okay
so
let me first write down my SQL query and
then I'll explain so I'll write select
star from
after that I'll start a bracket and
write my inner query so I'll write
select star from
employees
order by
salary
descending
then I'll use my limit keyword
and I'll write limit three
as I'll give an alias name let's say t
and then
I am
again going to use
my order by
salary
limit
one
okay now let me explain you the flow so
first let me run the inner query I'll
select my inner query
and I'll run it
so the inner query returns
my top three employees who have the
highest salary and this is ordered in
descending order since I used salary
descending
now let me just
use this okay now you can see it clearly
so these are my top three employees who
have the highest salary so Joseph has
the
maximum salary followed by Angela and
then we have Jack now from this I want
to return only
the record for Jack because Jack is the
employee
who owns the third highest salary so for
that
I am going to
use the result returned by my sub query
or the inner query and on top of this I
am going to order the salary and say
limit equal to 1 so I'm again ordering
this salary in ascending order so what
will happen Jack will appear at the top
Angela will be at the second place and
Joseph will come to the third place and
from there I am using limit one so that
I can only get
the record for Jack
now if I run the entire query you see
the result I have my
employee name as Jack who owns the third
highest salary
okay
now moving ahead to the 12th question
the question is to print all the
alternate records in a table so here is
my employees table and from this table I
am going to print all the alternate
records for example I am going to print
the my employee id101 then I am going to
skip 102 and print 103 followed by one
zero five one zero
7109 so all the employee IDs that have
an odd value
and you can look at this example in
another way of displaying the employees
which have an employee ID
of even numbers so 102 104 106 and so on
now the way to do is
either you can use a simple select
clause and say employee ID
percentage or modulus 2 equal to 0 which
means I want to filter only those
employees which have an even employee ID
else
what you can do is you can use a CTE as
you can see here
so CTE or the Common Table expression is
a temporary named result set that you
can reference within a select insert
update or delete statement now it is
used to simplify complex joints and sub
queries and to provide a means to query
hierarchical data now let's write this
query on our workbench and see how it
works
so before that let me explain you I am
using a few
new functions such as row number this
will create a row number for each of the
rows or the records present in my table
and then from this CTE I am going to use
my filter clause or the where clause
where RN which is row number percentage
2 equal to equal to 1 so this will
return
only the odd records from the table
let's see how to do it
okay
so
I'll give a comment
print
alternate
records
okay
now I'll start with my
simple query which is Select star from
employees
where
let's say I want to find only the even
employee IDs
or the employees who have an even
employee ID
so I can use employee ID
percentage 2 equal to 0 so it has to be
a perfect division
and the result should be 0 only then I
can get only the
even employees if I run this okay there
was an error here it should be employees
I'll run it again
you can see here I have printed the
alternate records in a table so we have
skipped one zero one because it is not
divisible by two
I've started with 102 followed by one
zero four one zero six one zero eight
and then finally we have
one two zero or 120.
now if you want
to print only the
odd records in the table you can use
employee ID percentage two equal to 1 so
you can see here I have one zero one one
zero three one zero five one zero seven
up to one one nine
now the best way to do this is
to use a Common Table expression of CTE
so I'll start with
my command that is with CTE
as
start with my bracket Android select
star
comma
then I'm going to use my row number
function
so I'll write
row number
then
I'll write over
then I'll use order by
employee ID
so this
row number for each of the rows is going
to be created over my employee ID column
and that is sorted in ascending order
I'll give an alias as RN which stands
for row number
from
my table that is
employees
I'll scroll down
and then I'm going to
close my bracket
I'll write select
let me remove the space here
okay and let's select start from
CTE
where
my
row number
percentage 2 equal to 1.
now
let's see this from the top
so I have my commentable expression
where I am
going to create a
row number column named as RN and this
row number column is based on my
employee ID column which is sorted in
ascending order
and from that I am going to filter only
those row number values that are not
divisible by 2 or I am going to print
only the
odd records from the table so let's run
it and see the results there you go so
here if you Mark I have my row number
column created
and I am filtering only the odd records
in the table so it starts with 1 3 5 7
and goes up to 19. and similarly here
you can see the employee IDs the name
the E gender and other information
now if you were to print
the even records in the table
the alternate even records you can use
RN percentage 2 equal to 0. let's see
the difference
I'll run this
there you go so I have my even row
number starting from 2 which goes up to
20.
okay so this is how you can print
alternate records in a table
now moving to the next question
now in the 13th question we want to
write an SQL query to fetch all the
duplicate rows in a table now this is
another crucial interview question that
is often asked in most of the interviews
now I have a table which is named as
duplicate table and here you can see I
have some employee ID name and each and
a few records are duplicated for example
101 Sam 40 the first record is
duplicated and you can see here it has
the same
values
now if you mark 103 Mary and 28 is not
duplicated because
here the age is different so this is a
different person
then
compared to the Third
name that we have
so this is how you can find
the duplicate rules in a table so I'm
going to select my employee ID name and
each and then count
all the
employee IDs the names and each and
compare them with whether they are
greater than one or not so if they are
greater than 1
then
I'll see that particular record is
duplicated or is present more than one
time in the table
let's
do this
implementation on our workbench
okay so I'll come down
and let me give my comment as
duplicate records
okay
so
let me first
show you the records that are present in
my table so I'll write select
star from
dup underscore employees
I'll run it
okay you can see here I have my table
that we saw in the slides so
employee id101 with name Sam and each 40
is duplicated
so we want to find this duplicate record
the way to do is
I'll write
select
e underscore ID which is employee ID
comma name comma each
comma I'm going to count all of them
so I'll write count star
as
duplicate
count this is my Alias name
from
my table that is dop underscore
employees
I'll see
Group by
employee ID
name
and each
and then I'm going to use my having
Clause saying having
count of
employee ID
is greater than one
and
count of
name should also be greater than one
and
my count of each
should also be
greater than 1.
let's run it and see the results
okay there is some error here
the name of the table should be
employees
okay
let's run again
we have
our correct result that is employee
id101 with name Sam and h40 is
duplicated so the value is 2.
great now moving ahead
now the 14th question is a bit tricky
wherein we want to display the employees
with exactly two A's in their name so
you see here I have my
employee names and there are certain
employees who have just
two e's in their names so I want to find
those employees
only
now the way to do is
it is a bit tricky to understand I am
going to break it down and make you
understand
on my MySQL workbench so here you can
just have a glance I write select star
from employees where
I am finding the length of my employee
name and then subtracting
my length
wherein I have
replaced my employee name that has a
with a
blank
and if this subtraction is equal to 2
then that particular employee has two
A's in their names
so let me show this first
let me
first give my comment as
employees with
two
is okay
so first I'm going to write a select
statement
okay before that I'll show you
the records present in my table
okay
if you see here
Shane is one of the employees that has
just one e
in its name then we have Mary 1A doing
has one A but if you see Sarah Sarah has
2A
in the name so we want to extract Sarah
then Jack has one A again if you see
Angela Angela has 2A it doesn't matter
if it is
we just need to find
if the employees have two e's in their
name
and similarly if I scroll down let me
check if we have
any other employee with two A's in their
name Marcus has one David has one Sofia
has one
we also have Amelia that has two A's in
its name or in her name
and we also have Maya
okay
now
let me go ahead and write a SQL query
and then I'll explain you what I'm
trying to do I'll write select
I'm using the length function
and
in the length function
I am going to replace
then I'll use another function called
upper
on top of employee name
I'll write
e and then replace it with a blank it so
I'm using quotations to represent blank
from employees
okay
let's run this and see the results
you see here it has given us
the length
of the employee strings after
replacing all the E's with a blank
so here I am essentially converting my
employee names to upper case and I am
changing wherever there is an E I am
replacing that a with a blank
and then I am finding the length
so this trick I'm going to use
in my
final query so I'll write select star
from
employees
where
I'm going to do is
I'll bring this to the next line I'll
write
length of
employee name
minus
then I am going to use my above
condition
I'll
copy this
and I'll paste it here
and this value should be
2.
so what I'm doing is I am first finding
out the length of my employee name
from that
I'm subtracting
the length after replacing
the a is present in the employee name
with a blank and this value should be
equal to 2 the reason being we are only
trying to find the employees who have
two A's in the name
let's run and see the results
okay if you see here we have Sarah
Angela Emilia and Maya who have
two is in the name so you have Sarah
that has two a Angela has 2A Amelia has
two A's and then Maya also has 2A
okay
now moving ahead
now the 15th question is given a string
how will you extract four characters
starting from the second position
so I have my string here
which says Michael Ballack or Michael
Ballack you must be aware is a popular
footballer he's from Germany and also
was the captain of Germany so from the
string Michael Ballack I'm going to
extract four characters starting from
the second position
you can use to inbuilt mySQL functions
to
do this the first is called
substr wherein we pass in the string
then we
give the position from where we want to
extract the characters so here I am
going to extract from the second
position so hence 2 and then the number
of characters that you want to extract
which is four
the other way is to use the substring
function
which is again similar to the sub SDR
function in the substring function also
I am first passing in my input string
and then giving my starting position
which is 2 and then I want to extract
four characters from it let's do it I'll
give a comment
extract
strings
so here I am going to write select
first I'm going to use substr
which is my inbuilt function I'm going
to pass in my input string which says
Michael
Ballack
and then I'll give my starting position
which is 2 and then the number of
characters that is 4.
let's run it and see the results
you can see here it has given us icha so
if you see m is at the first position
from the second position onwards I
needed four characters so m c h and E
these are the four characters starting
from the second position similarly let
me just copy this
and instead of
sub Str I'm going to use the substring
function I'll write just ing that
becomes substring
let's select and run it
and this also Returns the same result
suppose you wanted to extract
from the fourth position
you wanted to extract let's say three
characters
let's see the results
it gives us H A and E if you see here
m is the first position I is at the
second position C is at the third
position H starts from the fourth
position
so H E and E are the next three
characters starting from the fourth
position
so hence this is the result
all right now moving ahead
now my 16th question is on how does self
join work
so self join joins a table to itself
so the table must contain a column X
that acts as the primary key and a
different column let's say y that stores
values that can be matched up with the
values in column X now this might not be
really easy to understand you'll get to
know once we do this demo so I have a
table which is called employee manager
so this is my table now let me tell you
how to interpret this table we have five
different employees starting from
employee id1 to employee id5
Gary Gibbs Smith Latham and Jimmy are
the different employees we have we have
their salaries and now you have
the employees reporting to which manager
now if you see here
Gary's manager
ID is three
so if you see a table at three we have
Smith so Gary is reporting to three
or in other words Smith has a employee
under him who is Gary similarly Gibbs is
reporting to manager id1 or employee id1
which is Gary so
Gibbs manager is Gary similarly if you
see for Smith Smith is reporting to the
person with manager id4 or employee id4
we have Latham so Latham has one
employee under him who is Smith
now lithium in our table has no managers
then we have Jimmy who's reporting to
the employee ID3 who is Smith okay
now I want to
use the stable and return the name of
the manager for each employee
to do that I am going to use my self
join so here I am using
a self join to join both the tables
here both the tables mean I'm using the
same table twice so I have written
select e dot employee ID e dot employee
name then we have e dot manager ID then
I am using another Alias for managers so
m dot employee name as
manager underscore name from
employee underscore manager as e
this join means self join employee
underscore manager SM on E dot manager
ID equal to e dot employee ID so this is
my common column that is employee ID
manager ID let's do it all right
I'll give a comment here
saying self join
and I'll start with myself join I'll
write
select let me first display my table
I'll write select star from
and my table name is EMP underscore
manager
I'll run it
you can see the table here there is the
same table that we saw
in the slides now I'll write my
join query I'll write select e Dot
employee ID
comma
e
Dot
employee name
comma
e Dot
manager ID
comma then I'm using another Alias as m
for
finding the
manager name so m dot employee name as
manager name
there shouldn't be any space in the
Alias name
then I'll write from
EMP underscore manager as e
join
EMP underscore
manager as M on
e Dot
manager
underscore
ID equal to m dot
EMP underscore ID
let me run this and we'll see the
results
there you go
so Gary
reports to
the manager ID3 so from the table 3 is
for Smith so Gary's manager Smith Gibbs
manager is Gary Smith's manager is
Latham and Jimmy's manager is Smith
okay so this is how you can use self
join
now moving ahead with her
next question
so the 17th question
is on which of the following is called a
virtual table in SQL so again we have a
multiple choice question
so the answer is
view you can see here
so view is a virtual table that has rows
and columns as they are in a real table
in the database now we can create a view
by selecting fields from one or more
tables present in the database
next moving to the 18th question
so here we want to write an SQL query to
fetch the list of employees with the
same salary
again I am going to use a self join here
wherein I'll join the same employees
table
and this is how my
query would look like so I am selecting
distinct employee ID so e dot employee
ID e dot employee name e dot salary from
employees then I'm joining
employees SE on employees E1 where e dot
salary equal to e1. salary because I
want to fetch the list of employees with
the same salary and I'm ensuring that
the employee IDs from both the tables
are different
let's do it
I'll give a
comment here and write
employees
with
same salary
and I'll start with my
query I'll write select
distinct
e Dot
employee ID
comma
I'll write e Dot
employee name
commie dot salary
from
employees
as e
then
employees as
E1
where
e dot salary equal to
E1 dot salary
and
e Dot
employee ID is not equal to
E1 Dot
employee ID
I'll give a semicolon and let's print
the results
you see here we have Amelia
Bala Sheen and Sarah who have the same
salary so Emilia and Sheen have the same
salary of fifty five thousand dollars
Billa and Sarah have the same salary of
seventy two thousand dollars okay
now moving to the 19th question
so the question is to write an SQL query
to print one row twice in results from a
table so I have a table here called
employees and I want to print
one row twice in the results
so to solve such kind of problems you
need to use the union all operator in
SQL
so Union all combines the result sets of
two or more select statements
it does not remove duplicate rows
between the various select statements
all the rows are returned
so let's see I want to print the
employee name and department for those
employees who are from the HR department
now to do this we can use the union all
operator you can see it here so I'm
selecting my employee name the
department from my table employees as e
that I am giving my where Clause where e
dot Department equal to HR
and then I'm using the union all
operator
then I'm again selecting my employee
name Department from employees with
another Alias as E1 where E1 dot
Department equal to HR so let's do this
okay so I'll give my comment as
print
row
twice
okay
now
I'll start with my query I'll write
select
my employee name
comma the department from
my table that is employees as e then
I'll use where
e dot Department equal to
HR
then I am going to use the union all
operator
so the union all will combine the result
set of two or more select statements
then I am going to write select
EMP underscore name
comma
my department from
employees
as E1
where
E1 dot Department
equal to HR
I'll give a semicolon now let's run it
there you go you can see here
Marcus and Sophia are from the HR
department and we have printed them
twice in our results
coming to the next question
the question is using the num table
write a query to add 10 when number is 0
20 the number is 1 else print the number
itself
so you can see here I have my table
called num and it has just one column
which is num ID or number ID we have
some
numbers here
and
from these numbers I want to add 10 if
the number is 0 20 if the number is 1
else I would print the number itself
so
to answer this question we'll use the
case statement in SQL
so the case statement is sql's way of
handling if then logic
the key statement is followed by at
least one pair of when and then
statements
so here you can see I have my case
statement I'm writing one case
my column name and underscore ID equal
to 0 then add Plus 10. if it is 1 then
add plus 20 else we'll just return the
number ID
now let's do this
okay
I'll give a comment saying using
case statements
okay first of all
let me
display the values present
in my
num table you can see here this is my
table and there are total 12 rows of
numbers
now let's start with our
query I'll write select
and underscore ID
comma
then I am going to write my case
statement so I'll use the keyword as
case when
n underscore ID equal to 0
I'll use then
n underscore ID
plus 10
I'll write when
and underscore ID equal to 1
then and underscore ID
plus 20
else
I'll just print an ID
now I'll end my case statement I'll
write end as
an alias name let's say num underscore
add
from my table that is num
let's run and see the results
okay you can see here
my first
number was 0 so since it was 0 we have
added
num ID or n ID plus 10 so the result is
10. now
wherever
the num ID is one for example here we
have added 20 so then result or the
output becomes 21
similarly here the value was 0 so we
have added 10 the output is 10.
and you see here again here we had
another one so we added one two
20 so the result becomes 21
and for the rest of the numbers for
example 3
we had two
the values are the same
okay
now moving ahead
so we have
a table called num1
and using this table we want to write a
query to find the sum of all positive
values and the negative values
so let's see the table first so this is
my table which is num1 you can see here
we have a list of integers and there are
positive as well as negative integers
so for positive values
and the negative values we want to find
the sum separately
so again for this we are using the
case statement you can see here I have
used
two case statements
I'm writing select and then I'm using
the case to find if the number is
greater than 0 which means it's a
positive number so I am finding out the
sum and then I'm checking
case when the integer is less than 0 so
it's a negative number and I'm finding
the sum for the negative numbers as well
let's do this
okay
so
I'll give my comment as
add
positive and
negative numbers
okay so let's start with our select
query I'll write select
I'll use the sum function and inside the
sum function I'll use my case statement
so I'll write case when
num
underscore
integer
okay before that let me just print the
values present in my
table so I'll write select star from
my table name that is num1
okay
so you can see here these are the values
or the list of integers that we have
there are some positive as well as
negative integers
okay let's continue with our query
so here I am going to write case when
num underscore integer or int which is
my column name
if it is greater than 0
then
I'll return num underscore
int
else I'll say 0
and end my case statement
I'll give an alias as sum of let's say
positive numbers
give a comma
then I'll use another sum function and
inside the sum function we'll use the
case statement to find
the sum of negative numbers or integers
so I'll write num underscore int if it
is less than 0 then
num underscore int
else
0 and I'll end
okay and I'll give another Alias name as
let's say sum underscore any G which
stands for negative
POS is for positive integers
and then I'll write from my table that
is num1
let's
run it
okay there you go we have our results so
we have two columns sum of positive
integers and sum of negative integers
you can see the results 99 minus 14
respectively foreign
ahead
now in question number 22 we want to
list the difference between primary key
and foreign key
so as you can see here
primary key is something that can
uniquely identify a record in a table so
if you consider a school database a
primary key would ideally be the roll
number or the registration number of the
student
because that is you need to all the
students in a school
now
foreign key is the field in the table
that is primary key to another table
so suppose you have another table called
courses to which the
students of enroll 2
now if you have a role number or a
registration number column in the course
table that becomes the foreign key
now the other difference is primary key
don't accept or cannot accept null
values while foreign key can accept null
values
now you can have only one primary key in
a table but you can have more than one
foreign key in a table
now coming to the 23rd question what is
the difference between primary key and
Union
so you can have only one primary key in
a table as we discussed in the previous
question but you can have more than one
unique key in a table a primary key
column cannot have null values but Union
can accept null values now if you assign
a column as a primary key you create a
clustered index
and similarly if you assign a column
with Union you create non-cluster index
okay
now coming to the 24th question
what is a check constant in SQL
so check constraints are used while
creating tables
check constraint helps to limit or
restrict the values that can be inserted
into a column for example
we have a
table here let's say dummy one and you
want to ensure
that every time you insert the
age of people or persons in the table
you want to make sure that each should
be always greater than zero reason being
a person cannot have or an animal cannot
have or a tree cannot have a negative
each similarly you can set a constant
for the salary column in a table to
ensure that it is always greater than 0
because you cannot earn a negative
salary or it cannot be less than zero
now we are going to create a dummy table
on my MySQL workbench and see how check
constraints can be applied
okay
so let's give our comment as
check constraints
all right
so I am going to create
a table
called
dummy
let's say underscore SQL
now this table will have a few columns
first we have let's say Eid which stands
for employee ID
the data type is integer and
I'm going to assign employee ID as my
primary key so I'll write
primary key here
okay I'll give a comma next we'll have a
City column
City column is of type VAR care or
varying character
I'll keep the size as 30
and here
I am going to apply my check constant to
this city column
I'm going to check
the city
should
take only
values as Mumbai
let's say
I'll have my final column that is each
ages of type integer and here I am going
to check my age should always be
greater than 0 so I'll write check each
greater than 0.
okay
so our dummy SQL table has
one primary key constraint and we have
applied two check constraints on City
and each column
let's run this
okay so we have created our table
successfully you can see it here now
let's insert a few records and we can
see the difference
I'll write insert into
dummy
underscore SQL
I'll write
values
I'll have my employee IDs 101
I am giving my
CTS Mumbai which is what we want
and let's see I'll give my age as
10.
now this should perfectly work because
my city is Mumbai and my age is greater
than 0. so I should be able to insert
This Record successfully you can see
here
I have inserted
this record to the table
I'll write select star from dummy SQL so
that you can check
let's run it
oh there is some mistake I should write
from okay
let's run it you can see it here we have
one record or one row returned
now let's see we'll insert another
record
and this time I am going to give my
employee IDs 102 because it has to be
unique
and this time instead of Mumbai I am
going to give my city as let's say Delhi
so I'm not following my check constant
where I am
supposed to give only Mumbai I am
purposely giving Delhi here to see the
difference if I run this let's see we'll
have
age is 40 which is greater than
0
let's run it you see here we get an
error saying check constraint dummy
underscore SQL underscore check is
violated
similarly
let's see I change this to Mumbai again
and instead of 40 let's say I'll give us
minus 30.
so your age can never be in negative
numbers
if I run this I get the C mirror my
check constraint has been violated
because each should be greater than 0.
okay so this is how you can use check
constraints in SQL
now coming to the 25th question so given
two tables A and B we want to write a
query to fetch values in table B that
are not present in table a
now to answer this question
you can use the left join
so what left join does is it returns all
the rows from the left table and only
matching rows from the right table
and I've used my
condition as a DOT ID which is in the
right table should be null
let's write this query on the workbench
okay
so I'll give my comment
using left join
first of all let me display my
tables I'll write select star from
e
where on this I have the
IDs that are total five IDs in table a
similarly
I'll copy this and
will see the values that are present in
table B
so again I have five values there are a
few non-matching values as well so I
want to return those non-matching values
that are not present in tablely
so for that I'll write select
ID
from
table B
I'll use left join
e
using my ID column
this is another way to give the
condition
or you can use the on operator
then I'll give
a DOT ID is null
let's run and see the results
there you go so 150
275 are not present in table a but are
present in table B
okay
now moving ahead
so now we'll look at the last set of
five questions
so these questions are based on the
popular Northwind sample database
provided by Microsoft there are several
tables in this database so we have an
order table customers employee products
region table and others we'll use our
Microsoft SQL Server to solve the five
questions
so my next question which is based on
Microsoft SQL Server the question is
using the north wind database find the
customers who don't have any orders
okay so I am on my Microsoft SQL Server
management studio so this is how the
interface looks like and here you can
see I have a list of databases now to
solve the last five questions I am going
to use the Northwind database if I
expand this
I'll click on the plus sign you can see
there are a lot of tables that are
already present in the database you can
see here we have customers employees
employee territories order details
orders products region
suppose suppliers territories and more
okay
let me just collapse this
all right so
to write my queries I am going to create
a
new query file
and here you see I am currently on my
master database I am going to change
this to Northwind database so that we
can utilize all the tables that are
present
so my 26th question was to find the
customers who don't have any orders
for that
I am going to use two tables customers
and orders
so
let me first give a comment
saying
customers
with
no orders
and now let's go ahead and display the
columns that we have and see the records
present in the tables
customers and orders so first time
checking all the
columns and the rows present in the
customers table I'll
execute using this button or you can hit
F5 as well
okay you can see here there are total 91
customers these are all unique customers
you have total 91 unique customer IDs
you see here the company name of the
customer
you have the contact name the contact
title address City to which the
customers belong to then the region
postal code Country phone fax number
okay
now let me just copy this query
and
now we'll check for the order stable
I'll write select star from orders
and let's execute it or run it
okay so there are total
830 rows of information so there were
total 830 orders or order IDs we have
the customer ID now this customer ID is
actually the foreign key for the order
stable but for the customer stable
customer ID is the primary key and in
the orders table order ID is the primary
key we also have the employee ID again
this employee ID is the foreign key for
this order stable
you have the order date we have the
required date ship date ship via which
means by which medium the order was
shipped we have the free charges ship
name and
ship address as well
then you have the
City from which the item was shipped the
region postal code and the country
okay
now
let me use the distinct keyword I'll
write select
distant
I want to find the distinct
customer IDs from
my customer stable
let's run and see how many unique
customer IDs we have so there are total
91 customer IDs or customers
now let's check for the order stable
let's run it and see the difference now
if you see here there are total 89
customer IDs in the orders table which
means
there are two customers missing from the
orders table and that implies those two
customers don't have any orders
so to
get the result I will use two different
queries
to derive at the same
output
so I'm going to select
my customer ID
from
my table that is
customers
I'm going to use
where
my customer ID
and then I'm going to use the not in
operator
I'm going to use a sub query
select
customer ID
from
my order stable
close the bracket and I'll give a
semicolon
now what this query essentially does is
it is first going to
find all the customer IDs that are
present in my orders table and
in the outer query we are only going to
return the customers that are present in
both the tables and
we are going to exclude those customers
which are not present in the
orders table
so let's run and see the results we
should get two customer IDs there you go
so these are the two customer IDs which
are
present in the
customers table and are not present in
the orders table meaning that they don't
have any
orders in their name
now there is another way to do it
that is to use the not exist operator
wherein you can write another sub query
to get the same result we'll leave that
to you you can try this out using the
not exist operator as well
coming to the 27th question
using the orders table in the Northwind
database we want to find all the month
and orders so such problems you will
face while dealing with sales data so
very often sales Executives would try
hard to meet their month and targets we
want to display all the orders made on
the last day of the month
so let's solve this question on our
Microsoft SQL Server
okay so let me first give my comment for
the 27th question
so the question is to find all the month
end order so I'll just write month end
orders
okay now to get the month end orders we
are going to use a built-in
EO month function which stands for end
of month
so let's start with the query
I'll write select
we are going to select the
employee ID comma
I also want the order ID
and
we want the order date
from
my table that is
orders
I'll
then give my where Clause I'll write
where
my
order date equal to
and I'll use my
inbuilt function that is end of month
I
have hit tab to autocomplete and inside
this function I'll pass in my order date
column
then I am going to
use the order by Clause I am going to
order it by employee ID and the order ID
I'll just move down and hit tab okay
let's
run the query there you go we have got
26 rows of information you see on the
left side we have the employee IDs the
order IDs and then we have the order
date column now if you mark the values
present in the order date column these
are all the
end of month date values you see this is
28th of Feb then we have
31st of July we have 30th of June
so on and so forth
so these are the list of all the orders
that were placed on the last day of the
month
coming to the 28th question
we want to find the top five countries
with the highest Freight charges in the
year 1997. so freight charge is the
amount paid to a carrier company for the
transportation of goods from origin to
another location
the freight charge is calculated based
on the mode of transportation and the
distance between the pickup place or the
pickup location and the destination
so let's try this out on the
Microsoft server management Studio
okay so let me go ahead and
give my comment
so since we want to find the top five
countries with the highest Freight
charges
I'll just give my comment as
highest
Freight charges
okay
now
to solve this question
I'll just change this to
ght okay
we are going to use our
order stable
so the way to do is I'll write select
I'm going to use the top five so top is
another
keyword or
an operator
so I'm going to find out the
ship country
and then
I'll calculate the average Freight
prices so I'm going to use the average
inbuilt function
on top of my
column that is
Freight
I'll give an alias as
let's say
average
Freight
there should be no space I'll give a
underscore
I'll write from my table that is orders
I'll use my where Clause where and then
I'm going to find the year
from my order
date column and this year should be
1997.
I'm going to
group it by
my ship country
and
I'll use
order by
Alias name that was average fret
and in descending order I'm going to
sort it
let's see the top 5 shipping countries
who have the highest freed charges these
are the results you have Austria
Switzerland Sweden Canada and Ireland
and here you can see the average Freight
prices
sorted in descending order
okay
now moving ahead to the 29th question
so here we want to display the total
number of products in each category so
we have two different tables products
and categories so both these tables we
are going to use
to find a solution to this problem that
is
to display the total number of products
in each category
so first let me give my comment to
display the total number of products in
each category I'll just write print
total
products
okay
so
to solve this problem we are going to
use our two tables
so let me first display the rows and
columns from both the tables the first
table is products
okay it is products
let's run this and see the columns that
we have in this table
okay so you have the product ID which is
the primary key you have the product
name so there are total 77 different
products okay and then you have the
supplier ID you have the category ID so
these two columns are the foreign key
columns you have the quantity per unit
unit price units in stock units in order
and if you want to
reorder some product to fill in the
stocks so you have information for that
as well and if the product has been
discontinued or not
I'll copy this and let's see what
rows and columns we have
in my category stable
okay
let me execute this okay so we have
total eight categories of products you
can see beverages we have dairy products
meat or poultry you have produced
Seafood these are the description
okay
now to find the total number of products
in each category I'll write my query as
select
I'll write
category
name comma
count star
I'll give this an alias name as total
products
given underscore and write products
from
my first table that is
products
given Alias as p
I am going to use an inner join
with my categories table
and I'll give my Alias as C
on my common key column that is p dot
category ID is equal to C Dot
category ID
then
I'm going to
group my results
based on the category names
so I'll write category
name
and we'll use the
order by Clause I'll write order by
count star
as
descending
so let's see the total number of
products that we have in each category
so they shouldn't be as descending
should be just count star descending
okay
I'll select and run it
there you go so here on the left hand
side you have the different category
names and on the right you have the
total number of
products that belong to
each of the categories
all right
now moving on to the final question
so the last question is to use the
Northwind database
and using this database we want to find
the list of late orders for all the
employees
so this is a real world problem that
often occurs
so the shipment of your orders might get
delayed due to logistic issues or if the
products are not available on time there
can be various other reasons as well so
here we want to find those orders for
the employees where the required date is
less than the shipment date we are going
to use two different tables that is
orders and employees
okay now let me give my comment for the
final
query that we are going to write in this
interview questions tutorial so using
the orders table I want to find the list
of orders for all the employees
so I'll just give list
of
late orders not just orders for
employees I write EMP
s which stands for employees
so here I'm going to use two tables
orders and employees
order stable we have already seen let's
see the rows and columns that are
present in the employees table
I'll write select star from employees
and let me run it
okay so there are total nine employees
we have
so we have the employee ID this is the
primary key column which goes from one
to nine we have the last name of the
employee the first name of the employee
we have the title then we have the title
of courtesy where the doctor Mr Mrs
we have the birth day of the employee
the higher date or the date of joint
you have the address City region postal
code and other information
all right
so let's
see how you can join the orders table
and the employees table to get the list
of late orders and we must remember that
late orders are those where the required
date is less than equal to the shipped
date
so I'll start with select
e Dot
I'll write employee ID
comma
I want the
first name
comma
I'm going to count Star as
late orders
from
my table orders as o
then I'll use my inner join
I'll write
employees
as e it doesn't matter actually if you
use small e or capital e
then I am going to use my on condition
on E Dot
on E Dot
employee ID
equal to
o dot employee ID
so this is my common key column that is
present in both the tables
then I'll use my where Clause where
you should be careful
and you should keep the right
Clause so my required date
should be less than or equal to my shift
date
so this is my condition
and then I'm going to group by E dot
employee ID
comma
e Dot first name
and then I'll use my order by Clause
order by my Alias name that was late
orders and I'll arrange it in descending
order
so let's run this and see our result
Okay so
you have the employee IDs on the left
then you have the first name of the
employee IDs and then you have the late
orders for each of these employees so if
you see here employee id4 has the
highest number of late orders followed
by employee ID
three and eight
as well as 9 who have 5 late orders then
we have the employee ID 2 which has
four late orders even employed is seven
has four lead orders employee ID 5 that
is Steven has only one late orders
so we are done with our
demo section and we have covered all our
30 questions out of which 25 questions
were based and used on MySQL server
and to address the last five questions
we used our Northwind database that had
lot of tables you can see it here and
using those tables we solve some
interesting questions
and with that we have completed another
session on Advanced SQL full course if
you have any queries regarding any of
the topics covered in the session or if
you require the resources that we used
in the session like PPT code
documentation please feel free to let us
know in the comment section below and
our team of experts will be more than
happy to resolve all your queries at the
earliest until next time thank you stay
safe and keep learning staying ahead in
your career requires continuous learning
and upskilling whether you're a student
aiming to learn today's top skills or a
working professional looking to advance
your career we've got you covered
explore our impressive catalog of
certification programs in Cutting Edge
domains including data science cloud
computing cyber security AI machine
learning or digital marketing designed
in collaboration with leading
universities and top corporations and
delivered by industry experts choose any
of our programs and set yourself on the
path to Career Success click the link in
the description to know more
hi there if you like this video
subscribe to the simply learned YouTube
channel and click here to watch similar
videos turn it up and get certified
click here
foreign